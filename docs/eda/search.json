[
  {
    "objectID": "eda_fish.html",
    "href": "eda_fish.html",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "",
    "text": "This document presents an exploratory analysis of fish survey data collected during the PNG-2024 scientific expedition. Our goal is to characterize patterns in reef fish community structure and composition, and to identify key drivers of species richness, abundance, and biomass across spatial and ecological gradients.\nThe dataset comprises standardized underwater visual survey (UVS) data collected across multiple islands, regions, and depth strata using consistent belt transect methods. Observers recorded individual fish counts, estimated lengths, and species-level taxonomic identifications. These were used to derive metrics of abundance (individuals per m²), biomass (grams per m²), and species richness per station.\n\n\nCode\n# -- Read supporting site data --------------------------------------------\n\nsites &lt;- read_rds(file.path(exp_path, \"data/primary/processed/sites.rds\"))\n\nuvs_sites &lt;- sites$uvs\n\n# Load pre-processed fish data --------------------------------------------\n\nfish_lut &lt;- read_csv(file.path(ps_paths$projects, \"prj-legacy-db/data/processed/taxa/taxa_luts.uvs_fish_pacific.csv\"),\n                     show_col_types = FALSE) \n\nload(file = file.path(exp_path, \"data\", \"primary\", \"processed\", \"fish\", \"fish_staging.RData\"))\n\n# Are there any data filters??\n\nbiomass_by_station_and_taxa &lt;- biomass_by_station_and_taxa |&gt; \n  filter(!str_detect(common_family, \"blennie|gobie\"))\n\nbiomass_per_obs &lt;- biomass_per_obs |&gt; \n  filter(!str_detect(common_family, \"blennie|gobie\"))\n\n# --- Station-level summary -----------------------------------------------\n\nregion_lookup &lt;- stations |&gt; distinct(ps_site_id, region)\n\nstation_summary &lt;- biomass_by_station_and_taxa |&gt; \n  group_by(ps_site_id, ps_station_id, depth_strata) |&gt; \n  summarize(n_taxa         = n_distinct(accepted_aphia_id[avg_count &gt; 0]),\n            total_count    = sum(total_count),\n            avg_count      = sum(avg_count),\n            avg_count_m2   = sum(avg_count_m2),\n            avg_biomass_m2 = sum(avg_biomass_m2),\n            .groups = \"drop\") |&gt; \n  left_join(stations |&gt; \n              distinct(ps_site_id, ps_station_id, region, subregion, locality, habitat, exposure, n_transects),\n            by = c(\"ps_site_id\", \"ps_station_id\")) |&gt; \n  mutate(across(c(avg_count, avg_count_m2, avg_biomass_m2), \n                ~round(.x, 4))) |&gt; \n  select(region, subregion, locality, ps_site_id, ps_station_id, depth_strata, n_transects,\n         n_taxa, total_count, avg_count, avg_count_m2, avg_biomass_m2,  habitat, exposure) \n\n\nIn total, we conducted surveys at 90 sites and 167 stations across 4 regions, covering approximately 66,450 m² of reef habitat (Table 1, Figure 1).\n\n\nCode\n# Habitat map\nhabitat_pal &lt;- c(\"fore reef\"  = \"#C5FFFD\",\n                 \"back reef\"  = \"#DF2935\",\n                 \"channel\"    = \"#D8CC34\",\n                 \"patch reef\" = \"#772D8B\")\n\ntrophic_palette &lt;- c(\"Herbivore/Detritivore\" = \"#5C9E5C\",   # Earthy green (natural, calming)\n                     \"Planktivore\"            = \"#4C9CB2\",   # Soft teal-blue (planktivores)\n                     \"Lower-carnivore\"        = \"#E1B07E\",   # Sandy ochre (mid-level predator)\n                     \"Top-predator\"           = \"#C75D4D\",   # Muted brick red (assertive but not harsh)\n                     \"Shark\"                  = \"#7E6FAB\",   # Deep slate violet (distinctive, dignified)\n                     \"NA\"                     = \"#D0D0D0\")    # Light neutral gray (non-disruptive)\n\nstations_sf &lt;- stations |&gt;\n  left_join(uvs_sites |&gt; \n              select(ps_site_id, latitude, longitude),\n            by = \"ps_site_id\") |&gt;\n  mutate(habitat = factor(habitat, levels = names(habitat_pal))) |&gt;\n  group_by(ps_site_id, region, subregion, locality, habitat, exposure, latitude, longitude) |&gt; \n  summarize(team = paste(unique(diver), collapse = \"/\"),\n            strata = paste(unique(paste(depth_strata, \" (\",depth_m ,\"m)\", sep = \"\")), \n                            collapse = \"\\n\"),\n            surveyed_area = sum(area_m2),\n            n_stations = n_distinct(ps_station_id),\n            .groups = \"drop\") |&gt;\n  sf::st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) \n\nmapview::mapview(stations_sf,\n                 zcol = \"habitat\",\n                 legend = TRUE,\n                 col.regions = habitat_pal,\n                 map.types = \"Esri.WorldImagery\",\n                 layer.name = \"Habitat\",\n                 popup = leafpop::popupTable(stations_sf, \n                                             zcol = c(\"ps_site_id\", \"strata\", \"team\", \"surveyed_area\", \"habitat\", \"exposure\"))) |&gt; \n  leafem::addMouseCoordinates() |&gt; \n  addFullscreenControl()\n\n\n\n\n\n\n\n\nFigure 1: Map of fish survey stations\n\n\n\n\n\n\nCode\nstations |&gt; \n  group_by(region, habitat, depth_strata) |&gt;\n  summarise(n = n_distinct(ps_station_id), .groups = \"drop\") |&gt; \n  pivot_wider(names_from = habitat, values_from = n, values_fill = 0) |&gt; \n  mutate(Total = rowSums(across(where(is.numeric)), na.rm = TRUE)) |&gt;\n  gt(groupname_col = \"region\") |&gt; \n  tab_header(title = \"Summary of sampling effort by region\",\n             subtitle = \"Number of stations surveyed by depth strata and habitat\") |&gt;\n  tab_spanner(label = \"Reef Habitats\", \n              columns = c(\"fore reef\", \"back reef\", \"channel\", \"patch reef\")) |&gt; \n  tab_style(style = list(cell_fill(color = \"#f0f0f0\"),\n                         cell_text(weight = \"bold\")),\n            locations = list(cells_column_labels(everything()),\n                             cells_column_spanners(spanners = \"Reef Habitats\"))) |&gt;\n  opt_table_font(font = list(gt::google_font(\"Roboto\"), default_fonts())) |&gt;\n  opt_row_striping() |&gt; \n  tab_options(row_group.as_column = T,\n              table.width = pct(100),\n              table.font.size = \"small\") |&gt; \n  opt_vertical_padding(scale = 0.7) |&gt; \n    tab_source_note(source_note = \"Depth stratum: supershallow (&lt; 6 m), shallow (7 - 15 m), and deep (&gt;= 15 m).\") \n\n\n\n\nTable 1: Number of fish survey stations by habitat and depth strata\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSummary of sampling effort by region\n\n\nNumber of stations surveyed by depth strata and habitat\n\n\n\ndepth_strata\n\nReef Habitats\n\nTotal\n\n\nfore reef\nback reef\nchannel\npatch reef\n\n\n\n\nLovongai\nshallow\n16\n3\n0\n0\n19\n\n\ndeep\n9\n0\n0\n0\n9\n\n\nsupershallow\n1\n0\n0\n0\n1\n\n\nManus\nshallow\n15\n0\n1\n1\n17\n\n\nsupershallow\n2\n0\n1\n1\n4\n\n\ndeep\n13\n0\n0\n2\n15\n\n\nMurat\ndeep\n22\n0\n0\n0\n22\n\n\nshallow\n22\n0\n0\n0\n22\n\n\nWestern Islands\ndeep\n25\n1\n0\n0\n26\n\n\nshallow\n27\n2\n0\n0\n29\n\n\nsupershallow\n1\n2\n0\n0\n3\n\n\n\nDepth stratum: supershallow (&lt; 6 m), shallow (7 - 15 m), and deep (&gt;= 15 m).\n\n\n\n\n\n\n\n\n\n\n\nSubsequent sections will summarize the data by region and subregion, characterize the dominant taxa, evaluate sampling sufficiency, and explore spatial and ecological drivers of richness, abundance, biomass, and community structure."
  },
  {
    "objectID": "eda_fish.html#regional-summary",
    "href": "eda_fish.html#regional-summary",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "2.1 Regional summary",
    "text": "2.1 Regional summary\nThe tables below (Table 2, Table 3) summarize survey coverage and observed patterns in species richness and abundance across regions and subregions. Metrics include the number of stations surveyed, total fish counted, and average richness, abundance, and biomass per station.\nThese summaries reveal distinct regional patterns in reef fish communities. Lovongai recorded the highest species richness and the greatest average fish biomass per station. In contrast, Murat exhibited the lowest richness and biomass. The Western Islands showed the highest fish abundance, but average biomass per station was comparable to Murat, suggesting smaller-bodied species dominate. Manus had the lowest overall abundance.\nIn the following sections, we explore spatial and ecological patterns in species richness, abundance, and biomass, focusing on variation across region, depth strata, and observer.\n\n\nCode\n# --- Region-level summary -----------------------------------------------\nregion_summary &lt;- station_summary |&gt; \n  group_by(region) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            total_count = sum(total_count),\n            avg_taxa = round(mean(n_taxa)),\n            avg_count = round(mean(avg_count)),\n            avg_count_m2 = mean(avg_count_m2),\n            avg_biomass_m2 = mean(avg_biomass_m2),\n            .groups = \"drop\")\n\nn_taxa_by_region &lt;- biomass_by_station_and_taxa |&gt;\n  left_join(region_lookup) |&gt;\n  group_by(region) |&gt; \n  summarise(n_taxa = n_distinct(accepted_aphia_id[avg_count &gt; 0]),\n            .groups = \"drop\") \n\nregion_summary &lt;- region_summary |&gt; \n  left_join(n_taxa_by_region) |&gt; \n  relocate(n_taxa, .after = n_stations) \n\n\n\n\nCode\nregion_summary |&gt; \n  mutate(across(where(is.numeric), ~round(.x, 2)),\n         total_count = scales::comma(total_count)) |&gt; \n  gt(rowname_col = \"region\") |&gt; \n  tab_header(title = \"Summary of Fish Surveys by Region\",\n             subtitle = \"Average counts and biomass per station\") |&gt; \n  cols_label(n_stations = \"Stations\",\n             n_taxa = \"Taxa Observed\",\n             total_count = \"Total Individuals\",\n             avg_count = \"Avg. Count\",\n             avg_taxa = \"Avg. Nº Taxa\",\n             avg_count_m2 = \"Avg. Count (per m²)\",\n             avg_biomass_m2 = \"Avg. Biomass (g/m²)\") |&gt; \n  tab_style(style = list(cell_fill(color = \"#f0f0f0\"),\n                         cell_text(weight = \"bold\")),\n            locations = cells_column_labels(everything())) |&gt;\n  opt_table_font(font = list(gt::google_font(\"Roboto\"), default_fonts())) |&gt;\n  opt_row_striping() |&gt; \n  tab_options(row_group.as_column = T,\n              table.width = pct(100),\n              table.font.size = \"small\") |&gt; \n  opt_vertical_padding(scale = 0.7)\n\n\n\n\nTable 2: Summary of fish surveys by region\n\n\n\n\n\n\n\n\n\nSummary of Fish Surveys by Region\n\n\nAverage counts and biomass per station\n\n\n\nStations\nTaxa Observed\nTotal Individuals\nAvg. Nº Taxa\nAvg. Count\nAvg. Count (per m²)\nAvg. Biomass (g/m²)\n\n\n\n\nLovongai\n29\n330\n21,611\n55\n255\n4.63\n542.49\n\n\nManus\n36\n309\n16,968\n53\n168\n2.99\n222.69\n\n\nMurat\n44\n275\n34,926\n52\n265\n5.04\n187.34\n\n\nWestern Islands\n58\n311\n41,619\n48\n354\n6.72\n198.95\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# --- Subregion-level summary -----------------------------------------------\n\nsubregion_summary &lt;- station_summary |&gt; \n  group_by(region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            total_count = sum(total_count),\n            avg_taxa = round(mean(n_taxa)),\n            avg_count = round(mean(avg_count)),\n            avg_count_m2 = mean(avg_count_m2),\n            avg_biomass_m2 = mean(avg_biomass_m2),\n            .groups = \"drop\")\n\nn_taxa_by_subregion &lt;- biomass_by_station_and_taxa |&gt;\n  left_join(stations |&gt; distinct(ps_site_id, region, subregion)) |&gt;\n  group_by(subregion) |&gt; \n  summarise(n_taxa = n_distinct(accepted_aphia_id[avg_count &gt; 0]),\n            .groups = \"drop\") \n\nsubregion_summary &lt;- subregion_summary |&gt; \n  left_join(n_taxa_by_subregion) |&gt; \n  relocate(n_taxa, .after = n_stations) \n\n\n\n\nCode\nsubregion_summary |&gt; \n  mutate(across(where(is.numeric), ~round(.x, 2)),\n         total_count = scales::comma(total_count)) |&gt; \n  gt(groupname_col = \"region\",\n     rowname_col = \"subregion\") |&gt; \n  tab_header(title = \"Summary of Fish Surveys by Island\",\n             subtitle = \"Average counts and biomass per station\") |&gt; \n  cols_label(n_stations = \"Stations\",\n             n_taxa = \"Taxa Observed\",\n             total_count = \"Total Individuals\",\n             avg_taxa = \"Avg. Nº Taxa\",\n             avg_count = \"Avg. Count\",\n             avg_count_m2 = \"Avg. Count (per m²)\",\n             avg_biomass_m2 = \"Avg. Biomass (g/m²)\") |&gt; \n  tab_style(style = list(cell_fill(color = \"#f0f0f0\"),\n                         cell_text(weight = \"bold\")),\n            locations = cells_column_labels(everything())) |&gt;\n  opt_table_font(font = list(gt::google_font(\"Roboto\"), default_fonts())) |&gt;\n  opt_row_striping() |&gt; \n  tab_options(row_group.as_column = T,\n              table.width = pct(100),\n              table.font.size = \"small\") |&gt; \n  opt_vertical_padding(scale = 0.7)\n\n\n\n\nTable 3: Summary of fish surveys by subregion\n\n\n\n\n\n\n\n\n\nSummary of Fish Surveys by Island\n\n\nAverage counts and biomass per station\n\n\n\nStations\nTaxa Observed\nTotal Individuals\nAvg. Nº Taxa\nAvg. Count\nAvg. Count (per m²)\nAvg. Biomass (g/m²)\n\n\n\n\nLovongai\nAu\n4\n101\n3,623\n40\n453\n7.48\n2410.38\n\n\nDunung\n4\n136\n1,633\n63\n110\n2.06\n101.86\n\n\nEnelava\n2\n107\n1,450\n72\n121\n2.19\n115.34\n\n\nKung\n2\n70\n382\n42\n96\n1.61\n196.97\n\n\nNeitab\n3\n105\n971\n47\n149\n2.74\n126.82\n\n\nNemto\n2\n72\n589\n50\n98\n1.84\n95.35\n\n\nTingwon\n9\n205\n12,499\n62\n435\n8.21\n485.15\n\n\nTsolik\n3\n100\n464\n48\n52\n0.89\n40.40\n\n\nManus\nBipi\n14\n217\n9,679\n56\n241\n4.37\n361.15\n\n\nHarengan\n18\n234\n5,992\n50\n125\n2.13\n139.46\n\n\nManus\n4\n127\n1,297\n58\n108\n1.98\n112.63\n\n\nMurat\nEmirau\n12\n174\n8,560\n53\n238\n4.40\n227.46\n\n\nMussau\n26\n242\n19,680\n53\n252\n4.81\n185.50\n\n\nTench\n6\n127\n6,686\n52\n371\n7.30\n115.03\n\n\nWestern Islands\nAua\n6\n105\n5,669\n38\n472\n9.30\n115.88\n\n\nLuf\n15\n216\n9,741\n49\n313\n5.81\n182.92\n\n\nNinigo\n27\n257\n18,293\n53\n335\n6.37\n215.16\n\n\nWuvulu\n10\n150\n7,916\n43\n396\n7.48\n229.10"
  },
  {
    "objectID": "eda_fish.html#taxonomic-summary",
    "href": "eda_fish.html#taxonomic-summary",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "2.2 Taxonomic summary",
    "text": "2.2 Taxonomic summary\n\n\nCode\n# --- Taxon-level summary -----------------------------------------------\n\ntaxa_summary &lt;- biomass_by_station_and_taxa |&gt; \n  group_by(trophic_group, order, family, accepted_name) |&gt; \n  summarise(total_count = sum(total_count),\n            avg_length_wm = round(mean(avg_length_wm, na.rm = T)),\n            avg_count = mean(avg_count),\n            freq_obs = round(100*sum(avg_count_m2 &gt; 0)/n(),2),\n            across(c(\"avg_biomass_m2\",\"avg_count_m2\"), mean, na.rm = T),\n            .groups = \"drop\") |&gt; \n  left_join(biomass_per_obs |&gt; \n              group_by(accepted_name) |&gt; \n              summarize(min_tl_cm = min(avg_length),\n                        max_tl_cm = max(avg_length),\n                        .groups = \"drop\")) |&gt; \n  mutate(across(c(freq_obs, avg_count, avg_biomass_m2, avg_count_m2), ~round(.x, 6))) \n\n# --- Family - level summary -------------------------------------\n\nbiomass_by_station_and_family &lt;- biomass_by_station_and_taxa |&gt;\n  group_by(ps_station_id, order, family) |&gt;\n  summarise(total_count    = sum(total_count), \n            avg_count      = sum(avg_count),\n            avg_count_m2   = sum(avg_count_m2),\n            avg_biomass_m2 = sum(avg_biomass_m2),\n            .groups = \"drop\")\n\nfamily_summary &lt;- biomass_by_station_and_family |&gt; \n  group_by(order, family) |&gt; \n  summarise(freq_obs       = round(100 * n_distinct(ps_station_id[avg_count_m2 &gt; 0]) / n_distinct(ps_station_id),1),,\n            avg_count      = round(mean(avg_count), 3),\n            avg_count_m2   = mean(avg_count_m2),\n            avg_biomass_m2 = mean(avg_biomass_m2),\n            .groups = \"drop\") |&gt;\n  left_join(biomass_by_station_and_taxa |&gt;\n              group_by(order, family) |&gt;\n              summarise(total_count = round(sum(total_count)),\n                        n_taxa     = n_distinct(accepted_name[avg_count_m2 &gt; 0]),\n                        .groups = \"drop\"),\n            by = c(\"order\", \"family\")) |&gt;\n  mutate(across(c(avg_count, avg_count_m2, avg_biomass_m2), round, 6)) |&gt; \n  select(order, family, n_taxa, total_count, everything())\n\n\nDuring the expedition, we recorded a total of 115,124.5 individual fish across 462 distinct taxa during standardized transect surveys. Species richness varied across regions with Lovongai exhibiting the highest number of taxa (330 species), followed by the Western Islands and Manus. Murat showed the lowest regional richness, with only 275 species observed.\n\n\nCode\nlibrary(highcharter)\n\nlvl_opts &lt;-  list(list(level = 1,\n                       borderWidth = 0,\n                       borderColor = \"transparent\",\n                       dataLabels = list(enabled = TRUE,\n                                         align = \"left\",\n                                         verticalAlign = \"top\",\n                                         style = list(fontSize = \"12px\", \n                                                      textOutline = FALSE,\n                                                      color = \"#FFFCF9\",\n                                                      fontWeight = \"bold\"))),\n                  list(level = 2,\n                       borderWidth = 0,\n                       borderColor = \"transparent\",\n                       colorVariation = list(key = \"brightness\", to = 0.250),\n                       dataLabels = list(enabled = FALSE),\n                       style = list(fontSize = \"9px\",\n                                    textOutline = FALSE, \n                                    color = \"#FFFCF9\", \n                                    fontWeight = \"bold\")))\n\nhc_data &lt;- taxa_summary |&gt; \n  mutate(n = 1) |&gt; \n  mutate_if(is.numeric, round,2) |&gt; \n  data_to_hierarchical(c(order, family), n)\n\ndiversity_treemap &lt;- hchart(hc_data,\n                            type = \"treemap\",\n                            allowDrillToNode = TRUE,\n                            levels = lvl_opts,\n                            tooltip = list(valueDecimals = FALSE)) |&gt; \n  hc_chart(style = list(fontFamily = \"Roboto\")) |&gt; \n  hc_title(text = \"Number of fish species by order and family\",\n           align = \"left\",\n           style = list(fontFamily = \"Roboto\", fontSize = \"22px\")) |&gt; \n  hc_size(height = 500)\n\ndiversity_treemap\n\n\n\n\n\n\n\n\nFigure 2: Number of fish species by order and family\n\n\n\n\nThe most taxonomically rich families in our surveys were Labridae (wrasses, n = 80), and Pomacentridae (surgeonfishes, n = 78), followed by Chaetodontidae (butterflyfishes, n = 35) ,Acanthuridae (surgeonfishes, n = 32) and Scaridae (parrotfishes, 31) (Table 4)\n\n\nCode\n# Custom theme based on nytimes but with normal header casing\ncustom_tbl_theme &lt;- reactableTheme(\n  backgroundColor = \"#ffffff\",\n  borderColor = \"#e0e0e0\",\n  stripedColor = \"#f9f9f9\",\n  highlightColor = \"#f0f0f0\",\n  cellPadding = \"2px\",\n  style = list(fontFamily = \"Roboto\", fontSize = \"13px\"),\n  headerStyle = list(background = \"#efefef\",\n                     fontWeight = \"bold\",\n                     fontSize = \"13px\",\n                     textTransform = \"none\",   # &lt;- disables all caps\n                     color = \"black\"))\n\n# Prepare data\nfamily_summary_tbl &lt;- family_summary |&gt;\n  mutate(`Taxa Observed`        = n_taxa,\n         `Total Count`    = total_count,\n         `Avg. Count`           = round(avg_count, 2),\n         `Freq. Occurrence (%)` = round(freq_obs, 1),\n         `Avg. Abundance (ind/m²)`      = round(avg_count_m2, 4),\n         `Avg. Biomass (g/m²)`  = round(avg_biomass_m2, 4)) |&gt;\n  select(order, family, `Taxa Observed`, `Total Count`, `Avg. Count`, \n         `Freq. Occurrence (%)`, `Avg. Abundance (ind/m²)`, `Avg. Biomass (g/m²)`)\n\n# Build table\nreactable(family_summary_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Taxa Observed`  = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(order                  = colDef(name = \"Order\", minWidth = 150),\n                                 family                 = colDef(name = \"Family\", minWidth = 150),\n                                 `Freq. Occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n                                 `Avg. Biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n                                 `Avg. Abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt; \n  add_title(\"Fish Families\") |&gt; \n  add_subtitle(\"Summary of fish families observed during the expedition\",\n               font_size = 20,\n               font_color = '#666666',\n               margin = reactablefmtr::margin(t=10,r=0,b=15,l=0))\n\n\n\n\nTable 4: Summary of fish families observed during the expedition\n\n\n\nFish Families\nSummary of fish families observed during the expedition\n\n\n\n\n\n\n\nSome of the most commonly encountered species includede the bluestreak cleaner wrasse (Labroides dimidiatus, observed at 87% of stations), twospot surgeonfish (Ctenochaetus binotatus, 76%), and bicolor chromis (Pycnochromis margaritifer, 75%)(Table 5). These species were widespread across depth strata and regions.\nIn terms of numerical abundance, the most dominant taxa were the ternate chromis (Chromis ternatensis, 0.84 ind/m²), bicolor chromis (P. margaritifer, 0.73 ind/m²), and the darkfin chromis (Pycnochromis atripes, 0.43 ind/m²).\nBiomass was dominated by larger-bodied taxa such as the sleek unicornfish (Naso hexacanthus, 25 g/m²), bigeye trevally (Caranx sexfasciatus, 22 g/m²), and rainbow runner (Elagatis bipinnulata, 17 g/m²), all of which contributed significantly to overall fish biomass despite lower numerical abundance.\nWe explore differences in community composition across regions in the next sections.\n\n\nCode\n# Prepare data\ntaxa_summary_tbl &lt;- taxa_summary |&gt; \n  rename(`Avg. length (cm)`        = avg_length_wm,\n         `Total count`             = total_count,\n         `Accepted name`           = accepted_name,\n         `Trophic group`           = trophic_group) |&gt; \n  mutate(`Length range (cm)`       = paste0(min_tl_cm, \"–\", max_tl_cm),\n         `Avg. count`              = round(avg_count, 2),\n         `Freq. occurrence (%)`    = round(freq_obs, 1),\n         `Avg. abundance (ind/m²)` = round(avg_count_m2, 4),\n         `Avg. biomass (g/m²)`     = round(avg_biomass_m2, 4)) |&gt;\n  select(family, `Accepted name`, `Trophic group`, `Length range (cm)`, `Avg. length (cm)`,\n         `Total count`, `Avg. count`, `Freq. occurrence (%)`,\n         `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`)\n\n# Build interactive table\nreactable(taxa_summary_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Total count` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns = list(family                     = colDef(name = \"Family\", minWidth = 150),\n                         `Accepted name`            = colDef(name = \"Accepted name\",\n                                                             cell = function(value) htmltools::tags$i(value),\n                                                             minWidth = 180),\n                         `Freq. occurrence (%)`     = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n                         `Avg. biomass (g/m²)`      = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n                         `Avg. abundance (ind/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish species\") |&gt;\n  add_subtitle(\"Summary of fish species observed during the expedition\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\n\n\nTable 5: Summary of fish species observed during the expedition\n\n\n\nFish species\nSummary of fish species observed during the expedition"
  },
  {
    "objectID": "eda_fish.html#overall-patterns",
    "href": "eda_fish.html#overall-patterns",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "6.1 Overall patterns",
    "text": "6.1 Overall patterns\n•   Contribution of each trophic group to total biomass and abundance (stacked bar plots).\n•   Emphasize dominant groups (e.g. planktivores, herbivores, piscivores).\n\n\nCode\nbiomass_by_station_and_taxa |&gt; \n  group_by(ps_station_id, trophic_group) |&gt; \n  summarize(total_biomass_m2 = sum(avg_biomass_m2),\n            total_count_m2   = sum(avg_count_m2),\n            .groups = \"drop\") |&gt; \n  left_join(stations |&gt; \n              distinct(ps_station_id, region, subregion), \n            by = \"ps_station_id\") |&gt; \n  group_by(region, subregion, trophic_group) |&gt;\n  summarize(avg_biomass_m2 = mean(total_biomass_m2),\n            avg_count_m2   = mean(total_count_m2),\n            .groups = \"drop\") |&gt; \n  ggplot(aes(fct_reorder(subregion, avg_biomass_m2, sum, .desc = T), avg_biomass_m2, fill = trophic_group))+\n  geom_col()+\n  facet_wrap(~region, ncol = 4, scales = \"free_x\") +\n  labs(x = \"\", y = \"Average biomass (g/m²)\", fill = \"\",\n       title = \"Average fish biomass by trophic group and region\",\n       subtitle = \"Stacked bar plots show the contribution of each trophic group to total biomass\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\")+\n  guides(fill = guide_legend(nrow = 1, byrow = TRUE))\n\n\n\n\n\n\n\n\n\n\n\nCode\nbiomass_by_station_and_taxa |&gt; \n  group_by(ps_station_id, trophic_group) |&gt; \n  summarize(total_biomass_m2 = sum(avg_biomass_m2),\n            total_count_m2   = sum(avg_count_m2),\n            .groups = \"drop\") |&gt; \n  left_join(stations |&gt; \n              distinct(ps_station_id, region, subregion), \n            by = \"ps_station_id\") |&gt; \n  group_by(region, subregion, trophic_group) |&gt;\n  summarize(avg_biomass_m2 = mean(total_biomass_m2),\n            avg_count_m2   = mean(total_count_m2),\n            .groups = \"drop\") |&gt; \n  ggplot(aes(fct_reorder(subregion, avg_count_m2, sum, .desc = T), avg_count_m2, fill = trophic_group))+\n  geom_col()+\n  facet_wrap(~region, ncol = 4, scales = \"free_x\") +\n  labs(x = \"\", y = \"Average Abundance (in/m²)\", fill = \"\",\n       title = \"Average fish Abundance by trophic group and region\",\n       subtitle = \"Stacked bar plots show the contribution of each trophic group to total abundance\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\")+\n  guides(fill = guide_legend(nrow = 1, byrow = TRUE))"
  },
  {
    "objectID": "eda_fish.html#spatial-trends",
    "href": "eda_fish.html#spatial-trends",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "6.1 spatial trends",
    "text": "6.1 spatial trends\nRegional comparisons of trophic structure (e.g. group-wise proportions per region). • Depth-stratified breakdowns, if patterns emerge."
  },
  {
    "objectID": "eda_fish.html#top-predators",
    "href": "eda_fish.html#top-predators",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "6.1 top predators",
    "text": "6.1 top predators\n\n\nCode\nbiomass_top_pred &lt;- biomass_by_station_and_trophic |&gt; \n  filter(trophic_group %in% c(\"Top-predator\")) |&gt; \n  group_by(ps_station_id, trophic_group, region) |&gt; \n  summarize(prop_top_pred = sum(frac_biomass), .groups = \"drop\") \n\nbiomass_top_pred |&gt; \n  ggplot(aes(x = region, y = prop_top_pred)) +\n  geom_boxplot(outlier.shape = NA, fill = \"#F08A4B\", alpha = 0.6) +\n  geom_jitter(width = 0.2, alpha = 0.6) +\n  labs(\n    title = \"Proportion of Biomass in Top Predators and Sharks\",\n    y = \"Proportion of Total Biomass\",\n    x = NULL\n  ) +\n  theme_minimal(base_size = 13)"
  },
  {
    "objectID": "eda_fish.html#by-family",
    "href": "eda_fish.html#by-family",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "5.1 By Family",
    "text": "5.1 By Family\n\n\nCode\nlibrary(paletteer)\n\ncreate_family_pal &lt;- function(col, n){\n  col &lt;- unique(col)\n  \n  foo &lt;- scales::colour_ramp(c(adjust_luminance(color = col, steps = +2),\n                      adjust_luminance(color = col, steps = -.5)))\n  \n  foo(seq(0, 1, length = n))\n}\n\ntaxa_colors &lt;- taxa_summary |&gt; \n  distinct(family, accepted_name, avg_biomass_m2) |&gt; \n  mutate(color_fam = highcharter::colorize(family, \n                              paletteer_d(\"ggsci::default_igv\", direction = -1, n = 43))) |&gt; \n  arrange(desc(family)) |&gt; \n  group_by(family) |&gt; \n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(n_taxa = n_distinct(accepted_name),\n         color_sp = highcharter::colorize(accepted_name,\n                             colors = create_family_pal(col = color_fam, n = n_taxa))) |&gt; \n  ungroup()\n\nhc_data &lt;- taxa_summary |&gt; \n  left_join(taxa_colors |&gt; \n              select(accepted_name, color_fam, color_sp)) |&gt; \n  filter(!is.na(color_sp)) |&gt; \n  mutate_if(is.numeric, round, 1) |&gt; \n  arrange(desc(family)) |&gt; \n  group_by(family) |&gt; \n  arrange(desc(avg_biomass_m2)) \n\n\ndata_to_hierarchical(hc_data,\n                     c(family, accepted_name), \n                     avg_biomass_m2, colors = unique(hc_data$color_fam)) |&gt; \n  hchart(\n    type = \"treemap\",\n    allowDrillToNode = TRUE,\n    levels = lvl_opts,\n    tooltip = list(valueDecimals = 1)) |&gt; \n  hc_chart(style = list(fontFamily = \"Times New Roman\")) |&gt; \n  hc_title(text = \"Fish biomass by family\",\n           style = list(fontFamily = \"Times New Roman\")) |&gt; \n  hc_size(height = 500) |&gt; \n  highcharter::hc_tooltip(crosshairs = T) \n\n\n\n\n\n\n\n\nFigure 19: Biomass by family\n\n\n\n\n\n\nCode\nlibrary(plotly)\n\n# 1. Get top 20 families by total biomass\ntop_fams &lt;- biomass_by_station_and_family |&gt; \n  group_by(family) |&gt; \n  summarize(total_biomass = sum(avg_biomass_m2, na.rm = TRUE), .groups = \"drop\") |&gt; \n  slice_max(total_biomass, n = 20) |&gt; \n  pull(family)\n\n# 2. Prepare data and group others into \"Other\"\nplot_data &lt;- biomass_by_station_and_family |&gt;\n  left_join(stations |&gt; distinct(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt;\n  mutate(family = if_else(family %in% top_fams, family, \"Other\")) |&gt; \n  group_by(region, subregion, family) |&gt;\n  summarize(avg_biomass_m2 = round(mean(avg_biomass_m2), 1), .groups = \"drop\") |&gt;\n  mutate(subregion = fct_reorder(subregion, avg_biomass_m2, .fun = sum, .desc = TRUE))\n\n# 3. Build family color scale (ensure 'Other' is included)\nfam_colors &lt;- taxa_colors |&gt; \n  filter(family %in% top_fams) |&gt; \n  distinct(family, color_fam) |&gt; \n  add_row(family = \"Other\", color_fam = \"#CCCCCC\") |&gt; \n  deframe()\n\n# 4. Plot\np &lt;- ggplot(plot_data, aes(x = subregion, y = avg_biomass_m2, fill = family)) +\n  geom_col() +\n  labs(x = \"\", y = \"Average biomass (g/m²)\", fill = \"\",\n       title = \"Fish Biomass by Family and Subregion\",\n       subtitle = \"Stacked bar plot showing mean biomass contributions by family (top 20 only)\") +\n  scale_fill_manual(values = fam_colors) +\n  theme_minimal(base_size = 13) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  guides(fill = guide_legend(nrow = 2, byrow = TRUE))+\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")\n\nggplotly(p, tooltip = c(\"x\", \"y\", \"fill\")) |&gt; \n  layout(legend = list(\n    orientation = \"h\",\n    xanchor = \"center\",\n    x = 0.5,\n    y = -0.25,\n    title = list(text = \"\")))\n\n\n\n\n\n\n\n\nFigure 20: Biomass by family and subregion"
  },
  {
    "objectID": "eda_fish.html#by-species",
    "href": "eda_fish.html#by-species",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "5.2 By Species",
    "text": "5.2 By Species\n\n\nCode\ntmp_plot &lt;- taxa_summary |&gt; \n  mutate(ind_100m2 = 100*avg_count_m2) |&gt; \n  mutate_if(is.numeric, round, 3) |&gt; \n  mutate(tooltip = c(paste0(\"Taxa = \", accepted_name,\n                            \"\\n Family = \", family,\n                            \"\\n Frequency (% stations) = \", freq_obs,\n                            \"\\n Abundance (ind/100m2) = \", ind_100m2,\n                            \"\\n Biomass (g/m2) = \", avg_biomass_m2))) |&gt; \n  ggplot()+\n  ggiraph::geom_point_interactive(aes(x = freq_obs, \n                                      y = ind_100m2, \n                                      size = avg_biomass_m2, \n                                      col = trophic_group, \n                                      tooltip = tooltip))+\n  scale_color_manual(values = trophic_palette, na.value = \"lightgrey\")+\n  scale_y_log10()+\n  labs(y = \"Abundance (Ind x 100m2)\", \n       x = \"Frequency (% station-strata)\", \n       col = \"Trophic group\", \n       size = \"Biomass\")+\n  ggthemes::theme_hc()+\n  theme(legend.title.position = \"top\", legend.position = \"right\")\n\nggiraph::girafe(ggobj = tmp_plot)\n\n\n\n\n\n\n\n\nFigure 21: Frequency, abundance, and biomass by species"
  },
  {
    "objectID": "eda_fish.html#species-contributions-to-dissimilarity",
    "href": "eda_fish.html#species-contributions-to-dissimilarity",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "7.1 Species contributions to dissimilarity",
    "text": "7.1 Species contributions to dissimilarity\nTo identify the species driving regional differences in community composition, we conducted a Similarity Percentages (SIMPER) analysis based on Bray-Curtis dissimilarity of biomass values. This method decomposes pairwise differences between regions into contributions by individual species, highlighting those most responsible for observed dissimilarities. For each pairwise comparison, we extracted the top ten contributing species and visualized their mean biomass in each region. These results offer an intuitive view of which taxa differentiate local assemblages and can help identify regionally distinctive or dominant species.\n\n\nCode\n# 1. Run SIMPER on all region pairs\nsimper_result &lt;- simper(spp_matrix, spp_meta$region, permutations = 999)\n\n# 2. Tidy the output into a long dataframe of top contributors\nsimper_summary_all &lt;- map_dfr(names(simper_result), \n                              function(pair_name) {\n                                sim &lt;- simper_result[[pair_name]]\n                                tibble(pair         = pair_name,\n                                       species      = sim$species,\n                                       avg_contrib  = sim$average,\n                                       sd_contrib   = sim$sd,\n                                       ratio        = sim$ratio,\n                                       mean_group_a = sim$ava,\n                                       mean_group_b = sim$avb,\n                                       cumsum       = sim$cusum,\n                                       p_value      = sim$p) |&gt;\n                                  arrange(desc(avg_contrib)) |&gt;\n                                  slice_head(n = 10) |&gt;\n                                  mutate(across(where(is.numeric), round, 3))})\n\n# 3. Add region labels and melt for plotting\nsimper_plot_data &lt;- simper_summary_all |&gt;\n  separate(pair, into = c(\"region_a\", \"region_b\"), sep = \"_\") |&gt;\n  pivot_longer(cols = c(mean_group_a, mean_group_b),\n               names_to = \"region_code\", values_to = \"mean_biomass\") |&gt;\n  mutate(region = case_when(region_code == \"mean_group_a\" ~ region_a,\n                            region_code == \"mean_group_b\" ~ region_b))\n\n# 4. Function to plot all comparisons for a given region\nplot_simper_by_focal &lt;- function(focal_region) {\n  \n  simper_plot_data |&gt;\n    filter(region_a == focal_region | region_b == focal_region) |&gt;\n    mutate(comparison = if_else(region_a == focal_region, region_b, region_a)) |&gt;\n    ggplot(aes(x = fct_reorder(species, avg_contrib), \n               y = mean_biomass, fill = region)) +\n    geom_col(position = \"dodge\") +\n    facet_wrap(~comparison, scales = \"free_x\") +\n    labs(title = glue(\"Top 10 Species Driving Differences with {focal_region}\"),\n         subtitle = \"SIMPER analysis (Bray-Curtis, biomass)\",\n         x = \"\", y = \"Mean biomass (g/m²)\", fill = \"\") +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1),\n          strip.text = element_text(face = \"bold\"),\n          legend.position = \"bottom\",\n      legend.box = \"horizontal\",\n      legend.text = element_text(size = 10))+\n    guides(fill = guide_legend(nrow = 1, byrow = TRUE))\n  \n}\n\n\n\nManusMuratWestern IslandsLovongai\n\n\n\n\nCode\n#|\n\nplot_simper_by_focal(\"Manus\")\n\n\n\n\n\n\n\n\nFigure 28: Top 10 species driving differences with Manus\n\n\n\n\n\n\n\n\n\nCode\n#|\n\nplot_simper_by_focal(\"Murat\")\n\n\n\n\n\n\n\n\nFigure 29: Top 10 species driving differences with Murat\n\n\n\n\n\n\n\n\n\nCode\n#|\n\nplot_simper_by_focal(\"Western Islands\")\n\n\n\n\n\n\n\n\nFigure 30: Top 10 species driving differences with the Western Islands\n\n\n\n\n\n\n\n\n\nCode\n#|\n\nplot_simper_by_focal(\"Lovongai\")\n\n\n\n\n\n\n\n\nFigure 31: Top 10 species driving differences with Lovongai"
  },
  {
    "objectID": "eda_fish.html#spatial-patterns",
    "href": "eda_fish.html#spatial-patterns",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "5.3 Spatial patterns",
    "text": "5.3 Spatial patterns\n\n\nCode\nlibrary(leaflet)\nlibrary(scales)\n\n# Normalize for circle radius (sqrt scaling for visual comparability)\nsite_summary &lt;- station_summary |&gt; \n  group_by(region, subregion, ps_site_id) |&gt; \n  summarize(mean_abundance = mean(avg_count_m2),\n            mean_biomass = mean(avg_biomass_m2, na.rm = TRUE),\n            n_transects = sum(n_transects, na.rm = TRUE),\n            .groups = \"drop\") |&gt; \n  left_join(uvs_sites |&gt; \n              select(ps_site_id, latitude, longitude), \n            by = \"ps_site_id\") \n\n\n\n\n\n\nMean fish biomass (g/m²) by site"
  },
  {
    "objectID": "eda_fish.html#taxa-summary-by-region",
    "href": "eda_fish.html#taxa-summary-by-region",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "8.1 Taxa Summary by Region",
    "text": "8.1 Taxa Summary by Region\n\n\n\nTable 9: Taxon-level summary by region"
  },
  {
    "objectID": "eda_fish.html#by-species-1",
    "href": "eda_fish.html#by-species-1",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "8.1 By Species",
    "text": "8.1 By Species\n\nLovongaiMuratManusWestern Islands\n\n\n\n\nCode\n# Filter Lovongai data\nlovongai_tbl &lt;- taxa_summary_by_region |&gt; \n  filter(region == \"Lovongai\", avg_biomass_m2 &gt; 0) |&gt;\n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(`Accepted name`             = accepted_name,\n         `Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3),\n         `Mean TL (cm)`              = avg_length_wm,\n         `Min TL (cm)`               = min_tl_cm,\n         `Max TL (cm)`               = max_tl_cm) |&gt;\n  select(family, `Accepted name`, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`,\n         `Mean TL (cm)`, `Min TL (cm)`, `Max TL (cm)`)\n\n# Render reactable\nreactable(lovongai_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Accepted name` = colDef(name = \"Accepted name\",\n                                     cell = function(value) htmltools::tags$i(value),\n                                     minWidth = 180),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish species\") |&gt;\n  add_subtitle(\"Summary of fish species observed in Lovongai\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish species\nSummary of fish species observed in Lovongai\n\n\n\n\n\n\n\n\nCode\n# Filter Murat data\nmurat_tbl &lt;- taxa_summary_by_region |&gt; \n  filter(region == \"Murat\", avg_biomass_m2 &gt; 0) |&gt;\n  mutate(`Accepted name`             = accepted_name,\n         `Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3),\n         `Mean TL (cm)`              = avg_length_wm,\n         `Min TL (cm)`               = min_tl_cm,\n         `Max TL (cm)`               = max_tl_cm) |&gt;\n  select(family, `Accepted name`, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`,\n         `Mean TL (cm)`, `Min TL (cm)`, `Max TL (cm)`)\n\n# Render reactable\nreactable(murat_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Accepted name` = colDef(name = \"Accepted name\",\n                                     cell = function(value) htmltools::tags$i(value),\n                                     minWidth = 180),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish species\") |&gt;\n  add_subtitle(\"Summary of fish species observed in Murat\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish species\nSummary of fish species observed in Murat\n\n\n\n\n\n\n\n\nCode\n# Filter Manus data\nmanus_tbl &lt;- taxa_summary_by_region |&gt; \n  filter(region == \"Manus\", avg_biomass_m2 &gt; 0) |&gt;\n  mutate(`Accepted name`             = accepted_name,\n         `Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3),\n         `Mean TL (cm)`              = avg_length_wm,\n         `Min TL (cm)`               = min_tl_cm,\n         `Max TL (cm)`               = max_tl_cm) |&gt;\n  select(family, `Accepted name`, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`,\n         `Mean TL (cm)`, `Min TL (cm)`, `Max TL (cm)`)\n\n# Render reactable\nreactable(manus_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Accepted name` = colDef(name = \"Accepted name\",\n                                     cell = function(value) htmltools::tags$i(value),\n                                     minWidth = 180),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish species\") |&gt;\n  add_subtitle(\"Summary of fish species observed in Manus\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish species\nSummary of fish species observed in Manus\n\n\n\n\n\n\n\n\nCode\n# Filter Murat data\nislands_tbl &lt;- taxa_summary_by_region |&gt; \n  filter(region == \"Western Islands\", avg_biomass_m2 &gt; 0) |&gt;\n  mutate(`Accepted name`             = accepted_name,\n         `Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3),\n         `Mean TL (cm)`              = avg_length_wm,\n         `Min TL (cm)`               = min_tl_cm,\n         `Max TL (cm)`               = max_tl_cm) |&gt;\n  select(family, `Accepted name`, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`,\n         `Mean TL (cm)`, `Min TL (cm)`, `Max TL (cm)`)\n\n# Render reactable\nreactable(islands_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 20,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Accepted name` = colDef(name = \"Accepted name\",\n                                     cell = function(value) htmltools::tags$i(value),\n                                     minWidth = 180),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish species\") |&gt;\n  add_subtitle(\"Summary of fish species observed in the Western Islands\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish species\nSummary of fish species observed in the Western Islands"
  },
  {
    "objectID": "eda_fish.html#by-family-1",
    "href": "eda_fish.html#by-family-1",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "8.2 By family",
    "text": "8.2 By family\n\nLovongaiMuratManusWestern Islands\n\n\n\n\nCode\n# Filter Lovongai data\nlovongai_tbl &lt;- family_summary_by_region |&gt; \n  filter(region == \"Lovongai\", avg_biomass_m2 &gt; 0) |&gt;\n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(`Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3)) |&gt;\n  select(family, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`)\n\n# Render reactable\nreactable(lovongai_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish families\") |&gt;\n  add_subtitle(\"Summary of fish families observed in Lovongai\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish families\nSummary of fish families observed in Lovongai\n\n\n\n\n\n\n\n\nCode\n# Filter Lovongai data\nmurat_tbl &lt;- family_summary_by_region |&gt; \n  filter(region == \"Murat\", avg_biomass_m2 &gt; 0) |&gt;\n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(`Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3)) |&gt;\n  select(family, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`)\n\n# Render reactable\nreactable(murat_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish families\") |&gt;\n  add_subtitle(\"Summary of fish families observed in Murat\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish families\nSummary of fish families observed in Murat\n\n\n\n\n\n\n\n\nCode\n# Filter Lovongai data\nmanus_tbl &lt;- family_summary_by_region |&gt; \n  filter(region == \"Manus\", avg_biomass_m2 &gt; 0) |&gt;\n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(`Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3)) |&gt;\n  select(family, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`)\n\n# Render reactable\nreactable(manus_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish families\") |&gt;\n  add_subtitle(\"Summary of fish families observed in Manus\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish families\nSummary of fish families observed in Manus\n\n\n\n\n\n\n\n\nCode\n# Filter Lovongai data\nislands_tbl &lt;- family_summary_by_region |&gt; \n  filter(region == \"Western Islands\", avg_biomass_m2 &gt; 0) |&gt;\n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(`Family`                  = family,\n         `Total count`             = total_count,\n         `Avg. count`              = round(avg_count, 2),\n         `Freq. occurrence (%)`    = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)` = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`     = round(avg_biomass_m2, 3)) |&gt;\n  select(family, `Total count`, `Avg. count`, `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`)\n\n# Render reactable\ntmp &lt;- reactable(islands_tbl,\n                 filterable      = TRUE,\n                 pagination      = TRUE,\n                 defaultPageSize = 10,\n                 striped         = TRUE,\n                 highlight       = TRUE,\n                 elementId       = \"summary-tbl\",\n                 defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n                 theme           = custom_tbl_theme,\n                 columns         = list(family                    = colDef(name = \"Family\", minWidth = 150),\n                                        `Freq. occurrence (%)`    = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n                                        `Avg. biomass (g/m²)`     = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n                                        `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish families\") |&gt;\n  add_subtitle(\"Summary of fish families observed in the Western Islands\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))"
  },
  {
    "objectID": "eda_lpi.html",
    "href": "eda_lpi.html",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "",
    "text": "Code\n# Load the data\n\nload(file = file.path(exp_path, \"data\", \"primary\", \"processed\", \"lpi\", \"lpi_staging.RData\"))\n\nsites &lt;- read_rds(file.path(exp_path, \"data/primary/processed/sites.rds\"))\n\nuvs_sites &lt;- sites$uvs\n\nregion_names &lt;- lpi_stations |&gt; \n  distinct(region) |&gt; \n  arrange(region) |&gt; \n  pull(region)\n\n# Create a clean inline string (e.g., \"Lovongai, Manus, Murat, and Western Islands\")\nregion_list &lt;- glue::glue_collapse(region_names, sep = \", \", last = \", and \")\n\nfunctional_group_order &lt;- c(\"hard coral\", \"cca\", \"soft coral\", \"sponges\", \"erect algae\", \"encrusting algae\", \"turf\", \"sediment/rubble/barren\", \"other\", \"cyanobacteria\")\n\nregion_order &lt;- c(\"Lovongai\", \"Murat\", \"Manus\", \"Western Islands\")\n\nfunctional_palette &lt;- c(\"hard coral\"             = \"#EA9E8D\",\n                        \"cca\"                    = \"#F1B6DA\",\n                        \"cyanobacteria\"          = \"#000000\",\n                        \"soft coral\"             = \"#B4D6D3\",\n                        \"sponges\"                = \"#F6C141\",\n                        \"sediment/rubble/barren\" = \"#BDBDBD\",\n                        \"encrusting algae\"       = \"#88B04B\",     # sage green\n                        \"erect algae\"            = \"#4DAF4A\",     # bright macroalgal green\n                        \"turf\"                   = \"#8C6D31\",     # slate blue\n                        \"other\"                  = \"#7C4D8E\")\n\nregion_palette &lt;- c(\"Murat\"           = \"#20C997\",  \n                    \"Lovongai\"        = \"#F94144\",  \n                    \"Manus\"           = \"#577590\",\n                    \"Western Islands\" = \"#F9C74F\")  \n\nhabitat_palette &lt;- c(\"fore reef\"  = \"#8BE0D4\",  # clearer aqua — more readable than pale cyan\n                     \"back reef\"  = \"#E67E7E\",  # soft coral red — distinct but not too aggressive\n                     \"channel\"    = \"#F4C542\",  # golden yellow — fits reef + sand imagery\n                     \"patch reef\" = \"#9370DB\"  )\nThis document presents an exploratory analysis of benthic community structure from the Pristine Seas: Papua New Guinea 2024 expedition. Using standardized Line Point-Intercept (LPI) surveys across diverse reef habitats and regions, we examine patterns in benthic richness, community composition, reef health indicators, and coral bleaching. The goal is to extract key ecological signals to inform downstream synthesis, conservation planning, and scientific reporting"
  },
  {
    "objectID": "eda_fish.html#biodiversity-surveys",
    "href": "eda_fish.html#biodiversity-surveys",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "3.1 Biodiversity surveys",
    "text": "3.1 Biodiversity surveys\nFor a subset of station in Manus and the Western Islands provinces, we also conducted biodiversity surveys to assess the diversity of reef fish communities. These surveys were designed to complement the standardized transect surveys and provide a more comprehensive understanding of the fish assemblages in these regions."
  },
  {
    "objectID": "eda_lpi.html#model",
    "href": "eda_lpi.html#model",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.2 Model",
    "text": "2.2 Model\nWe modeled morphotaxon richness per station using a Poisson GLMM, accounting for region, depth strata, and exposure, with site as a random effect (ps_site_id). Effect sizes are presented as incidence rate ratios (IRR) (Table 2)\n\n\nCode\nlibrary(lme4)\nlibrary(lmerTest)\nlibrary(parameters)\n\n# Poisson GLMM with random intercept for site\nglmm_richness &lt;- glmer(richness ~ region + depth_strata + exposure  + (1 | ps_site_id),\n                       data = richness_by_station,\n                       family = poisson())\n\n#performance::check_overdispersion(glmm_richness)\n\nglmm_richness_performance &lt;- performance::model_performance(glmm_richness)\n\n\nmodel_summary &lt;- model_parameters(glmm_richness, exponentiate = TRUE) |&gt;  # Exponentiated coefficients (IRRs) tell you multiplicative effects on richness\n  filter(Effects == \"fixed\") |&gt; \n  mutate(across(c(Coefficient, SE, z, CI_low, CI_high), ~ round(.x, 2)),\n         `95% CI` = sprintf(\"[%.2f, %.2f]\", CI_low, CI_high),\n         p        = case_when(is.na(p)             ~ \"NA\",\n                              p &lt; 0.001            ~ \"&lt; .001\",\n                              TRUE                 ~ formatC(as.numeric(p), format = \"f\", digits = 3))) |&gt; \n  select(Parameter, IRR = Coefficient, SE, `95% CI`, z, `p-value` = p) \n\n\nThe Poisson GLMM revealed significant regional differences in benthic morphotaxon richness across surveyed reefs. Stations in Murat exhibited 23% lower richness compared to the baseline region, Lovongai, while Manus showed a 16% increase, suggesting higher taxonomic diversity in that area. No meaningful effects were detected for depth strata or exposure, indicating that richness patterns were primarily structured by regional differences rather than local environmental gradients. The estimated baseline richness under reference conditions was approximately 19 morphotaxa per station.\n\n\nCode\nclean_parameter_labels &lt;- function(param_vec) {\n  param_vec |&gt;\n    str_replace(\"^\\\\(Intercept\\\\)$\", \"Intercept (baseline)\") |&gt;\n    str_replace(\"^region\", \"Region: \") |&gt;\n    str_replace(\"^depth_strata\", \"Depth: \") |&gt;\n    str_replace(\"^exposure\", \"Exposure: \") |&gt;\n    str_replace_all(\"_\", \" \") |&gt;\n    str_to_sentence() \n  }\n\nmodel_summary |&gt; \n  mutate(Parameter = clean_parameter_labels(Parameter)) |&gt; \n  gt(rowname_col = \"Parameter\") |&gt; \n  tab_header(title = md(\"**Model Summary: Benthic Richness (Poisson GLMM)**\"),\n             subtitle = \"Fixed effects as incidence rate ratios (IRRs)\") |&gt;\n  tab_style( style = list(cell_fill(color = \"#f9f9f9\")),\n             locations = cells_body()) |&gt; \n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(columns = vars(`p-value`),\n                                   rows = `p-value` == \"&lt; .001\")) |&gt; \n  cols_align(align = \"center\") |&gt; \n  opt_row_striping() |&gt; \n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\nTable 2: Model summary of morphotaxon richness\n\n\n\n\n\n\n\n\n\nModel Summary: Benthic Richness (Poisson GLMM)\n\n\nFixed effects as incidence rate ratios (IRRs)\n\n\n\nIRR\nSE\n95% CI\nz\np-value\n\n\n\n\nIntercept (baseline)\n18.72\n2.17\n[14.91, 23.50]\n25.24\n&lt; .001\n\n\nRegion: murat\n0.77\n0.05\n[0.67, 0.88]\n-3.84\n&lt; .001\n\n\nRegion: manus\n1.16\n0.08\n[1.01, 1.33]\n2.06\n0.040\n\n\nRegion: western islands\n1.09\n0.07\n[0.96, 1.23]\n1.35\n0.176\n\n\nDepth: shallow\n0.99\n0.04\n[0.92, 1.07]\n-0.16\n0.874\n\n\nDepth: supershallow\n1.00\n0.12\n[0.79, 1.28]\n0.01\n0.995\n\n\nExposure: leeward\n1.10\n0.12\n[0.88, 1.37]\n0.83\n0.407\n\n\nExposure: windward\n1.07\n0.13\n[0.85, 1.35]\n0.60\n0.550\n\n\n\n\n\n\n\n\n\n\nThe model’s conditional R² (0.45) indicates that 45% of the variation in richness is explained by both fixed (region, depth, exposure) and random effects (site-level variation). The marginal R², representing variation explained by fixed effects alone, was 0.31.\n\nEstimated Marginal Means\nPairwise comparisons reveal that Murat consistently had lower benthic richness than the other regions, with significantly reduced richness compared to Lovongai, Manus, and the Western Islands (p &lt; .001 in all cases)(Table 3). In contrast, richness differences among Lovongai, Manus, and Western Islands were not statistically significant, suggesting broadly comparable community diversity across these regions.\n\n\nCode\nlibrary(emmeans)\n\nemm_region &lt;- emmeans(glmm_richness, ~ region, type = \"response\")\n\npairs_region &lt;- pairs(emm_region, adjust = \"tukey\")\n\nsummary(pairs_region) |&gt;\n  as_tibble() |&gt;\n  mutate(ratio      = round(ratio, 2),\n         SE         = round(SE, 2),\n         z.ratio    = round(z.ratio, 2),\n         p.value    = case_when(\n           is.na(p.value) ~ \"NA\",\n           p.value &lt; 0.001 ~ \"&lt; .001\",\n           TRUE ~ formatC(p.value, format = \"f\", digits = 3))) |&gt; \n  select(contrast, ratio, SE, z.ratio, p.value) |&gt; \n  gt() |&gt; \n  tab_header(\n    title = md(\"**Pairwise Regional Comparisons: Benthic Richness**\"),\n    subtitle = \"Tukey-adjusted incidence rate ratios (IRRs)\"\n  ) |&gt;\n  tab_style(\n    style = list(cell_fill(color = \"#f9f9f9\")),\n    locations = cells_body()\n  ) |&gt;\n  tab_style(\n    style = cell_text(weight = \"bold\", color = \"black\"),\n    locations = cells_body(columns = vars(`p.value`), rows = `p.value` == \"&lt; .001\")\n  ) |&gt;\n  cols_align(align = \"center\") |&gt;\n  opt_row_striping() |&gt;\n  tab_options(\n    table.font.size = \"small\",\n    row.striping.include_table_body = TRUE,\n    table.border.top.color = \"white\",\n    table.border.bottom.color = \"white\",\n    heading.title.font.size = 16,\n    heading.subtitle.font.size = 13,\n    row.striping.background_color = \"#f0f0f0\",\n    column_labels.font.weight = \"bold\"\n  )\n\n\n\n\nTable 3: Pairwise regional comparisons of benthic richness\n\n\n\n\n\n\n\n\n\nPairwise Regional Comparisons: Benthic Richness\n\n\nTukey-adjusted incidence rate ratios (IRRs)\n\n\ncontrast\nratio\nSE\nz.ratio\np.value\n\n\n\n\nLovongai / Murat\n1.30\n0.09\n3.84\n&lt; .001\n\n\nLovongai / Manus\n0.86\n0.06\n-2.06\n0.167\n\n\nLovongai / Western Islands\n0.92\n0.06\n-1.35\n0.529\n\n\nMurat / Manus\n0.66\n0.04\n-6.06\n&lt; .001\n\n\nMurat / Western Islands\n0.71\n0.04\n-5.95\n&lt; .001\n\n\nManus / Western Islands\n1.07\n0.06\n1.06\n0.715\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Estimated marginal means by region\n\nemm_region |&gt; \n  cld(adjust = \"tukey\", Letters = letters, alpha = 0.05) |&gt; \n  ggplot(aes(x = reorder(region, rate), y = rate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2, color = \"#065A82\")+\n  geom_text(aes(label = .group), vjust = -1, hjust = 0.05, size = 5, fontface = \"bold\")+\n  labs(title = \"Estimated Species Richness by Region\",\n       subtitle = \"Letters indicate groups that are not significantly different (Tukey-adjusted, α = 0.05)\",\n       x = NULL,\n       y = \"Estimated richness (± 95% CI)\") +\n  expand_limits(y = 0)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\n\n\n\nDid we sample enough?\nTo assess how benthic morphotaxon richness accumulates with increasing sampling effort, we generated species accumulation curves for each region based on presence-weighted morphotaxon cover data (Figure 5). These curves visualize how the number of unique morphotaxa increases as additional stations are sampled, providing insight into both regional diversity and sampling completeness. The shaded bands reflect variability among sites, giving an indication of habitat heterogeneity and community turnover within regions.\n\n\nCode\nlibrary(vegan)\n\n# Species matrix with one row per station × region\ntaxa_cover_matrix &lt;- cover_by_station_and_taxa |&gt; \n  left_join(lpi_stations |&gt; distinct(ps_station_id, region), by = \"ps_station_id\") |&gt; \n  filter(contacts &gt; 0) |&gt; \n  select(region, ps_station_id, morphotaxon, contacts) |&gt; \n  pivot_wider(id_cols = c(region, ps_station_id),\n              names_from = morphotaxon,\n              values_from = contacts,\n              values_fill = list(contacts = 0) )\n\n# 1. Nest species matrix by region\n\ntaxa_nested &lt;- taxa_cover_matrix |&gt; \n  group_by(region) |&gt; \n  nest()\n\n# 2. Compute specaccum per region\naccum_curves &lt;- taxa_nested |&gt; \n  mutate(\n    acc = map(data, ~ specaccum(select(.x, where(is.numeric)), method = \"random\")),\n    curve = map(acc, ~ tibble(\n      station_number = .x$sites,\n      richness = .x$richness,\n      sd = .x$sd\n    ))\n  ) |&gt; \n  select(region, curve) |&gt; \n  unnest(curve)\n\n# 3. Plot\nggplot(accum_curves, aes(x = station_number, y = richness, color = region, fill = region)) +\n  geom_line(linewidth = 1) +\n  geom_ribbon(aes(ymin = richness - sd, ymax = richness + sd), alpha = 0.2, color = NA) +\n  labs(title = \"Morphotaxa Accumulation Curves by Region\",\n       x = \"Number of Stations\",\n       y = \"Accumulated Morphotaxa Richness\") +\n  theme(legend.position = \"bottom\")+\n  labs(fill = \"\", col = \"\")\n\n\n\n\n\n\n\n\nFigure 5: Morphotaxa accumulation curves by region\n\n\n\n\n\nSpecies accumulation patterns reveal marked regional differences in benthic diversity. Manus and Western Islands stand out as the most species-rich and heterogeneous, with curves that continue to rise and broad confidence bands. Lovongai shows moderate richness and appears to be more completely sampled, while Murat exhibits the lowest richness and least variability. Together, these curves provide a baseline for comparing biodiversity across regions and evaluating the sufficiency of sampling efforts."
  },
  {
    "objectID": "eda_lpi.html#did-we-sample-enough",
    "href": "eda_lpi.html#did-we-sample-enough",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.2 Did we sample enough?",
    "text": "2.2 Did we sample enough?\nTo assess how benthic morphotaxon richness accumulates with increasing sampling effort, we generated species accumulation curves for each region based on presence-weighted morphotaxon cover data (Figure 5). These curves visualize how the number of unique morphotaxa increases as additional stations are sampled, providing insight into both regional diversity and sampling completeness. The shaded bands reflect variability among sites, giving an indication of habitat heterogeneity and community turnover within regions.\n\n\nCode\nlibrary(vegan)\n\n# Species matrix with one row per station × region\ntaxa_cover_matrix &lt;- cover_by_station_and_taxa |&gt; \n  left_join(lpi_stations |&gt; distinct(ps_station_id, region), by = \"ps_station_id\") |&gt; \n  filter(contacts &gt; 0) |&gt; \n  select(region, ps_station_id, morphotaxon, contacts) |&gt; \n  pivot_wider(id_cols = c(region, ps_station_id),\n              names_from = morphotaxon,\n              values_from = contacts,\n              values_fill = list(contacts = 0) )\n\n# 1. Nest species matrix by region\n\ntaxa_nested &lt;- taxa_cover_matrix |&gt; \n  group_by(region) |&gt; \n  nest()\n\n# 2. Compute specaccum per region\naccum_curves &lt;- taxa_nested |&gt; \n  mutate(\n    acc = map(data, ~ specaccum(select(.x, where(is.numeric)), method = \"random\")),\n    curve = map(acc, ~ tibble(\n      station_number = .x$sites,\n      richness = .x$richness,\n      sd = .x$sd\n    ))\n  ) |&gt; \n  select(region, curve) |&gt; \n  unnest(curve)\n\n# 3. Plot\nggplot(accum_curves, aes(x = station_number, y = richness, color = region, fill = region)) +\n  geom_line(linewidth = 1) +\n  geom_ribbon(aes(ymin = richness - sd, ymax = richness + sd), alpha = 0.2, color = NA) +\n  labs(title = \"Species Accumulation Curves by Region\",\n       x = \"Number of Stations\",\n       y = \"Accumulated Species Richness\") +\n  theme(legend.position = \"bottom\")+\n  labs(fill = \"\", col = \"\")\n\n\n\n\n\n\n\n\nFigure 5: Species accumulation curves by region\n\n\n\n\n\nSpecies accumulation patterns reveal marked regional differences in benthic diversity. Manus and Western Islands stand out as the most species-rich and heterogeneous, with curves that continue to rise and broad confidence bands. Lovongai shows moderate richness and appears to be more completely sampled, while Murat exhibits the lowest richness and least variability. Together, these curves provide a baseline for comparing biodiversity across regions and evaluating the sufficiency of sampling efforts."
  },
  {
    "objectID": "eda_lpi.html#visualize",
    "href": "eda_lpi.html#visualize",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.1 Visualize",
    "text": "2.1 Visualize\n\n\nCode\nrichness_by_station &lt;- lpi_observations |&gt;\n  group_by(ps_station_id) |&gt;\n  summarise(richness = n_distinct(morphotaxon[contacts &gt; 0]), .groups = \"drop\") |&gt;\n  left_join(lpi_stations, by = \"ps_station_id\") |&gt; \n  mutate(region = factor(region, levels = region_order))\n\n\n\nRegionDepth strataDiver\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = region, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa Richness by Region\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 2: Morphotaxa richness by region\n\n\n\n\n\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = depth_strata, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa Richness by strata\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 3: Morphotaxa richnnes by depth\n\n\n\n\n\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = diver, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa richness by diver\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 4: Morphotaxa richnnes by diver"
  },
  {
    "objectID": "eda_lpi.html#by-morphotaxa",
    "href": "eda_lpi.html#by-morphotaxa",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "4.1 By morphotaxa",
    "text": "4.1 By morphotaxa\n\nPERMANOVA\n\n\nCode\n# 1. Create community matrix (stations × morphotaxa)\n\ncover_matrix &lt;- cover_by_station_and_taxa |&gt;\n  select(ps_station_id, morphotaxon, pct_cover) |&gt;\n  pivot_wider(names_from = morphotaxon, values_from = pct_cover, values_fill = 0) |&gt;\n  column_to_rownames(\"ps_station_id\")\n\n# 2. Prepare station metadata\nstation_meta &lt;- lpi_stations |&gt;\n  select(ps_station_id, region, habitat, depth_strata, exposure)\n\n# 3. ADONIC\n\nadonis_by_taxa &lt;- adonis2(cover_matrix ~ region + depth_strata + habitat + exposure, \n                           data = station_meta,\n                           method = \"bray\",\n                           permutations = 999,\n                           by = \"margin\")\n\nadonis_by_taxa_tbl &lt;- broom::tidy(adonis_by_taxa) |&gt; \n  mutate(p_value = case_when(is.na(p.value)   ~ NA_character_,\n                             p.value &lt;= 0.001 ~ \"&lt; .001\",\n                             TRUE             ~ formatC(p.value, format = \"f\", digits = 3)),\n         across(c(R2, statistic, SumOfSqs), ~ round(.x, 3))) |&gt; \n  select(term, df, sumsq = SumOfSqs, r2 = R2, stat = statistic, p_value)\n\n\nTo test for differences in benthic community composition, we ran a PERMANOVA (adonis2) using Bray-Curtis dissimilarities derived from morphotaxa percent cover. The model included region, depth_strata, habitat, and exposure as predictors (Table 5).\nSignificant variation was detected by region (r2 = 18.4%, p = &lt; .001), depth strata (r2 = 2.6%, p = 0.002), and exposure (r2 = 2.6%, p = 0.002), while habitat was not significant.\nOverall, the model explained 26.7% of the total variance in benthic community composition.\n\n\nCode\n# Continue from your adonis_tbl\nadonis_by_taxa_tbl |&gt; \n  select(Term = term, Df = df, `Sum of Squares` = sumsq, `R²` = r2, `F-value` = stat, `p-value` = p_value) |&gt; \n  gt(rowname_col = \"Term\") |&gt; \n  tab_header(title = md(\"**PERMANOVA Results: Benthic Community Composition**\"),\n             subtitle = \"Bray-Curtis dissimilarity | 999 permutations\") |&gt; \n  tab_style(style = list(cell_fill(color = \"#f9f9f9\")),\n            locations = cells_body()) |&gt; \n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(columns = c(`p-value`), rows = `p-value` == \"&lt; .001\")) |&gt; \n  cols_align(align = \"center\",\n             columns = everything()) |&gt; \n  opt_row_striping() |&gt; \n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\nTable 5: PERMANOVA results for benthic community composition by functional group (Bray-Curtis dissimilarities)\n\n\n\n\n\n\n\n\n\nPERMANOVA Results: Benthic Community Composition\n\n\nBray-Curtis dissimilarity | 999 permutations\n\n\n\nDf\nSum of Squares\nR²\nF-value\np-value\n\n\n\n\nregion\n3\n5.611\n0.184\n12.199\n&lt; .001\n\n\ndepth_strata\n2\n0.809\n0.026\n2.637\n0.002\n\n\nhabitat\n3\n0.513\n0.017\n1.116\n0.296\n\n\nexposure\n2\n0.781\n0.026\n2.548\n0.002\n\n\nResidual\n146\n22.385\n0.733\nNA\nNA\n\n\nTotal\n156\n30.542\n1.000\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\n\nOrdination\n\n\nCode\n# 3. NMDS ordination (2D)\nnmds_by_taxa &lt;- suppressMessages(\n  metaMDS(cover_matrix,\n          distance = \"bray\",\n          k = 3,\n          trymax = 100,\n          autotransform = FALSE,\n          noshare = TRUE,\n          trace = 0))\n\n# 4. Fit morphotaxon vectors to NMDS\nenvfit_by_taxa &lt;- envfit(nmds_by_taxa,\n                      cover_matrix,\n                      permutations = 999)\n\n# 5. Extract significant morphotaxon vectors (p &lt; 0.05 and r² &gt; 0.3)\nnmds_taxa_vectors &lt;- scores(envfit_by_taxa, display = \"vectors\") |&gt;\n  as.data.frame() |&gt;\n  rownames_to_column(\"morphotaxon\") |&gt;\n  mutate(pval = envfit_by_taxa$vectors$pvals[morphotaxon],\n         r2   = envfit_by_taxa$vectors$r[morphotaxon]) |&gt;\n  filter(pval &lt; 0.05, r2 &gt; 0.3)\n\n# 6. NMDS site scores + metadata\nnmds_by_taxa_sites &lt;- scores(nmds_by_taxa, display = \"sites\") |&gt;\n  as.data.frame() |&gt;\n  rownames_to_column(var = \"ps_station_id\") |&gt;\n  left_join(station_meta, by = \"ps_station_id\")\n\n\nWe followed with a 2D NMDS (stress = 0.138) to visualize spatial patterns in community structure. Points represent individual stations, colored by region and shaped by depth stratum. Overlaid ellipses capture 75% confidence contours for each region.\n\n\nCode\nggplot() +\n  geom_point(data = nmds_by_taxa_sites,\n             aes(x = NMDS1, y = NMDS2, color = region, shape = depth_strata),\n             size = 3, alpha = 0.9) +\n  geom_segment(data = nmds_taxa_vectors,\n               aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),\n               arrow = arrow(length = unit(0.25, \"cm\")),\n               color = \"gray40\", linewidth = 0.8) +\n  geom_text_repel(data = nmds_taxa_vectors,\n                  aes(x = NMDS1, y = NMDS2, label = morphotaxon),\n                  size = 3, color = \"gray20\",\n                  segment.color = \"grey50\",\n                  max.overlaps = 15, min.segment.length = 0) +\n  stat_ellipse(data = nmds_by_taxa_sites,\n               aes(x = NMDS1, y = NMDS2, group = region, color = region),\n               linetype = \"dashed\", level = 0.75, linewidth = 0.6) +\n  labs(title = \"NMDS Ordination of Benthic Community Structure\",\n       subtitle = glue::glue(\"Bray-Curtis dissimilarity | Stress = {round(nmds_by_taxa$stress, 3)}\"),\n       caption = \"Arrows show morphotaxa significantly correlated with NMDS axes (p &lt; 0.05, R² &gt; 0.3).\\nArrow length reflects correlation strength.\",\n       x = \"NMDS Axis 1\", \n       y = \"NMDS Axis 2\",\n       color = \"\", \n       shape = \"\") +\n  coord_equal() +\n  theme(legend.position = \"right\",\n        legend.box = \"vertical\",\n        plot.title = element_text(face = \"bold\", size = 16),\n        plot.subtitle = element_text(size = 13),\n        plot.caption = element_text(size = 10, hjust = 0),\n        axis.title = element_text(face = \"bold\")) +\n  scale_color_manual(values = region_palette)\n\n\n\n\n\n\n\n\nFigure 8: NMDS Ordination of Benthic Community Structure"
  },
  {
    "objectID": "eda_lpi.html#by-functional-group",
    "href": "eda_lpi.html#by-functional-group",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "4.2 By functional group",
    "text": "4.2 By functional group\nTo simplify community structure and relate it to ecological function, we grouped morphotaxa into benthic functional categories (e.g., hard coral, turf, CCA, cyanobacteria). This approach facilitates interpretation, especially for reef health and management applications.\n\nCover\n\n\nCode\n# 1. Get average cover by functional group and subregion\n\nfunc_cover_by_station &lt;- cover_by_station_and_taxa |&gt; \n  group_by(ps_station_id, functional_group) |&gt; \n  summarize(contacts = sum(contacts), .groups = \"drop\") |&gt; \n  group_by(ps_station_id) |&gt; \n  mutate(pct_cover = round(contacts / sum(contacts) * 100, 3)) \n  \nfunc_cover_by_subregion &lt;- func_cover_by_station |&gt; \n  left_join(lpi_stations |&gt; \n              distinct(ps_station_id, region, subregion)) |&gt; \n  group_by(region, subregion, functional_group) |&gt;\n  summarize(n_stations =  n_distinct(ps_station_id),\n            avg_cover = mean(pct_cover, na.rm = TRUE), .groups = \"drop\") |&gt; \n  mutate(functional_group = factor(functional_group, levels = functional_group_order)) \n\nfunc_cover_by_subregion |&gt; \n  group_by(subregion) |&gt; \n  mutate(avg_cover_rescaled = avg_cover / sum(avg_cover) * 100) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover_rescaled, fill = functional_group))+\n  geom_col()+\n  scale_fill_manual(values = functional_palette)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\")+\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")+\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % Cover by Functional Group and Subregion\",\n       fill = \"\")\n\n\n\n\n\n\n\n\nFigure 9: Average Cover by Functional Group and Subregion\n\n\n\n\n\n\n\nCode\nfunc_cover_by_region &lt;- func_cover_by_station |&gt; \n  left_join(lpi_stations |&gt; \n              distinct(ps_station_id, region, subregion)) |&gt; \n  group_by(region, functional_group) |&gt;\n  summarize(n_stations =  n_distinct(ps_station_id),\n            avg_cover = mean(pct_cover, na.rm = TRUE), .groups = \"drop\") |&gt; \n  mutate(functional_group = factor(functional_group, levels = functional_group_order),\n         label_pct = paste0(round(avg_cover, 1), \"%\"))\n\n# Pie chart by region with percent labels\n\nfunc_cover_by_region |&gt; \n  group_by(region) |&gt; \n  mutate(avg_cover = avg_cover / sum(avg_cover) * 100) |&gt; \n  ggplot(aes(x = \"\", y = avg_cover, fill = functional_group)) +\n  geom_col(width = 1, color = \"white\") +\n  coord_polar(theta = \"y\") +\n  facet_wrap(~region, ncol = 2) +\n  scale_fill_manual(values = functional_palette) +\n  geom_text(aes(label = ifelse(avg_cover &gt; 4, label_pct, \"\")),  # hide labels &lt; 4% for clarity\n            position = position_stack(vjust = 0.5),\n            size = 3.5,\n            color = \"white\",\n            fontface = \"bold\") +\n  labs(title = \"Relative Benthic Cover by Functional Group\",\n       subtitle = \"Average % cover per region\",\n       fill = \"\",\n       x = NULL,\n       y = NULL) +\n  theme_void(base_size = 14) +\n  theme(strip.text = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(face = \"bold\", size = 16, hjust = 0.5),\n        plot.subtitle = element_text(size = 13, hjust = 0.5),\n        legend.position = \"bottom\",\n        legend.title = element_text(face = \"bold\"),\n        legend.key.size = unit(0.4, \"cm\"),\n        legend.text = element_text(size = 11))\n\n\n\n\n\n\n\n\nFigure 10: Average Cover by Functional Group and Region\n\n\n\n\n\n\n\nPERMANOVA\n\n\nCode\n# 1. Create community matrix (stations × morphotaxa)\nfunc_cover_matrix &lt;- func_cover_by_station |&gt;\n  select(ps_station_id, functional_group, pct_cover) |&gt;\n  pivot_wider(names_from = functional_group, values_from = pct_cover, values_fill = 0) |&gt;\n  column_to_rownames(\"ps_station_id\")\n\n# 2. Prepare station metadata\nstation_meta &lt;- lpi_stations |&gt;\n  select(ps_station_id, region, habitat, depth_strata, exposure)\n\n# 3. PERMANOVA\n\nadonis_func &lt;- adonis2(func_cover_matrix ~ region + depth_strata + habitat + exposure, \n                           data = station_meta,\n                           method = \"bray\",\n                           permutations = 999,\n                           by = \"margin\")\n\nadonis_func_tbl &lt;- broom::tidy(adonis_func) |&gt; \n  mutate(p_value = case_when(is.na(p.value)   ~ NA_character_,\n                             p.value &lt;= 0.001 ~ \"&lt; .001\",\n                             TRUE             ~ formatC(p.value, format = \"f\", digits = 3)),\n         across(c(R2, statistic, SumOfSqs), ~ round(.x, 3))) |&gt; \n  select(term, df, sumsq = SumOfSqs, r2 = R2, stat = statistic, p_value)\n\n\nTo test for differences in benthic community composition, we ran a PERMANOVA (adonis2) using Bray-Curtis dissimilarities derived from functional group percent cover. The model included region, depth_strata, habitat, and exposure as predictors.\nSignificant variation was detected by region (r2 = 13.2%, p = &lt; .001), depth strata (r2 = 3.8%, p = &lt; .001), and exposure (r2 = 3.5%, p = &lt; .001), while habitat was not significant.\nOverall, the model explained 23.2% of the total variance in benthic community composition.\n\n\nCode\n# Continue from your adonis_tbl\nadonis_func_tbl |&gt; \n  select(Term = term, Df = df, `Sum of Squares` = sumsq, `R²` = r2, `F-value` = stat, `p-value` = p_value) |&gt; \n  gt(rowname_col = \"Term\") |&gt; \n  tab_header(title = md(\"**PERMANOVA Results: Benthic Community Composition**\"),\n             subtitle = \"Bray-Curtis dissimilarity | 999 permutations\") |&gt; \n  tab_style(style = list(cell_fill(color = \"#f9f9f9\")),\n            locations = cells_body()) |&gt; \n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(columns = c(`p-value`), rows = `p-value` == \"&lt; .001\")) |&gt; \n  cols_align(align = \"center\",\n             columns = everything()) |&gt; \n  opt_row_striping() |&gt; \n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\nTable 6: PERMANOVA results for benthic community composition by functional group (Bray-Curtis dissimilarities)\n\n\n\n\n\n\n\n\n\nPERMANOVA Results: Benthic Community Composition\n\n\nBray-Curtis dissimilarity | 999 permutations\n\n\n\nDf\nSum of Squares\nR²\nF-value\np-value\n\n\n\n\nregion\n3\n2.415\n0.132\n8.384\n&lt; .001\n\n\ndepth_strata\n2\n0.688\n0.038\n3.585\n&lt; .001\n\n\nhabitat\n3\n0.323\n0.018\n1.122\n0.290\n\n\nexposure\n2\n0.634\n0.035\n3.305\n&lt; .001\n\n\nResidual\n146\n14.016\n0.768\nNA\nNA\n\n\nTotal\n156\n18.259\n1.000\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\n\nOrdination\n\n\nCode\n# 3. NMDS ordination (2D)\nnmds_func &lt;- suppressMessages(\n  metaMDS(func_cover_matrix,\n          distance = \"bray\",\n          k = 3,\n          trymax = 100,\n          autotransform = FALSE,\n          noshare = TRUE,\n          trace = 0))\n\n# 4. Fit functional_group vectors to NMDS\nenvfit_func &lt;- envfit(nmds_func,\n                      func_cover_matrix,\n                      permutations = 999)\n\n# 5. Extract significant functional_group vectors (p &lt; 0.05 and r² &gt; 0.3)\nnmds_func_vectors &lt;- scores(envfit_func, display = \"vectors\") |&gt;\n  as.data.frame() |&gt;\n  rownames_to_column(\"functional_group\") |&gt;\n  mutate(pval = envfit_func$vectors$pvals[functional_group],\n         r2   = envfit_func$vectors$r[functional_group]) |&gt;\n  filter(pval &lt; 0.05, r2 &gt; 0.3)\n\n# 6. NMDS site scores + metadata\nnmds_func_sites &lt;- scores(nmds_func, display = \"sites\") |&gt;\n  as.data.frame() |&gt;\n  rownames_to_column(var = \"ps_station_id\") |&gt;\n  left_join(station_meta, by = \"ps_station_id\")\n\n\nWe followed with a 2D NMDS (stress = 0.12) to visualize spatial patterns in community structure. Points represent individual stations, colored by region and shaped by depth stratum. Overlaid ellipses capture 75% confidence contours for each region.\n\n\nCode\nggplot() +\n  geom_point(data = nmds_func_sites,\n             aes(x = NMDS1, y = NMDS2, color = region, shape = depth_strata),\n             size = 3, alpha = 0.9) +\n  geom_segment(data = nmds_func_vectors,\n               aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),\n               arrow = arrow(length = unit(0.25, \"cm\")),\n               color = \"gray40\", linewidth = 0.8) +\n  geom_text_repel(data = nmds_func_vectors,\n                  aes(x = NMDS1, y = NMDS2, label = functional_group),\n                  size = 3, color = \"gray20\",\n                  segment.color = \"grey50\",\n                  max.overlaps = 15, min.segment.length = 0) +\n  stat_ellipse(data = nmds_func_sites,\n               aes(x = NMDS1, y = NMDS2, group = region, color = region),\n               linetype = \"dashed\", level = 0.75, linewidth = 0.6) +\n  labs(title = \"NMDS Ordination of Benthic Community Structure\",\n       subtitle = glue::glue(\"Bray-Curtis dissimilarity | Stress = {round(nmds_func$stress, 3)}\"),\n       caption = \"Arrows show functional groups significantly correlated with NMDS axes (p &lt; 0.05, R² &gt; 0.3).\\nArrow length reflects correlation strength.\",\n       x = \"NMDS Axis 1\", \n       y = \"NMDS Axis 2\",\n       color = \"\", \n       shape = \"\") +\n  coord_equal() +\n  theme(legend.position = \"right\",\n        legend.box = \"vertical\",\n        plot.title = element_text(face = \"bold\", size = 16),\n        plot.subtitle = element_text(size = 13),\n        plot.caption = element_text(size = 10, hjust = 0),\n        axis.title = element_text(face = \"bold\")) +\n  scale_color_manual(values = region_palette)\n\n\n\n\n\n\n\n\nFigure 11: NMDS Ordination of Benthic Community Structure by Functional Group\n\n\n\n\n\nEnvfit vectors show morphotaxa significantly associated with community structure (p &lt; 0.05, R² &gt; 0.3), offering insight into the dominant ecological drivers."
  },
  {
    "objectID": "eda_lpi.html#patterns",
    "href": "eda_lpi.html#patterns",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.1 Patterns",
    "text": "2.1 Patterns\n\n\nCode\nrichness_by_station &lt;- lpi_observations |&gt;\n  group_by(ps_station_id) |&gt;\n  summarise(richness = n_distinct(morphotaxon[contacts &gt; 0]), .groups = \"drop\") |&gt;\n  left_join(lpi_stations, by = \"ps_station_id\") |&gt; \n  mutate(region = factor(region, levels = region_order))\n\n\n\nRegionDepth strataDiver\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = region, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa Richness by Region\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 4: Morphotaxa richness by region\n\n\n\n\n\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = depth_strata, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa Richness by strata\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 5: Morphotaxa richnnes by depth\n\n\n\n\n\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = diver, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa richness by diver\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 6: Morphotaxa richnnes by diver"
  },
  {
    "objectID": "eda_lpi.html#statistical-model",
    "href": "eda_lpi.html#statistical-model",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.2 Statistical model",
    "text": "2.2 Statistical model\nWe modeled morphotaxon richness per station using a Poisson GLMM, accounting for region, depth strata, and exposure, with site as a random effect (ps_site_id). Effect sizes are presented as incidence rate ratios (IRR) (Table 3)\n\n\nCode\nlibrary(lme4)\nlibrary(lmerTest)\nlibrary(parameters)\n\n# Poisson GLMM with random intercept for site\nglmm_richness &lt;- glmer(richness ~ region + depth_strata + exposure  + (1 | ps_site_id),\n                       data = richness_by_station,\n                       family = poisson())\n\n#performance::check_overdispersion(glmm_richness)\n\nglmm_richness_performance &lt;- performance::model_performance(glmm_richness)\n\n\nmodel_summary &lt;- model_parameters(glmm_richness, exponentiate = TRUE) |&gt;  # Exponentiated coefficients (IRRs) tell you multiplicative effects on richness\n  filter(Effects == \"fixed\") |&gt; \n  mutate(across(c(Coefficient, SE, z, CI_low, CI_high), ~ round(.x, 2)),\n         `95% CI` = sprintf(\"[%.2f, %.2f]\", CI_low, CI_high),\n         p        = case_when(is.na(p)             ~ \"NA\",\n                              p &lt; 0.001            ~ \"&lt; .001\",\n                              TRUE                 ~ formatC(as.numeric(p), format = \"f\", digits = 3))) |&gt; \n  select(Parameter, IRR = Coefficient, SE, `95% CI`, z, `p-value` = p) \n\n\n\nSummary\nThe Poisson GLMM revealed significant regional differences in benthic morphotaxon richness across surveyed reefs. Stations in Murat exhibited 23% lower richness compared to the baseline region, Lovongai, while Manus showed a 16% increase, suggesting higher taxonomic diversity in that area. No meaningful effects were detected for depth strata or exposure, indicating that richness patterns were primarily structured by regional differences rather than local environmental gradients. The estimated baseline richness under reference conditions was approximately 19 morphotaxa per station.\n\n\nCode\nclean_parameter_labels &lt;- function(param_vec) {\n  param_vec |&gt;\n    str_replace(\"^\\\\(Intercept\\\\)$\", \"Intercept (baseline)\") |&gt;\n    str_replace(\"^region\", \"Region: \") |&gt;\n    str_replace(\"^depth_strata\", \"Depth: \") |&gt;\n    str_replace(\"^exposure\", \"Exposure: \") |&gt;\n    str_replace_all(\"_\", \" \") |&gt;\n    str_to_sentence() \n  }\n\nmodel_summary |&gt; \n  mutate(Parameter = clean_parameter_labels(Parameter)) |&gt; \n  gt(rowname_col = \"Parameter\") |&gt; \n  tab_header(title = md(\"**Model Summary: Benthic Richness (Poisson GLMM)**\"),\n             subtitle = \"Fixed effects as incidence rate ratios (IRRs)\") |&gt;\n  tab_style( style = list(cell_fill(color = \"#f9f9f9\")),\n             locations = cells_body()) |&gt; \n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(columns = vars(`p-value`),\n                                   rows = `p-value` == \"&lt; .001\")) |&gt; \n  cols_align(align = \"center\") |&gt; \n  opt_row_striping() |&gt; \n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\nTable 3: Model summary of morphotaxon richness\n\n\n\n\n\n\n\n\n\nModel Summary: Benthic Richness (Poisson GLMM)\n\n\nFixed effects as incidence rate ratios (IRRs)\n\n\n\nIRR\nSE\n95% CI\nz\np-value\n\n\n\n\nIntercept (baseline)\n18.72\n2.17\n[14.91, 23.50]\n25.24\n&lt; .001\n\n\nRegion: murat\n0.77\n0.05\n[0.67, 0.88]\n-3.84\n&lt; .001\n\n\nRegion: manus\n1.16\n0.08\n[1.01, 1.33]\n2.06\n0.040\n\n\nRegion: western islands\n1.09\n0.07\n[0.96, 1.23]\n1.35\n0.176\n\n\nDepth: shallow\n0.99\n0.04\n[0.92, 1.07]\n-0.16\n0.874\n\n\nDepth: supershallow\n1.00\n0.12\n[0.79, 1.28]\n0.01\n0.995\n\n\nExposure: leeward\n1.10\n0.12\n[0.88, 1.37]\n0.83\n0.407\n\n\nExposure: windward\n1.07\n0.13\n[0.85, 1.35]\n0.60\n0.550\n\n\n\n\n\n\n\n\n\n\nThe model’s conditional R² (0.45) indicates that 45% of the variation in richness is explained by both fixed (region, depth, exposure) and random effects (site-level variation). The marginal R², representing variation explained by fixed effects alone, was 0.31.\n\n\nMarginal Means\nPairwise comparisons reveal that Murat consistently had lower benthic richness than the other regions, with significantly reduced richness compared to Lovongai, Manus, and the Western Islands (p &lt; .001 in all cases)(Table 4). In contrast, richness differences among Lovongai, Manus, and Western Islands were not statistically significant, suggesting broadly comparable community diversity across these regions.\n\n\nCode\nlibrary(emmeans)\n\nemm_region &lt;- emmeans(glmm_richness, ~ region, type = \"response\")\n\npairs_region &lt;- pairs(emm_region, adjust = \"tukey\")\n\nsummary(pairs_region) |&gt;\n  as_tibble() |&gt;\n  mutate(ratio      = round(ratio, 2),\n         SE         = round(SE, 2),\n         z.ratio    = round(z.ratio, 2),\n         p.value    = case_when(\n           is.na(p.value) ~ \"NA\",\n           p.value &lt; 0.001 ~ \"&lt; .001\",\n           TRUE ~ formatC(p.value, format = \"f\", digits = 3))) |&gt; \n  select(contrast, ratio, SE, z.ratio, p.value) |&gt; \n  gt() |&gt; \n  tab_header(\n    title = md(\"**Pairwise Regional Comparisons: Benthic Richness**\"),\n    subtitle = \"Tukey-adjusted incidence rate ratios (IRRs)\"\n  ) |&gt;\n  tab_style(\n    style = list(cell_fill(color = \"#f9f9f9\")),\n    locations = cells_body()\n  ) |&gt;\n  tab_style(\n    style = cell_text(weight = \"bold\", color = \"black\"),\n    locations = cells_body(columns = vars(`p.value`), rows = `p.value` == \"&lt; .001\")\n  ) |&gt;\n  cols_align(align = \"center\") |&gt;\n  opt_row_striping() |&gt;\n  tab_options(\n    table.font.size = \"small\",\n    row.striping.include_table_body = TRUE,\n    table.border.top.color = \"white\",\n    table.border.bottom.color = \"white\",\n    heading.title.font.size = 16,\n    heading.subtitle.font.size = 13,\n    row.striping.background_color = \"#f0f0f0\",\n    column_labels.font.weight = \"bold\"\n  )\n\n\n\n\nTable 4: Pairwise regional comparisons of benthic richness\n\n\n\n\n\n\n\n\n\nPairwise Regional Comparisons: Benthic Richness\n\n\nTukey-adjusted incidence rate ratios (IRRs)\n\n\ncontrast\nratio\nSE\nz.ratio\np.value\n\n\n\n\nLovongai / Murat\n1.30\n0.09\n3.84\n&lt; .001\n\n\nLovongai / Manus\n0.86\n0.06\n-2.06\n0.167\n\n\nLovongai / Western Islands\n0.92\n0.06\n-1.35\n0.529\n\n\nMurat / Manus\n0.66\n0.04\n-6.06\n&lt; .001\n\n\nMurat / Western Islands\n0.71\n0.04\n-5.95\n&lt; .001\n\n\nManus / Western Islands\n1.07\n0.06\n1.06\n0.715\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Estimated marginal means by region\n\nemm_region |&gt; \n  cld(adjust = \"tukey\", Letters = letters, alpha = 0.05) |&gt; \n  ggplot(aes(x = reorder(region, rate), y = rate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2, color = \"#065A82\")+\n  geom_text(aes(label = .group), vjust = -1, hjust = 0.05, size = 5, fontface = \"bold\")+\n  labs(title = \"Estimated Species Richness by Region\",\n       subtitle = \"Letters indicate groups that are not significantly different (Tukey-adjusted, α = 0.05)\",\n       x = NULL,\n       y = \"Estimated richness (± 95% CI)\") +\n  expand_limits(y = 0)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))"
  },
  {
    "objectID": "eda_lpi.html#hard-coral-cover",
    "href": "eda_lpi.html#hard-coral-cover",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.1 Hard coral cover",
    "text": "5.1 Hard coral cover\n\nBleaching"
  },
  {
    "objectID": "eda_lpi.html#cca",
    "href": "eda_lpi.html#cca",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.3 CCA",
    "text": "5.3 CCA\n\nPatterns\n\n\nCode\n# Step 1: Filter only hard coral\ncca_cover &lt;- func_cover_by_site |&gt; \n  filter(functional_group == \"cca\")\n\n# Define a color palette for % cover\ncca_palette &lt;- colorNumeric(\n  palette = \"YlOrRd\", # You can change palette (e.g., \"viridis\", \"plasma\", \"Blues\")\n  domain = cca_cover$pct_cover\n)\n\n# Step 7: Render interactive pie chart map\nleaflet(cca_cover) |&gt;\n  addProviderTiles(providers$Esri.WorldImagery) |&gt;\n  addCircleMarkers(\n    lng = ~longitude,\n    lat = ~latitude,\n    radius = ~rescale(pct_cover, to = c(3, 10)), # scaled nicely\n    stroke = TRUE,            # Important: activate stroke\n    color = \"black\",          # Border color\n    weight = 0.7,             # Thin but visible border\n    opacity = 1,              # Full border opacity\n    fillColor = ~cca_palette(pct_cover),\n    fillOpacity = 0.85,       # Slight transparency inside\n    label = ~paste0(\n      \"&lt;strong&gt;Site:&lt;/strong&gt; \", ps_site_id, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Subregion:&lt;/strong&gt; \", subregion, \"&lt;br&gt;\",\n      \"&lt;strong&gt;CCA Cover:&lt;/strong&gt; \", round(pct_cover, 1), \"%\"\n    ) |&gt; lapply(htmltools::HTML)\n  ) |&gt;\n  addFullscreenControl(position = \"topright\") |&gt;\n  addLegend(\n    position = \"bottomright\",\n    pal = cca_palette,\n    values = ~pct_cover,\n    title = \"CCA Cover (%)\",\n    labFormat = labelFormat(suffix = \"%\"),\n    opacity = 1\n  )\n\n\n\n\n\n\n\n\nCode\nfunc_cover_by_station |&gt; \n  filter(functional_group == \"cca\") |&gt; \n  left_join(lpi_stations |&gt; select(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt; \n  group_by(region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            avg_cover  = mean(pct_cover, na.rm = TRUE),\n            se_cover   = sd(pct_cover, na.rm = TRUE) / sqrt(n()), # Standard error\n            .groups = \"drop\") |&gt; \n  mutate(label_pct = paste0(round(avg_cover, 1), \"%\")) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover, fill = region)) +\n  geom_col() +\n  geom_errorbar(aes(ymin = avg_cover - se_cover, ymax = avg_cover + se_cover), \n                width = 0.2, color = \"grey\") +\n  scale_fill_manual(values = region_palette) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % CCA Cover by Subregion\",\n       fill = \"\") +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")"
  },
  {
    "objectID": "eda_lpi.html#cyanobateria",
    "href": "eda_lpi.html#cyanobateria",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.2 Cyanobateria",
    "text": "5.2 Cyanobateria\n\nPatterns\n\n\nCode\n# Step 1: Filter only hard coral\ncyano_cover &lt;- func_cover_by_site |&gt; \n  filter(functional_group == \"cyanobacteria\")\n\n# Define a color palette for % cover\ncyano_palette &lt;- colorNumeric(\n  palette = \"YlOrRd\", # You can change palette (e.g., \"viridis\", \"plasma\", \"Blues\")\n  domain = cyano_cover$pct_cover\n)\n\n# Step 7: Render interactive pie chart map\nleaflet(cyano_cover) |&gt;\n  addProviderTiles(providers$Esri.WorldImagery) |&gt;\n  addCircleMarkers(\n    lng = ~longitude,\n    lat = ~latitude,\n    radius = ~rescale(pct_cover, to = c(3, 10)), # scaled nicely\n    stroke = TRUE,            # Important: activate stroke\n    color = \"black\",          # Border color\n    weight = 0.7,             # Thin but visible border\n    opacity = 1,              # Full border opacity\n    fillColor = ~cyano_palette(pct_cover),\n    fillOpacity = 0.85,       # Slight transparency inside\n    label = ~paste0(\n      \"&lt;strong&gt;Site:&lt;/strong&gt; \", ps_site_id, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Subregion:&lt;/strong&gt; \", subregion, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Cyanobacteria Cover:&lt;/strong&gt; \", round(pct_cover, 1), \"%\"\n    ) |&gt; lapply(htmltools::HTML)\n  ) |&gt;\n  addFullscreenControl(position = \"topright\") |&gt;\n  addLegend(\n    position = \"bottomright\",\n    pal = cyano_palette,\n    values = ~pct_cover,\n    title = \"Cyanobacteria Cover (%)\",\n    labFormat = labelFormat(suffix = \"%\"),\n    opacity = 1\n  )\n\n\n\n\n\n\n\n\nCode\nfunc_cover_by_station |&gt; \n  filter(functional_group == \"cyanobacteria\") |&gt; \n  left_join(lpi_stations |&gt; select(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt; \n  group_by(region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            avg_cover  = mean(pct_cover, na.rm = TRUE),\n            se_cover   = sd(pct_cover, na.rm = TRUE) / sqrt(n()), # Standard error\n            .groups = \"drop\") |&gt; \n  mutate(label_pct = paste0(round(avg_cover, 1), \"%\")) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover, fill = region)) +\n  geom_col() +\n  geom_errorbar(aes(ymin = avg_cover - se_cover, ymax = avg_cover + se_cover), \n                width = 0.2, color = \"grey\") +\n  scale_fill_manual(values = region_palette) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % Cynobacteria Cover by Subregion\",\n       fill = \"\") +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")\n\n\n\n\n\n\n\n\n\n\n\nStatistical tests\nWe modeled cyanobacterial cover using a beta GLMM with site nested within subregion as random effects. Cyanobacteria cover was significantly lower in the Manus, Murat, and Western Islands regions compared to Lovongai. Depth, exposure, and habitat type did not have significant effects on cyanobacterial abundance. Random effects estimates were minimal, suggesting low additional variation between sites or subregions after accounting for region. Overall, regional differences were the primary structuring factor for cyanobacteria.\n\n\nCode\n# Filter hard coral cover and join region info\ncyano_cover_station &lt;- func_cover_by_station |&gt; \n  filter(functional_group == \"cyanobacteria\") |&gt; \n  left_join(lpi_stations |&gt; distinct(ps_site_id, ps_station_id, region, subregion, depth_strata, exposure, habitat), by = \"ps_station_id\")\n\n# NMuch better stats\n\nlibrary(glmmTMB)\n\n# Beta regression (since % cover is 0-100)\nglmm_cyano &lt;- glmmTMB(pct_cover/100 ~ region + depth_strata + exposure + habitat + (1 | subregion/ps_site_id),\n                      data = cyano_cover_station,\n                      family = beta_family(link = \"logit\"))\n\n# 1. Extract model parameters\ncyano_glmm_summary &lt;- parameters::model_parameters(glmm_cyano, exponentiate = F) |&gt;\n  mutate(CI = sprintf(\"[%.2f, %.2f]\", CI_low, CI_high),\n         p = case_when(is.na(p)            ~ NA_character_,\n                       p &lt; 0.001           ~ \"&lt; .001\",\n                       TRUE                ~ formatC(p, format = \"f\", digits = 3))) |&gt;\n  select(Parameter, Estimate = Coefficient, SE, CI, Z = z, `p-value` = p)\n\n# 2. Build gt table\ncyano_glmm_summary |&gt;\n  gt(rowname_col = \"Parameter\") |&gt;\n  tab_header(title = md(\"**GLMM Results: Cyano Cover by Region, Depth, Exposure, and Habitat**\"),\n             subtitle = \"Beta regression with logit link (n = 157 stations).\") |&gt;\n  tab_style(style = list(cell_fill(color = \"#f9f9f9\")),\n            locations = cells_body()) |&gt;\n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(columns = c(`p-value`), rows = `p-value` == \"&lt; .001\")) |&gt;\n  cols_align(align = \"center\") |&gt;\n  opt_row_striping() |&gt;\n  fmt_number(columns = c(Estimate, SE, Z),\n            decimals = 2) |&gt;\n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\n\n\n\n\nGLMM Results: Cyano Cover by Region, Depth, Exposure, and Habitat\n\n\nBeta regression with logit link (n = 157 stations).\n\n\n\nEstimate\nSE\nCI\nZ\np-value\n\n\n\n\n(Intercept)\n−2.31\n0.43\n[-3.15, -1.47]\n−5.40\n&lt; .001\n\n\nregionManus\n−0.63\n0.32\n[-1.26, -0.01]\n−1.98\n0.048\n\n\nregionMurat\n−0.83\n0.33\n[-1.48, -0.18]\n−2.52\n0.012\n\n\nregionWestern Islands\n−0.65\n0.28\n[-1.21, -0.09]\n−2.29\n0.022\n\n\ndepth_stratashallow\n−0.01\n0.15\n[-0.30, 0.28]\n−0.07\n0.947\n\n\ndepth_stratasupershallow\n0.16\n0.56\n[-0.94, 1.26]\n0.28\n0.777\n\n\nexposureleeward\n−1.25\n1.16\n[-3.52, 1.02]\n−1.08\n0.279\n\n\nexposurewindward\n−1.17\n1.16\n[-3.45, 1.10]\n−1.01\n0.312\n\n\nhabitatchannel\n0.94\n1.37\n[-1.76, 3.63]\n0.68\n0.496\n\n\nhabitatfore reef\n0.80\n1.10\n[-1.36, 2.95]\n0.72\n0.469\n\n\nhabitatpatch reef\n0.84\n1.40\n[-1.90, 3.57]\n0.60\n0.549\n\n\n(Intercept)\n26.12\nNA\n[18.97, 35.96]\nNA\nNA\n\n\nSD (Intercept)\n0.00\nNA\n[0.00, Inf]\nNA\nNA\n\n\nSD (Intercept)\n0.25\nNA\n[0.06, 1.00]\nNA\nNA\n\n\n\n\n\n\n\nAlthough the GLMM detected significant negative coefficients for Murat, Manus, and Western Islands relative to Lovongai, post hoc comparisons using emmeans revealed no significant pairwise differences in cyanobacterial cover between regions after correcting for multiple comparisons. This suggests that while there is a general trend for lower cyanobacteria outside Lovongai, the differences are relatively modest and accompanied by substantial variability.\n\n\nCode\n# 1. Predicted marginal means and significance letters\nemm_region_cyano &lt;- emmeans::emmeans(glmm_cyano, ~ region, type = \"response\")\n\npred_cyano &lt;- emm_region_cyano |&gt;\n  cld(adjust = \"tukey\", Letters = letters) |&gt;\n  as_tibble() |&gt;\n  mutate(mean_cover_pred = response * 100,\n    lower.CL = asymp.LCL * 100,\n    upper.CL = asymp.UCL * 100,\n    .group = str_trim(.group)\n  ) |&gt;\n  select(region, mean_cover_pred, lower.CL, upper.CL, .group)\n\n# 2. Observed means and medians\nobs_cyano &lt;- cyano_cover_station |&gt;\n  group_by(region) |&gt;\n  summarise(\n    mean_cover_obs = mean(pct_cover, na.rm = TRUE),\n    median_cover_obs = median(pct_cover, na.rm = TRUE),\n    n = n(),\n    .groups = \"drop\"\n  )\n\n# 3. Combine\nplot_cyano_data &lt;- left_join(obs_cyano, pred_cyano, by = \"region\")\n\n# 4. Plot\nplot_cyano_data |&gt;\n  pivot_longer(cols = c(mean_cover_obs, mean_cover_pred),\n               names_to = \"type\", values_to = \"cover\") |&gt;\n  mutate(type = recode(type,\n                       mean_cover_obs = \"Observed\",\n                       mean_cover_pred = \"Predicted\")) |&gt;\n  ggplot(aes(x = reorder(region, cover), y = cover, fill = type)) +\n  geom_col(position = position_dodge(width = 0.7), width = 0.6) +\n  geom_errorbar(data = plot_cyano_data,\n                aes(x = region, ymin = lower.CL, ymax = upper.CL),\n                inherit.aes = FALSE,\n                width = 0.2,\n                position = position_nudge(x = 0.2),\n                color = \"black\") +\n  geom_text(data = plot_cyano_data,\n            aes(x = region, y = upper.CL + 2, label = .group),\n            inherit.aes = FALSE,\n            size = 5,\n            fontface = \"bold\") +\n  scale_fill_manual(values = c(\"Observed\" = \"#1f77b4\", \"Predicted\" = \"#ff7f0e\")) +\n  labs(title = \"Observed and Predicted Coral Cover by Region\",\n    x = NULL,\n    y = \"Coral Cover (%)\",\n    fill = \"\") +\n  coord_cartesian(ylim = c(0, NA)) +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(face = \"bold\", size = 16),\n    plot.subtitle = element_text(size = 13),\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    axis.title.y = element_text(face = \"bold\"),\n    legend.position = \"bottom\",\n    legend.box = \"horizontal\")"
  },
  {
    "objectID": "eda_lpi.html#interactive-map",
    "href": "eda_lpi.html#interactive-map",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "1.1 Interactive Map",
    "text": "1.1 Interactive Map\n\n\nCode\n# Collapse to site level\n\nsites_map &lt;- lpi_stations |&gt; \n  mutate(strata_label = glue::glue(\"{depth_strata} ({depth_m} m)\")) |&gt; \n  group_by(ps_site_id, region, habitat, exposure, latitude, longitude) |&gt; \n  summarise(\n    strata_info = paste(unique(strata_label), collapse = \"\\n\"),\n    n_stations  = n_distinct(ps_station_id),\n    .groups     = \"drop\")\n\npal_region &lt;- colorFactor(palette = region_palette, domain = sites_map$region)\n\nleaflet(sites_map) |&gt; \n  addProviderTiles(providers$Esri.WorldImagery) |&gt; \n  addCircleMarkers(lng = ~longitude,\n                   lat = ~latitude,\n                   fillColor = ~pal_region(region),\n                   radius = 6,\n                   fillOpacity = 0.85,\n                   stroke = T,\n                   weight = 1,\n                   color = \"white\",\n                   label = ~glue::glue(\"&lt;strong&gt;Site:&lt;/strong&gt; {ps_site_id}&lt;br&gt;\n                                        &lt;strong&gt;Region:&lt;/strong&gt; {region}&lt;br&gt;\n                                        &lt;strong&gt;Habitat:&lt;/strong&gt; {habitat}&lt;br&gt;\n                                        &lt;strong&gt;Exposure:&lt;/strong&gt; {exposure}&lt;br&gt;\n                                        &lt;strong&gt;Stations:&lt;/strong&gt; {n_stations}&lt;br&gt;\n                                        &lt;strong&gt;Depth strata:&lt;/strong&gt;&lt;br&gt;{strata_info}\") |&gt;\n                     lapply(htmltools::HTML)) |&gt; \n  addLegend(\"bottomright\", pal = pal_region, values = ~region, title = \"Region\") |&gt; \n  addMiniMap(position = \"bottomleft\") |&gt; \n  addScaleBar()|&gt; \n  addFullscreenControl()\n\n\n\n\n\n\n\n\nFigure 1: Map of LPI survey stations"
  },
  {
    "objectID": "eda_lpi.html#effort-summary",
    "href": "eda_lpi.html#effort-summary",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "1.2 Effort Summary",
    "text": "1.2 Effort Summary\n\n\nCode\nlpi_stations |&gt; \n  group_by(region, habitat, depth_strata) |&gt;\n  summarise(n = n_distinct(ps_station_id), .groups = \"drop\") |&gt; \n  pivot_wider(names_from = habitat, values_from = n, values_fill = 0) |&gt; \n  mutate(Total = rowSums(across(where(is.numeric)), na.rm = TRUE)) |&gt;\n  gt(groupname_col = \"region\") |&gt; \n  tab_header(title = \"Summary of sampling effort by region\",\n             subtitle = \"Number of stations surveyed by depth strata and habitat\") |&gt;\n  tab_spanner(label = \"Reef Habitats\", \n              columns = c(\"fore reef\", \"back reef\", \"channel\", \"patch reef\")) |&gt; \n  tab_style(style = list(cell_fill(color = \"#f0f0f0\"),\n                         cell_text(weight = \"bold\")),\n            locations = list(cells_column_labels(everything()),\n                             cells_column_spanners(spanners = \"Reef Habitats\"))) |&gt;\n  opt_table_font(font = list(gt::google_font(\"Roboto\"), default_fonts())) |&gt;\n  opt_row_striping() |&gt; \n  tab_options(row_group.as_column = T,\n              table.width = pct(100),\n              table.font.size = \"small\") |&gt; \n  opt_vertical_padding(scale = 0.7) |&gt; \n  tab_source_note(source_note = \"Depth stratum: supershallow (&lt; 6 m), shallow (7 - 15 m), and deep (&gt;= 15 m).\") \n\n\n\n\nTable 1: Number of LPI survey stations by habitat and depth strata\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSummary of sampling effort by region\n\n\nNumber of stations surveyed by depth strata and habitat\n\n\n\ndepth_strata\n\nReef Habitats\n\nTotal\n\n\nfore reef\nback reef\nchannel\npatch reef\n\n\n\n\nLovongai\nshallow\n16\n3\n0\n0\n19\n\n\ndeep\n8\n0\n0\n0\n8\n\n\nsupershallow\n1\n0\n0\n0\n1\n\n\nManus\nshallow\n15\n0\n1\n1\n17\n\n\ndeep\n11\n0\n0\n1\n12\n\n\nsupershallow\n0\n0\n0\n1\n1\n\n\nMurat\ndeep\n22\n0\n0\n0\n22\n\n\nshallow\n22\n0\n0\n0\n22\n\n\nWestern Islands\ndeep\n24\n1\n0\n0\n25\n\n\nshallow\n26\n2\n0\n0\n28\n\n\nsupershallow\n1\n1\n0\n0\n2\n\n\n\nDepth stratum: supershallow (&lt; 6 m), shallow (7 - 15 m), and deep (&gt;= 15 m)."
  },
  {
    "objectID": "eda_lpi.html#taxonomic-composition",
    "href": "eda_lpi.html#taxonomic-composition",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "1.3 Taxonomic Composition",
    "text": "1.3 Taxonomic Composition\nThis section summarizes the overall taxonomic and functional structure of the benthic communities recorded during the expedition. It provides context for interpreting patterns in richness and composition, highlighting the diversity of morphotaxa observed and their ecological roles.\n\n\nCode\nn_obs    &lt;- nrow(lpi_observations)\nn_stns   &lt;- length(unique(lpi_observations$ps_station_id))\nn_taxa   &lt;- length(unique(lpi_observations$morphotaxon))\nn_func   &lt;- lpi_observations |&gt; filter(!is.na(functional_group)) |&gt; pull(functional_group) |&gt; unique() |&gt; length()\n\nsum_class &lt;- lpi_morphotaxa |&gt; \n  filter(!is.na(kingdom)) |&gt; \n  group_by(kingdom, phylum, class) |&gt; \n  summarise(n_morphotaxa = n_distinct(morphotaxon), \n            n_accepted   = n_distinct(accepted_aphia_id),\n            n_pts        = sum(contacts, na.rm = TRUE),\n            .groups = \"drop\")\n\n# Summarize morphotaxa, accepted names, and total contacts by functional group\nsum_func &lt;- lpi_morphotaxa |&gt; \n  filter(!is.na(kingdom)) |&gt; \n  group_by(functional_group) |&gt; \n  summarise(n_morphotaxa = n_distinct(morphotaxon),\n            n_accepted   = n_distinct(accepted_aphia_id),\n            n_pts        = sum(contacts, na.rm = TRUE),\n            .groups = \"drop\")\n\n\nThe dataset includes 7,772 individual contact observations across 157 stations, representing 341 unique morphotaxa assigned to 10 functional groups, from 4 kingdoms and 11 phyla.\n\n\nCode\n# Summarize morphotaxa, accepted names, and total contacts by Kingdom → Phylum → Class\n\nplot_by_class &lt;- sum_class |&gt; \n  ggplot(aes(x = reorder(kingdom, n_morphotaxa, sum),\n             y = n_morphotaxa,\n             fill = fct_reorder(class, n_morphotaxa),\n             text = paste0(\n               \"&lt;b&gt;Kingdom:&lt;/b&gt; \", kingdom, \"&lt;br&gt;\",\n               \"&lt;b&gt;Phylum:&lt;/b&gt; \", phylum, \"&lt;br&gt;\",\n               \"&lt;b&gt;Class:&lt;/b&gt; \", class, \"&lt;br&gt;\",\n               \"&lt;b&gt;Morphotaxa (count):&lt;/b&gt; \", n_morphotaxa, \"&lt;br&gt;\",\n               \"&lt;b&gt;Accepted names:&lt;/b&gt; \", n_accepted))) +\n  geom_col(color = \"white\", size = 0.3) +\n  paletteer::scale_fill_paletteer_d(\"Polychrome::palette36\", na.value = \"#e0e0e0\") +\n  labs(title = \"Taxonomic Composition of Benthic Morphotaxa\",\n       x = NULL,\n       y = \"Number of Morphotaxa\",\n       fill = \"Class\") +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(face = \"bold\", size = 16, hjust = 0.5),\n        legend.title = element_text(face = \"bold\"),\n        axis.text.x = element_text(angle = 45, hjust = 1),\n        panel.grid.major.x = element_blank()) \n\nggplotly(plot_by_class, tooltip = \"text\") |&gt; \n  layout(hoverlabel = list(bgcolor = \"white\",\n                           font = list(size = 12)))\n\n\n\n\n\n\n\n\nFigure 2: Distribution of Benthic Morphotaxa across Taxonomic Classes\n\n\n\n\nAmong functional groups, sponges (91 morphotaxa), erect algae (81 morphotaxa), and soft corals (58 morphotaxa) were particularly rich.\n\n\nCode\nplot_by_func &lt;- sum_func |&gt; \n  pivot_longer(cols = c(n_morphotaxa, n_accepted),\n               names_to = \"type\", values_to = \"count\") |&gt;\n  mutate(type = recode(type,\n                       \"n_morphotaxa\" = \"Morphotaxa\",\n                       \"n_accepted\" = \"Accepted Names\")) |&gt;\n  group_by(functional_group) |&gt;\n  mutate(total = sum(count)) |&gt;\n  ungroup() |&gt;\n  mutate(functional_group = fct_reorder(functional_group, total)) |&gt; \n  ggplot(aes(x = count, y = functional_group, fill = type, text = paste(type, \":\", count))) +\n  geom_col(position = position_dodge(width = 0.7), width = 0.6) +\n  scale_fill_manual(values = c(\"Morphotaxa\" = \"#1f77b4\", \"Accepted Names\" = \"#ff7f0e\")) +\n  labs(title = \"Morphotaxa and Accepted Names by Functional Group\",\n       x = \"Count\", y = NULL, fill = \"\") +\n  theme(legend.position = \"top\",\n        plot.title = element_text(face = \"bold\"))+\n  scale_x_continuous(expand = expansion(mult = c(0, 0.05))) \n  \n# Then pass to plotly\nplotly::ggplotly(plot_by_func, tooltip = \"text\")\n\n\n\n\n\n\n\n\nFigure 3: Distribution of Benthic Morphotaxa across Functional Groups\n\n\n\n\nImportantly, field morphotaxa were consolidated to their lowest defensible taxonomic rank based on authoritative references (e.g., uncertain sponge morphotypes assigned to Porifera at the phylum level). This necessary step substantially reduced the number of distinct accepted names compared to field morphotaxa — particularly for groups like sponges and soft corals where fine-scale identification is notoriously difficult.\nAfter consolidating morphotaxa to their lowest defensible taxonomic rank, the majority of benthic observations were classified at the species and genus levels across most functional groups (Table 2).\n\n\nCode\nsum_func_rank &lt;- lpi_morphotaxa |&gt; \n  group_by(functional_group, rank) |&gt; \n  summarize(n = n_distinct(morphotaxon),\n            n_accepted = n_distinct(accepted_aphia_id),\n            n_pts = sum(contacts, na.rm = TRUE),\n            .groups = \"drop\") |&gt; \n  arrange(desc(n))\n\nsum_func_rank |&gt;\n  arrange(desc(n)) |&gt; \n  gt(groupname_col = \"functional_group\", \n     rowname_col = \"rank\") |&gt;\n  tab_header(title = md(\"**Summary of Taxonomic Resolution by Functional Group**\"),\n             subtitle = \"Number of morphotaxa, accepted names, and point contacts at the lowest defensible rank\") |&gt;\n  tab_style(style = list(cell_fill(color = \"#f9f9f9\")),\n            locations = cells_body()) |&gt;\n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_column_labels(everything())) |&gt;\n  cols_label(n = \"Morphotaxa\",\n             n_accepted = \"Accepted Names\",\n             n_pts = \"Point Contacts\") |&gt;\n  cols_align(align = \"center\",\n             columns = everything()) |&gt;\n  opt_row_striping() |&gt;\n  tab_options(row_group.as_column = T,\n              table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 18,\n              heading.subtitle.font.size = 14,\n              heading.align = \"center\",\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\",\n              column_labels.background.color = \"#e6e6e6\",\n              data_row.padding = px(6))\n\n\n\n\nTable 2: Summary of morphotaxa by functional group and lowest defensible taxonomic rank\n\n\n\n\n\n\n\n\n\nSummary of Taxonomic Resolution by Functional Group\n\n\nNumber of morphotaxa, accepted names, and point contacts at the lowest defensible rank\n\n\n\nMorphotaxa\nAccepted Names\nPoint Contacts\n\n\n\n\nerect algae\nSpecies\n51\n49\n4405\n\n\nGenus\n25\n14\n1258\n\n\nVariety\n2\n2\n17\n\n\nClass\n1\n1\n1\n\n\nForma\n1\n1\n5\n\n\nPhylum (Division)\n1\n1\n8\n\n\nsoft coral\nGenus\n43\n30\n1420\n\n\nClass\n8\n1\n17\n\n\nSpecies\n6\n6\n381\n\n\nFamily\n1\n1\n4\n\n\nsponges\nGenus\n33\n26\n212\n\n\nPhylum\n26\n1\n200\n\n\nSpecies\n18\n17\n920\n\n\nOrder\n8\n3\n25\n\n\nFamily\n5\n3\n7\n\n\nSubclass\n1\n1\n19\n\n\nother\nGenus\n21\n14\n140\n\n\nSpecies\n21\n21\n412\n\n\nClass\n4\n4\n46\n\n\nOrder\n3\n3\n20\n\n\nFamily\n2\n2\n16\n\n\ncca\nSpecies\n16\n15\n274\n\n\nGenus\n5\n4\n274\n\n\nOrder\n1\n1\n2501\n\n\ncyanobacteria\nGenus\n9\n4\n1126\n\n\nSpecies\n2\n2\n72\n\n\nClass\n1\n1\n3\n\n\nencrusting algae\nGenus\n7\n2\n566\n\n\nSpecies\n4\n4\n136\n\n\nPhylum (Division)\n2\n1\n86\n\n\nhard coral\nOrder\n3\n1\n11536\n\n\nGenus\n2\n2\n6\n\n\nSpecies\n1\n1\n1\n\n\nsediment/rubble/barren\nNA\n3\n1\n4705\n\n\nturf\nGenus\n2\n2\n10\n\n\nNA\n2\n1\n4599"
  },
  {
    "objectID": "eda_lpi.html#species-accumulation-curves",
    "href": "eda_lpi.html#species-accumulation-curves",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.3 Species accumulation curves",
    "text": "2.3 Species accumulation curves\nTo assess how benthic morphotaxon richness accumulates with increasing sampling effort, we generated species accumulation curves for each region based on presence-weighted morphotaxon cover data (Figure 7). These curves visualize how the number of unique morphotaxa increases as additional stations are sampled, providing insight into both regional diversity and sampling completeness. The shaded bands reflect variability among sites, giving an indication of habitat heterogeneity and community turnover within regions.\n\n\nCode\nlibrary(vegan)\n\n# Species matrix with one row per station × region\ntaxa_cover_matrix &lt;- cover_by_station_and_taxa |&gt; \n  left_join(lpi_stations |&gt; distinct(ps_station_id, region), by = \"ps_station_id\") |&gt; \n  filter(contacts &gt; 0) |&gt; \n  select(region, ps_station_id, morphotaxon, contacts) |&gt; \n  pivot_wider(id_cols = c(region, ps_station_id),\n              names_from = morphotaxon,\n              values_from = contacts,\n              values_fill = list(contacts = 0) )\n\n# 1. Nest species matrix by region\n\ntaxa_nested &lt;- taxa_cover_matrix |&gt; \n  group_by(region) |&gt; \n  nest()\n\n# 2. Compute specaccum per region\naccum_curves &lt;- taxa_nested |&gt; \n  mutate(\n    acc = map(data, ~ specaccum(select(.x, where(is.numeric)), method = \"random\")),\n    curve = map(acc, ~ tibble(\n      station_number = .x$sites,\n      richness = .x$richness,\n      sd = .x$sd\n    ))\n  ) |&gt; \n  select(region, curve) |&gt; \n  unnest(curve)\n\n# 3. Plot\nggplot(accum_curves, aes(x = station_number, y = richness, color = region, fill = region)) +\n  geom_line(linewidth = 1) +\n  geom_ribbon(aes(ymin = richness - sd, ymax = richness + sd), alpha = 0.2, color = NA) +\n  labs(title = \"Morphotaxa Accumulation Curves by Region\",\n       x = \"Number of Stations\",\n       y = \"Accumulated Morphotaxa Richness\") +\n  theme(legend.position = \"bottom\")+\n  labs(fill = \"\", col = \"\")\n\n\n\n\n\n\n\n\nFigure 7: Morphotaxa accumulation curves by region\n\n\n\n\n\nSpecies accumulation patterns reveal marked regional differences in benthic diversity. Manus and Western Islands stand out as the most species-rich and heterogeneous, with curves that continue to rise and broad confidence bands. Lovongai shows moderate richness and appears to be more completely sampled, while Murat exhibits the lowest richness and least variability. Together, these curves provide a baseline for comparing biodiversity across regions and evaluating the sufficiency of sampling efforts."
  },
  {
    "objectID": "eda_lpi.html#hard-coral",
    "href": "eda_lpi.html#hard-coral",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.1 Hard coral",
    "text": "5.1 Hard coral\n\nPatterns\n\n\nCode\nfunc_cover_by_site &lt;- func_cover_by_station |&gt; \n  left_join(lpi_stations |&gt; distinct(ps_site_id, ps_station_id, region, subregion, latitude, longitude), by = \"ps_station_id\") |&gt; \n  group_by(region, subregion, ps_site_id, latitude, longitude, functional_group) |&gt; \n  summarise(pct_cover = mean(pct_cover)) |&gt; \n  ungroup() |&gt; \n  arrange(desc(pct_cover)) \n\n# Step 1: Filter only hard coral\nhard_coral_cover &lt;- func_cover_by_site |&gt; \n  filter(functional_group == \"hard coral\")\n\n# Define a color palette for % cover\ncoral_palette &lt;- colorNumeric(\n  palette = \"YlOrRd\", # You can change palette (e.g., \"viridis\", \"plasma\", \"Blues\")\n  domain = hard_coral_cover$pct_cover\n)\n\n# Step 7: Render interactive pie chart map\nleaflet(hard_coral_cover) |&gt;\n  addProviderTiles(providers$Esri.WorldImagery) |&gt;\n  addCircleMarkers(\n    lng = ~longitude,\n    lat = ~latitude,\n    radius = ~rescale(pct_cover, to = c(3, 10)), # scaled nicely\n    stroke = TRUE,            # Important: activate stroke\n    color = \"black\",          # Border color\n    weight = 0.7,             # Thin but visible border\n    opacity = 1,              # Full border opacity\n    fillColor = ~coral_palette(pct_cover),\n    fillOpacity = 0.85,       # Slight transparency inside\n    label = ~paste0(\n      \"&lt;strong&gt;Site:&lt;/strong&gt; \", ps_site_id, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Subregion:&lt;/strong&gt; \", subregion, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Hard Coral Cover:&lt;/strong&gt; \", round(pct_cover, 1), \"%\"\n    ) |&gt; lapply(htmltools::HTML)\n  ) |&gt;\n  addFullscreenControl(position = \"topright\") |&gt;\n  addLegend(\n    position = \"bottomright\",\n    pal = coral_palette,\n    values = ~pct_cover,\n    title = \"Hard Coral Cover (%)\",\n    labFormat = labelFormat(suffix = \"%\"),\n    opacity = 1\n  )\n\n\n\n\n\n\n\n\nCode\nfunc_cover_by_station |&gt; \n  filter(functional_group == \"hard coral\") |&gt; \n  left_join(lpi_stations |&gt; select(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt; \n  group_by(region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            avg_cover  = mean(pct_cover, na.rm = TRUE),\n            se_cover   = sd(pct_cover, na.rm = TRUE) / sqrt(n()), # Standard error\n            .groups = \"drop\") |&gt; \n  mutate(label_pct = paste0(round(avg_cover, 1), \"%\")) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover, fill = region)) +\n  geom_col() +\n  geom_errorbar(aes(ymin = avg_cover - se_cover, ymax = avg_cover + se_cover), \n                width = 0.2, color = \"grey\") +\n  scale_fill_manual(values = region_palette) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % Hard Coral Cover by Subregion\",\n       fill = \"\") +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")\n\n\n\n\n\n\n\n\n\n\n\nStatistical tests\n\n\nCode\n# Filter hard coral cover and join region info\ncoral_cover_station &lt;- func_cover_by_station |&gt; \n  filter(functional_group == \"hard coral\") |&gt; \n  left_join(lpi_stations |&gt; distinct(ps_site_id, ps_station_id, region, subregion, depth_strata, exposure, habitat), by = \"ps_station_id\")\n\n# Simple stats but very misleading\n\n# By Region\nkruskal_region &lt;- kruskal.test(pct_cover ~ region, data = coral_cover_station)\n\n# Pairwise comparisons if Kruskal-Wallis is significant\npairwise_region &lt;- pairwise.wilcox.test(coral_cover_station$pct_cover, coral_cover_station$region, p.adjust.method = \"holm\")\n\n\nHard coral cover varied across regions and environmental gradients, but only depth strata showed a statistically significant effect in the fitted beta GLMM. Sites at shallower depths exhibited significantly higher hard coral cover compared to deep sites (Estimate = 0.35, p &lt; .001), while no significant differences were detected among regions, exposure categories, or habitat types.\n\n\nCode\n# NMuch better stats\n\nlibrary(glmmTMB)\n\n# Beta regression (since % cover is 0-100)\nglmm_coral &lt;- glmmTMB(pct_cover/100 ~ region + depth_strata + exposure + habitat + (1 | subregion/ps_site_id),\n                      data = coral_cover_station,\n                      family = beta_family(link = \"logit\"))\n\n# 1. Extract model parameters\ncoral_glmm_summary &lt;- parameters::model_parameters(glmm_coral, exponentiate = F) |&gt;\n  mutate(CI = sprintf(\"[%.2f, %.2f]\", CI_low, CI_high),\n         p = case_when(is.na(p)            ~ NA_character_,\n                       p &lt; 0.001           ~ \"&lt; .001\",\n                       TRUE                ~ formatC(p, format = \"f\", digits = 3))) |&gt;\n  select(Parameter, Estimate = Coefficient, SE, CI, Z = z, `p-value` = p)\n\n# 2. Build gt table\ncoral_glmm_summary |&gt;\n  gt(rowname_col = \"Parameter\") |&gt;\n  tab_header(title = md(\"**GLMM Results: Coral Cover by Region, Depth, Exposure, and Habitat**\"),\n             subtitle = \"Beta regression with logit link (n = 157 stations).\") |&gt;\n  tab_style(style = list(cell_fill(color = \"#f9f9f9\")),\n            locations = cells_body()) |&gt;\n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(columns = c(`p-value`), rows = `p-value` == \"&lt; .001\")) |&gt;\n  cols_align(align = \"center\") |&gt;\n  opt_row_striping() |&gt;\n  fmt_number(columns = c(Estimate, SE, Z),\n            decimals = 2) |&gt;\n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\n\n\n\n\nGLMM Results: Coral Cover by Region, Depth, Exposure, and Habitat\n\n\nBeta regression with logit link (n = 157 stations).\n\n\n\nEstimate\nSE\nCI\nZ\np-value\n\n\n\n\n(Intercept)\n−1.77\n0.41\n[-2.57, -0.98]\n−4.37\n&lt; .001\n\n\nregionManus\n−0.19\n0.39\n[-0.96, 0.57]\n−0.50\n0.620\n\n\nregionMurat\n−0.32\n0.37\n[-1.05, 0.41]\n−0.86\n0.391\n\n\nregionWestern Islands\n0.36\n0.34\n[-0.30, 1.02]\n1.06\n0.289\n\n\ndepth_stratashallow\n0.35\n0.09\n[0.17, 0.53]\n3.77\n&lt; .001\n\n\ndepth_stratasupershallow\n0.58\n0.45\n[-0.29, 1.46]\n1.31\n0.191\n\n\nexposureleeward\n−0.40\n0.93\n[-2.23, 1.42]\n−0.43\n0.664\n\n\nexposurewindward\n−0.82\n0.94\n[-2.67, 1.02]\n−0.87\n0.383\n\n\nhabitatchannel\n1.34\n1.16\n[-0.94, 3.62]\n1.15\n0.249\n\n\nhabitatfore reef\n1.20\n0.88\n[-0.51, 2.92]\n1.37\n0.170\n\n\nhabitatpatch reef\n1.21\n0.93\n[-0.62, 3.03]\n1.29\n0.196\n\n\n(Intercept)\n15.65\nNA\n[11.13, 22.01]\nNA\nNA\n\n\nSD (Intercept)\n0.46\nNA\n[0.33, 0.64]\nNA\nNA\n\n\nSD (Intercept)\n0.44\nNA\n[0.25, 0.77]\nNA\nNA\n\n\n\n\n\n\n\n\n\nCode\n# 1. Predicted marginal means and significance letters\nemm_region_coral &lt;- emmeans::emmeans(glmm_coral, ~ region, type = \"response\")\n\npred_coral &lt;- emm_region_coral |&gt;\n  cld(adjust = \"tukey\", Letters = letters) |&gt;\n  as_tibble() |&gt;\n  mutate(mean_cover_pred = response * 100,\n    lower.CL = asymp.LCL * 100,\n    upper.CL = asymp.UCL * 100,\n    .group = str_trim(.group)\n  ) |&gt;\n  select(region, mean_cover_pred, lower.CL, upper.CL, .group)\n\n# 2. Observed means and medians\nobs_coral &lt;- coral_cover_station |&gt;\n  group_by(region) |&gt;\n  summarise(\n    mean_cover_obs = mean(pct_cover, na.rm = TRUE),\n    median_cover_obs = median(pct_cover, na.rm = TRUE),\n    n = n(),\n    .groups = \"drop\"\n  )\n\n# 3. Combine\nplot_data &lt;- left_join(obs_coral, pred_coral, by = \"region\")\n\n\nObserved mean coral cover ranged from 27.5% in Murat to 39.3% in the Western Islands, with corresponding predicted mean covers from the model following a similar pattern but with wider uncertainty intervals. No significant pairwise differences among regions were detected based on the GLMM predictions (all regions sharing the same significance group “a”), indicating that while there is visible variation in coral cover across subregions, these differences were not statistically robust after accounting for environmental covariates and random site effects.\n\n\nCode\n# 4. Plot\nplot_data |&gt;\n  pivot_longer(cols = c(mean_cover_obs, mean_cover_pred),\n               names_to = \"type\", values_to = \"cover\") |&gt;\n  mutate(type = recode(type,\n                       mean_cover_obs = \"Observed\",\n                       mean_cover_pred = \"Predicted\")) |&gt;\n  ggplot(aes(x = reorder(region, cover), y = cover, fill = type)) +\n  geom_col(position = position_dodge(width = 0.7), width = 0.6) +\n  geom_errorbar(data = plot_data,\n                aes(x = region, ymin = lower.CL, ymax = upper.CL),\n                inherit.aes = FALSE,\n                width = 0.2,\n                position = position_nudge(x = 0.2),\n                color = \"black\") +\n  geom_text(data = plot_data,\n            aes(x = region, y = upper.CL + 2, label = .group),\n            inherit.aes = FALSE,\n            size = 5,\n            fontface = \"bold\") +\n  scale_fill_manual(values = c(\"Observed\" = \"#1f77b4\", \"Predicted\" = \"#ff7f0e\")) +\n  labs(title = \"Observed and Predicted Coral Cover by Region\",\n    x = NULL,\n    y = \"Coral Cover (%)\",\n    fill = \"\") +\n  coord_cartesian(ylim = c(0, NA)) +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(face = \"bold\", size = 16),\n    plot.subtitle = element_text(size = 13),\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    axis.title.y = element_text(face = \"bold\"),\n    legend.position = \"bottom\",\n    legend.box = \"horizontal\")\n\n\n\n\n\n\n\n\n\n\n\nBleaching\nFor Sites 24 and after."
  },
  {
    "objectID": "eda_lpi.html#cca-coral",
    "href": "eda_lpi.html#cca-coral",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.3 CCA + Coral",
    "text": "5.3 CCA + Coral\n\nPatterns\n\n\nCode\n# Step 1: Filter only hard coral\ncca_cover &lt;- func_cover_by_site |&gt; \n  filter(functional_group == \"cca\")\n\n# Define a color palette for % cover\ncca_palette &lt;- colorNumeric(\n  palette = \"YlOrRd\", # You can change palette (e.g., \"viridis\", \"plasma\", \"Blues\")\n  domain = cca_cover$pct_cover\n)\n\n# Step 7: Render interactive pie chart map\nleaflet(cca_cover) |&gt;\n  addProviderTiles(providers$Esri.WorldImagery) |&gt;\n  addCircleMarkers(\n    lng = ~longitude,\n    lat = ~latitude,\n    radius = ~rescale(pct_cover, to = c(3, 10)), # scaled nicely\n    stroke = TRUE,            # Important: activate stroke\n    color = \"black\",          # Border color\n    weight = 0.7,             # Thin but visible border\n    opacity = 1,              # Full border opacity\n    fillColor = ~cca_palette(pct_cover),\n    fillOpacity = 0.85,       # Slight transparency inside\n    label = ~paste0(\n      \"&lt;strong&gt;Site:&lt;/strong&gt; \", ps_site_id, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Subregion:&lt;/strong&gt; \", subregion, \"&lt;br&gt;\",\n      \"&lt;strong&gt;CCA Cover:&lt;/strong&gt; \", round(pct_cover, 1), \"%\"\n    ) |&gt; lapply(htmltools::HTML)\n  ) |&gt;\n  addFullscreenControl(position = \"topright\") |&gt;\n  addLegend(\n    position = \"bottomright\",\n    pal = cca_palette,\n    values = ~pct_cover,\n    title = \"CCA Cover (%)\",\n    labFormat = labelFormat(suffix = \"%\"),\n    opacity = 1\n  )\n\n\n\n\n\n\n\n\nCode\nfunc_cover_by_station |&gt; \n  filter(functional_group == \"cca\") |&gt; \n  left_join(lpi_stations |&gt; select(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt; \n  group_by(region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            avg_cover  = mean(pct_cover, na.rm = TRUE),\n            se_cover   = sd(pct_cover, na.rm = TRUE) / sqrt(n()), # Standard error\n            .groups = \"drop\") |&gt; \n  mutate(label_pct = paste0(round(avg_cover, 1), \"%\")) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover, fill = region)) +\n  geom_col() +\n  geom_errorbar(aes(ymin = avg_cover - se_cover, ymax = avg_cover + se_cover), \n                width = 0.2, color = \"grey\") +\n  scale_fill_manual(values = region_palette) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % CCA Cover by Subregion\",\n       fill = \"\") +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")"
  }
]