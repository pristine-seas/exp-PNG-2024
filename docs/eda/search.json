[
  {
    "objectID": "eda_fish.html",
    "href": "eda_fish.html",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "",
    "text": "This document presents an exploratory analysis of fish survey data collected during the PNG-2024 scientific expedition. Our goal is to characterize patterns in reef fish community structure and composition, and to identify key drivers of species richness, abundance, and biomass across spatial and ecological gradients.\nThe dataset comprises standardized underwater visual survey (UVS) data collected across multiple islands, regions, and depth strata using consistent belt transect methods. Observers recorded individual fish counts, estimated lengths, and species-level taxonomic identifications. These were used to derive metrics of abundance (individuals per m²), biomass (grams per m²), and species richness per station.\n\n\nCode\n# -- Read supporting site data --------------------------------------------\n\nsites &lt;- read_rds(file.path(exp_path, \"data/primary/processed/sites.rds\"))\n\nuvs_sites &lt;- sites$uvs\n\nfish_lut &lt;- tbl(bq_connection, \"taxonomy.fish\") |&gt; \n  filter(!is.na(accepted_aphia_id)) |&gt; \n  collect()\n\n# -- Read fish survey data -----------------------------------------------\n\nstations &lt;- tbl(bq_connection, \"uvs.blt_stations\") |&gt; \n  filter(exp_id == \"PNG_2024\") |&gt; \n  collect()\n\nobservations &lt;- tbl(bq_connection, \"uvs.blt_observations\") |&gt; \n  filter(exp_id == \"PNG_2024\") |&gt; \n  collect()\n\nbiomass_by_taxa_and_station &lt;- tbl(bq_connection, \"uvs.blt_biomass_by_taxa\") |&gt; \n  filter(exp_id == \"PNG_2024\") |&gt; \n  collect()\n\n# -- Add Zeros back in  --------------------------------------------------\n\nbiomass_by_taxa_and_station &lt;- biomass_by_taxa_and_station |&gt; \n  complete(nesting(ps_station_id, ps_site_id, exp_id, region, subregion, habitat, exposure, divers, depth_strata, depth_m),\n           nesting(accepted_name, accepted_aphia_id, rank, family, trophic_group),\n           fill = list(total_count      = 0,\n                       avg_count        = 0,\n                       avg_length_cm    = NA,\n                       min_length       = NA,\n                       max_length       = NA,\n                       density_m2       = 0,\n                       biomass_gm2      = 0))\n\n\n# Tmp\n\nstations &lt;- stations |&gt; \n  mutate(divers = str_replace(divers, \"ALG\", \"Allison Green\") |&gt;\n           str_replace(\"JEC\", \"Jenn Caselle\") |&gt; \n           str_replace(\"AMF\", \"Alan Friedlander\") |&gt;\n           str_replace(\"VAS\", \"Vyvyan Summers\") |&gt;\n           str_replace(\"AJKM\", \"Andrew Mcinnis\"))\n\n\nIn total, we conducted surveys at 90 sites and 167 stations across 4 regions, covering approximately 66,450 m² of reef habitat (Table 1, Figure 1).\n\n\nCode\nhabitat_pal &lt;- c(\"fore_reef\"  = \"#C5FFFD\",\n                 \"back_reef\"  = \"#DF2935\",\n                 \"channel\"    = \"#D8CC34\",\n                 \"patch_reef\" = \"#772D8B\")\n\n\nstations_sf &lt;- stations |&gt;\n  left_join(uvs_sites |&gt; \n              select(ps_site_id, latitude, longitude),\n            by = \"ps_site_id\") |&gt;\n  mutate(habitat = factor(habitat, levels = names(habitat_pal))) |&gt;\n  group_by(ps_site_id, region, subregion, locality, habitat, exposure, latitude, longitude) |&gt; \n  summarize(team = paste(unique(divers), collapse = \"/\"),\n            strata = paste(unique(paste(depth_strata, \" (\",depth_m ,\"m)\", sep = \"\")), \n                            collapse = \"\\n\"),\n            survey_area_m2 = sum(survey_area_m2),\n            n_stations = n_distinct(ps_station_id),\n            .groups = \"drop\") |&gt;\n  sf::st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) \n\nmapview::mapview(stations_sf,\n                 zcol = \"habitat\",\n                 legend = TRUE,\n                 col.regions = habitat_pal,\n                 map.types = \"Esri.WorldImagery\",\n                 layer.name = \"Habitat\",\n                 popup = leafpop::popupTable(stations_sf, \n                                             zcol = c(\"ps_site_id\", \"strata\", \"team\", \"survey_area_m2\", \"habitat\", \"exposure\"))) |&gt; \n  leafem::addMouseCoordinates() |&gt; \n  addFullscreenControl()\n\n\n\n\n\n\n\n\nFigure 1: Map of fish survey stations\n\n\n\n\n\n\nCode\nstations |&gt; \n  group_by(region, habitat, depth_strata) |&gt;\n  summarise(n = n_distinct(ps_station_id), .groups = \"drop\") |&gt; \n  pivot_wider(names_from = habitat, values_from = n, values_fill = 0) |&gt; \n  mutate(Total = rowSums(across(where(is.numeric)), na.rm = TRUE)) |&gt;\n  gt(groupname_col = \"region\") |&gt; \n  tab_header(title = \"Summary of sampling effort by region\",\n             subtitle = \"Number of stations surveyed by depth strata and habitat\") |&gt;\n  tab_spanner(label = \"Reef Habitats\", \n              columns = c(\"fore_reef\", \"back_reef\", \"channel\", \"patch_reef\")) |&gt; \n  tab_style(style = list(cell_fill(color = \"#f0f0f0\"),\n                         cell_text(weight = \"bold\")),\n            locations = list(cells_column_labels(everything()),\n                             cells_column_spanners(spanners = \"Reef Habitats\"))) |&gt;\n  opt_table_font(font = list(gt::google_font(\"Roboto\"), default_fonts())) |&gt;\n  opt_row_striping() |&gt; \n  tab_options(row_group.as_column = T,\n              table.width = pct(100),\n              table.font.size = \"small\") |&gt; \n  opt_vertical_padding(scale = 0.7) |&gt; \n    tab_source_note(source_note = \"Depth stratum: supershallow (&lt; 6 m), shallow (7 - 15 m), and deep (&gt;= 15 m).\") \n\n\n\n\nTable 1: Number of fish survey stations by habitat and depth strata\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSummary of sampling effort by region\n\n\nNumber of stations surveyed by depth strata and habitat\n\n\n\ndepth_strata\n\nReef Habitats\n\nTotal\n\n\nfore_reef\nback_reef\nchannel\npatch_reef\n\n\n\n\nLovongai\nshallow\n16\n3\n0\n0\n19\n\n\ndeep\n9\n0\n0\n0\n9\n\n\nsupershallow\n1\n0\n0\n0\n1\n\n\nManus\nshallow\n15\n0\n1\n1\n17\n\n\nsupershallow\n2\n0\n1\n1\n4\n\n\ndeep\n13\n0\n0\n2\n15\n\n\nMurat\ndeep\n22\n0\n0\n0\n22\n\n\nshallow\n22\n0\n0\n0\n22\n\n\nWestern Islands\ndeep\n25\n1\n0\n0\n26\n\n\nshallow\n27\n2\n0\n0\n29\n\n\nsupershallow\n1\n2\n0\n0\n3\n\n\n\nDepth stratum: supershallow (&lt; 6 m), shallow (7 - 15 m), and deep (&gt;= 15 m).\n\n\n\n\n\n\n\n\n\n\n\nSubsequent sections will summarize the data by region and subregion, characterize the dominant taxa, evaluate sampling sufficiency, and explore spatial and ecological drivers of richness, abundance, biomass, and community structure."
  },
  {
    "objectID": "eda_fish.html#regional-summary",
    "href": "eda_fish.html#regional-summary",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "2.1 Regional summary",
    "text": "2.1 Regional summary\nThe tables below (Table 2, Table 3) summarize survey coverage and observed patterns in species richness and abundance across regions and subregions. Metrics include the number of stations surveyed, total fish counted, and average richness, abundance, and biomass per station.\nThese summaries reveal distinct regional patterns in reef fish communities. Lovongai recorded the highest species richness and the greatest average fish biomass per station. In contrast, Murat exhibited the lowest richness and biomass. The Western Islands showed the highest fish abundance, but average biomass per station was comparable to Murat, suggesting smaller-bodied species dominate. Manus had the lowest overall abundance.\nIn the following sections, we explore spatial and ecological patterns in species richness, abundance, and biomass, focusing on variation across region, depth strata, and observer.\n\n\nCode\n# --- Region-level summary -----------------------------------------------\nregion_summary &lt;- stations |&gt; \n  group_by(region) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            survey_area_m2 = sum(survey_area_m2),\n            avg_taxa = mean(avg_taxa),\n            avg_count  = mean(avg_count),\n            avg_density_m2 = mean(density_m2),\n            avg_biomass_gm2 = mean(biomass_gm2),\n            median_biomass_gm2 = median(biomass_gm2),\n            across(contains(\"pct\") , ~ round(mean(.x, na.rm = TRUE), 2)), \n            .groups = \"drop\")\n\nn_taxa_by_region &lt;- biomass_by_taxa_and_station |&gt;\n  group_by(region) |&gt; \n  summarise(n_taxa = n_distinct(accepted_aphia_id[avg_count &gt; 0]),\n            .groups = \"drop\") \n\nregion_summary &lt;- region_summary |&gt; \n  left_join(n_taxa_by_region) |&gt; \n  relocate(n_taxa, .after = survey_area_m2) |&gt; \n  mutate(across(where(is.numeric), ~round(.x, 2)))\n\n\n\n\nCode\nregion_summary |&gt; \n  mutate(survey_area_m2 = scales::comma(survey_area_m2)) |&gt; \n  gt(rowname_col = \"region\") |&gt; \n  tab_header(title = \"Summary of Fish Surveys by Region\",\n             subtitle = \"Average counts, biomass, and trophic composition per station\") |&gt; \n  cols_label(n_stations = \"Stations\",\n             survey_area_m2 = \"Survey Area (m²)\",\n             n_taxa = \"Taxa Observed\",\n             avg_taxa = \"Avg. Nº Taxa (per transect)\",\n             avg_count = \"Avg. Count (per transect)\",\n             avg_density_m2 = \"Avg. Density (ind/m²)\",\n             avg_biomass_gm2 = \"Avg. Biomass (g/m²)\",\n             median_biomass_gm2 = \"Median Biomass (g/m²)\",\n             pct_top_predator = \"% Top Predator\",\n             pct_shark = \"% Shark\",\n             pct_lower_carni = \"% Lower Carnivore\",\n             pct_herbi_detri = \"% Herbivore/Detritivore\",\n             pct_plankti = \"% Planktivore\") |&gt; \n  tab_style(style = list(cell_fill(color = \"#f0f0f0\"),\n                         cell_text(weight = \"bold\")),\n            locations = cells_column_labels(everything())) |&gt;\n  opt_table_font(font = list(gt::google_font(\"Roboto\"), default_fonts())) |&gt;\n  opt_row_striping() |&gt; \n  tab_options(row_group.as_column = T,\n              table.width = pct(100),\n              table.font.size = \"small\") |&gt; \n  opt_vertical_padding(scale = 0.7)\n\n\n\n\nTable 2: Summary of fish surveys by region\n\n\n\n\n\n\n\n\n\nSummary of Fish Surveys by Region\n\n\nAverage counts, biomass, and trophic composition per station\n\n\n\nStations\nSurvey Area (m²)\nTaxa Observed\nAvg. Nº Taxa (per transect)\nAvg. Count (per transect)\nAvg. Density (ind/m²)\nAvg. Biomass (g/m²)\nMedian Biomass (g/m²)\n% Top Predator\n% Shark\n% Lower Carnivore\n% Herbivore/Detritivore\n% Planktivore\n\n\n\n\nLovongai\n29\n13,650\n326\n26.64\n257.37\n4.67\n542.44\n156.61\n9.83\n0.18\n41.43\n28.73\n19.83\n\n\nManus\n36\n15,000\n311\n28.20\n168.46\n2.99\n223.11\n136.65\n7.68\n0.00\n30.62\n28.76\n32.92\n\n\nMurat\n44\n19,800\n275\n27.09\n264.59\n5.04\n187.36\n133.64\n7.30\n2.64\n33.94\n30.83\n25.30\n\n\nWestern Islands\n58\n18,000\n294\n29.28\n349.84\n6.65\n189.35\n132.70\n6.44\n0.66\n37.43\n27.40\n28.06\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# --- Subregion-level summary -----------------------------------------------\n\nsubregion_summary &lt;- stations |&gt; \n  group_by(region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            survey_area_m2 = sum(survey_area_m2),\n            avg_taxa = mean(avg_taxa),\n            avg_count  = mean(avg_count),\n            avg_density_m2 = mean(density_m2),\n            avg_biomass_gm2 = mean(biomass_gm2),\n            median_biomass_gm2 = median(biomass_gm2),\n            across(contains(\"pct\") , ~ round(mean(.x, na.rm = TRUE), 2)), \n            .groups = \"drop\")\n\nn_taxa_by_subregion &lt;- biomass_by_taxa_and_station |&gt;\n  group_by(region, subregion) |&gt; \n  summarise(n_taxa = n_distinct(accepted_aphia_id[avg_count &gt; 0]),\n            .groups = \"drop\") \n\nsubregion_summary &lt;- subregion_summary |&gt; \n  left_join(n_taxa_by_subregion) |&gt; \n  relocate(n_taxa, .after = survey_area_m2) |&gt; \n  mutate(across(where(is.numeric), ~round(.x, 2)))\n\n\n\n\nCode\nsubregion_summary |&gt; \n  mutate(survey_area_m2 = scales::comma(survey_area_m2)) |&gt; \n  gt(rowname_col = \"subregion\",\n     groupname_col = \"region\") |&gt; \n  tab_header(title = \"Summary of Fish Surveys by Region\",\n             subtitle = \"Average counts and biomass per station\") |&gt; \ncols_label(n_stations = \"Stations\",\n             survey_area_m2 = \"Survey Area (m²)\",\n             n_taxa = \"Taxa Observed\",\n             avg_taxa = \"Avg. Nº Taxa (per transect)\",\n             avg_count = \"Avg. Count (per transect)\",\n             avg_density_m2 = \"Avg. Density (ind/m²)\",\n             avg_biomass_gm2 = \"Avg. Biomass (g/m²)\",\n             median_biomass_gm2 = \"Median Biomass (g/m²)\",\n             pct_top_predator = \"% Top Predator\",\n             pct_shark = \"% Shark\",\n             pct_lower_carni = \"% Lower Carnivore\",\n             pct_herbi_detri = \"% Herbivore/Detritivore\",\n             pct_plankti = \"% Planktivore\") |&gt; \n  tab_style(style = list(cell_fill(color = \"#f0f0f0\"),\n                         cell_text(weight = \"bold\")),\n            locations = cells_column_labels(everything())) |&gt;\n  opt_table_font(font = list(gt::google_font(\"Roboto\"), default_fonts())) |&gt;\n  opt_row_striping() |&gt; \n  tab_options(row_group.as_column = T,\n              table.width = pct(100),\n              table.font.size = \"small\") |&gt; \n  opt_vertical_padding(scale = 0.7)\n\n\n\n\nTable 3: Summary of fish surveys by subregion\n\n\n\n\n\n\n\n\n\nSummary of Fish Surveys by Region\n\n\nAverage counts and biomass per station\n\n\n\nStations\nSurvey Area (m²)\nTaxa Observed\nAvg. Nº Taxa (per transect)\nAvg. Count (per transect)\nAvg. Density (ind/m²)\nAvg. Biomass (g/m²)\nMedian Biomass (g/m²)\n% Top Predator\n% Shark\n% Lower Carnivore\n% Herbivore/Detritivore\n% Planktivore\n\n\n\n\nLovongai\nAu\n4\n1,200\n101\n24.88\n452.88\n7.48\n2410.65\n1840.84\n33.70\n0.00\n36.70\n20.42\n9.18\n\n\nDunung\n4\n2,250\n136\n28.88\n109.75\n2.06\n101.86\n86.32\n0.80\n0.00\n45.90\n46.85\n6.45\n\n\nEnelava\n2\n1,800\n107\n23.42\n120.83\n2.19\n115.86\n115.86\n3.55\n0.00\n37.90\n47.35\n11.25\n\n\nKung\n2\n600\n70\n27.50\n95.50\n1.61\n196.95\n196.95\n21.60\n0.00\n49.05\n14.05\n15.35\n\n\nNeitab\n3\n1,050\n105\n27.50\n148.83\n2.74\n126.82\n130.96\n4.07\n0.00\n28.33\n27.13\n40.47\n\n\nNemto\n2\n900\n71\n23.33\n98.00\n1.84\n95.12\n95.12\n9.50\n0.00\n62.05\n23.75\n4.65\n\n\nTingwon\n9\n4,500\n206\n29.48\n442.83\n8.36\n485.14\n300.16\n5.83\n0.58\n37.66\n23.79\n32.16\n\n\nTsolik\n3\n1,350\n96\n20.44\n50.89\n0.88\n39.35\n39.94\n4.33\n0.00\n49.77\n32.80\n13.13\n\n\nManus\nBipi\n14\n6,150\n217\n28.99\n241.20\n4.37\n361.15\n195.25\n7.32\n0.00\n26.23\n18.46\n47.97\n\n\nHarengan\n18\n7,050\n236\n27.41\n125.19\n2.14\n140.23\n113.51\n6.86\n0.00\n30.63\n37.36\n25.14\n\n\nManus\n4\n1,800\n128\n29.00\n108.58\n1.99\n112.94\n90.54\n12.65\n0.00\n45.98\n26.12\n15.25\n\n\nMurat\nEmirau\n12\n5,400\n174\n28.14\n237.78\n4.40\n227.46\n110.58\n3.53\n0.61\n29.80\n36.63\n29.44\n\n\nMussau\n26\n11,700\n242\n26.94\n252.31\n4.81\n185.55\n140.78\n8.63\n4.18\n35.33\n29.94\n21.92\n\n\nTench\n6\n2,700\n127\n25.67\n371.44\n7.30\n115.04\n118.97\n9.07\n0.00\n36.20\n23.07\n31.70\n\n\nWestern Islands\nAua\n6\n1,800\n101\n24.00\n470.58\n9.26\n113.18\n103.44\n16.50\n0.00\n47.90\n8.90\n26.70\n\n\nLuf\n15\n4,800\n206\n28.82\n309.90\n5.76\n173.55\n151.12\n4.35\n1.31\n32.57\n29.11\n32.67\n\n\nNinigo\n27\n8,400\n242\n31.53\n329.63\n6.27\n203.40\n132.45\n4.94\n0.70\n33.63\n31.43\n29.29\n\n\nWuvulu\n10\n3,000\n143\n27.10\n391.85\n7.42\n220.81\n172.90\n7.59\n0.00\n48.72\n25.04\n18.67"
  },
  {
    "objectID": "eda_fish.html#taxonomic-summary",
    "href": "eda_fish.html#taxonomic-summary",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "2.2 Taxonomic summary",
    "text": "2.2 Taxonomic summary\n\n\nCode\n# --- Taxon-level summary -----------------------------------------------\n\ntaxa_summary &lt;- biomass_by_taxa_and_station |&gt; \n  group_by(trophic_group, family, accepted_name) |&gt; \n  summarise(freq_obs = round(100*sum(total_count &gt; 0)/n(),2),\n            total_count = sum(total_count),\n            avg_count = round(mean(avg_count, na.rm = T),3),\n            avg_length_cm = round(mean(avg_length_cm, na.rm = T)),\n            min_length_cm = min(min_length_cm, na.rm = T),\n            max_length_cm = max(max_length_cm, na.rm = T),\n            across(c(\"density_m2\",\"biomass_gm2\"),\\(x) mean(x, na.rm = TRUE)),\n            .groups = \"drop\") \n\ntaxa_summary &lt;- taxa_summary |&gt; \n  left_join(fish_lut |&gt; \n              distinct(order, family)) |&gt; \n  select(order, everything())\n\n# --- Family - level summary -------------------------------------\n\nbiomass_by_station_and_family &lt;- biomass_by_taxa_and_station |&gt;\n  group_by(ps_station_id, family) |&gt;\n  summarise(total_count    = sum(total_count), \n            avg_count      = sum(avg_count),\n            density_m2     = sum(density_m2),\n            biomass_gm2    = sum(biomass_gm2),\n            .groups = \"drop\")\n\nfamily_summary &lt;- biomass_by_station_and_family |&gt; \n  group_by(family) |&gt; \n  summarise(freq_obs       = round(100*sum(total_count &gt; 0)/n(),2),\n            avg_count      = round(mean(avg_count), 3),\n            avg_density_m2   = mean(density_m2),\n            avg_biomass_gm2 = mean(biomass_gm2),\n            .groups = \"drop\") \n\nfamily_summary &lt;- family_summary |&gt; \n  left_join(biomass_by_taxa_and_station |&gt;\n              group_by(family) |&gt;\n              summarise(total_count = round(sum(total_count)),\n                        n_taxa      = n_distinct(accepted_name[total_count &gt; 0]),\n                        .groups = \"drop\"),\n             by = \"family\") |&gt; \n  mutate(across(c(avg_density_m2, avg_biomass_gm2), round, 6)) |&gt; \n  select(family, n_taxa, total_count, everything())\n\nfamily_summary &lt;- family_summary |&gt; \n  left_join(fish_lut |&gt; \n              distinct(order, family)) |&gt; \n  select(order, everything())\n\n\nDuring the expedition, we recorded a total of 114,832 individual fish across 446 distinct taxa during standardized transect surveys. Species richness varied across regions with Lovongai exhibiting the highest number of taxa (326 species), followed by the Western Islands and Manus. Murat showed the lowest regional richness, with only 275 species observed.\n\n\nCode\nlibrary(highcharter)\n\nlvl_opts &lt;-  list(list(level = 1,\n                       borderWidth = 0,\n                       borderColor = \"transparent\",\n                       dataLabels = list(enabled = TRUE,\n                                         align = \"left\",\n                                         verticalAlign = \"top\",\n                                         style = list(fontSize = \"12px\", \n                                                      textOutline = FALSE,\n                                                      color = \"#FFFCF9\",\n                                                      fontWeight = \"bold\"))),\n                  list(level = 2,\n                       borderWidth = 0,\n                       borderColor = \"transparent\",\n                       colorVariation = list(key = \"brightness\", to = 0.250),\n                       dataLabels = list(enabled = FALSE),\n                       style = list(fontSize = \"9px\",\n                                    textOutline = FALSE, \n                                    color = \"#FFFCF9\", \n                                    fontWeight = \"bold\")))\n\nhc_data &lt;- taxa_summary |&gt; \n  mutate(n = 1) |&gt; \n  mutate_if(is.numeric, round,2) |&gt; \n  data_to_hierarchical(c(order, family), n)\n\ndiversity_treemap &lt;- hchart(hc_data,\n                            type = \"treemap\",\n                            allowDrillToNode = TRUE,\n                            levels = lvl_opts,\n                            tooltip = list(valueDecimals = FALSE)) |&gt; \n  hc_chart(style = list(fontFamily = \"Roboto\")) |&gt; \n  hc_title(text = \"Number of fish species by order and family\",\n           align = \"left\",\n           style = list(fontFamily = \"Roboto\", fontSize = \"22px\")) |&gt; \n  hc_size(height = 500)\n\ndiversity_treemap\n\n\n\n\n\n\n\n\nFigure 2: Number of fish species by order and family\n\n\n\n\nThe most taxonomically rich families in our surveys were Labridae (wrasses, n = 80), and Pomacentridae (surgeonfishes, n = 78), followed by Chaetodontidae (butterflyfishes, n = 35) ,Acanthuridae (surgeonfishes, n = 32) and Scaridae (parrotfishes, 31) (Table 4)\n\n\nCode\n# Custom theme based on nytimes but with normal header casing\ncustom_tbl_theme &lt;- reactableTheme(\n  backgroundColor = \"#ffffff\",\n  borderColor = \"#e0e0e0\",\n  stripedColor = \"#f9f9f9\",\n  highlightColor = \"#f0f0f0\",\n  cellPadding = \"2px\",\n  style = list(fontFamily = \"Roboto\", fontSize = \"13px\"),\n  headerStyle = list(background = \"#efefef\",\n                     fontWeight = \"bold\",\n                     fontSize = \"13px\",\n                     textTransform = \"none\",   # &lt;- disables all caps\n                     color = \"black\"))\n\n# Prepare data\nfamily_summary_tbl &lt;- family_summary |&gt;\n  mutate(`Taxa Observed`        = n_taxa,\n         `Total Count`    = total_count,\n         `Avg. Count`           = round(avg_count, 2),\n         `Freq. Occurrence (%)` = round(freq_obs, 1),\n         `Avg. Density (ind/m²)`      = round(avg_density_m2, 4),\n         `Avg. Biomass (g/m²)`  = round(avg_biomass_gm2, 4)) |&gt;\n  select(order, family, `Taxa Observed`, `Total Count`, `Avg. Count`, \n         `Freq. Occurrence (%)`, `Avg. Density (ind/m²)`, `Avg. Biomass (g/m²)`)\n\n# Build table\nreactable(family_summary_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Taxa Observed`  = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(order                  = colDef(name = \"Order\", minWidth = 150),\n                                 family                 = colDef(name = \"Family\", minWidth = 150),\n                                 `Freq. Occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n                                 `Avg. Biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n                                 `Avg. Density (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt; \n  add_title(\"Fish Families\") |&gt; \n  add_subtitle(\"Summary of fish families observed during the expedition\",\n               font_size = 20,\n               font_color = '#666666',\n               margin = reactablefmtr::margin(t=10,r=0,b=15,l=0))\n\n\n\n\nTable 4: Summary of fish families observed during the expedition\n\n\n\nFish Families\nSummary of fish families observed during the expedition\n\n\n\n\n\n\n\nSome of the most commonly encountered species includede the bluestreak cleaner wrasse (Labroides dimidiatus, observed at 87% of stations), twospot surgeonfish (Ctenochaetus binotatus, 76%), and bicolor chromis (Pycnochromis margaritifer, 75%)(Table 5). These species were widespread across depth strata and regions.\nIn terms of numerical abundance, the most dominant taxa were the ternate chromis (Chromis ternatensis, 0.84 ind/m²), bicolor chromis (P. margaritifer, 0.73 ind/m²), and the darkfin chromis (Pycnochromis atripes, 0.43 ind/m²).\nBiomass was dominated by larger-bodied taxa such as the sleek unicornfish (Naso hexacanthus, 25 g/m²), bigeye trevally (Caranx sexfasciatus, 22 g/m²), and rainbow runner (Elagatis bipinnulata, 17 g/m²), all of which contributed significantly to overall fish biomass despite lower numerical abundance.\nWe explore differences in community composition across regions in the next sections.\n\n\nCode\n# Prepare data\ntaxa_summary_tbl &lt;- taxa_summary |&gt; \n  rename(`Avg. length (cm)`        = avg_length_cm,\n         `Total count`             = total_count,\n         `Accepted name`           = accepted_name,\n         `Trophic group`           = trophic_group) |&gt; \n  mutate(`Length range (cm)`       = paste0(min_length_cm, \"–\", max_length_cm),\n         `Avg. count`              = round(avg_count, 2),\n         `Freq. occurrence (%)`    = round(freq_obs, 1),\n         `Avg. Density (ind/m²)` = round(density_m2, 4),\n         `Avg. Biomass (g/m²)`     = round(biomass_gm2, 4)) |&gt;\n  select(family, `Accepted name`, `Trophic group`, `Length range (cm)`, `Avg. length (cm)`,\n         `Total count`, `Avg. count`, `Freq. occurrence (%)`,\n         `Avg. Density (ind/m²)`, `Avg. Biomass (g/m²)`)\n\n# Build interactive table\nreactable(taxa_summary_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Total count` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns = list(family                     = colDef(name = \"Family\", minWidth = 150),\n                         `Accepted name`            = colDef(name = \"Accepted name\",\n                                                             cell = function(value) htmltools::tags$i(value),\n                                                             minWidth = 180),\n                         `Freq. occurrence (%)`     = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n                         `Avg. Biomass (g/m²)`      = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n                         `Avg. Density (ind/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish species\") |&gt;\n  add_subtitle(\"Summary of fish species observed during the expedition\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\n\n\nTable 5: Summary of fish species observed during the expedition\n\n\n\nFish species\nSummary of fish species observed during the expedition"
  },
  {
    "objectID": "eda_fish.html#overall-patterns",
    "href": "eda_fish.html#overall-patterns",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "6.1 Overall patterns",
    "text": "6.1 Overall patterns\n•   Contribution of each trophic group to total biomass and abundance (stacked bar plots).\n•   Emphasize dominant groups (e.g. planktivores, herbivores, piscivores).\n\n\nCode\nbiomass_by_station_and_taxa |&gt; \n  group_by(ps_station_id, trophic_group) |&gt; \n  summarize(total_biomass_m2 = sum(avg_biomass_m2),\n            total_count_m2   = sum(avg_count_m2),\n            .groups = \"drop\") |&gt; \n  left_join(stations |&gt; \n              distinct(ps_station_id, region, subregion), \n            by = \"ps_station_id\") |&gt; \n  group_by(region, subregion, trophic_group) |&gt;\n  summarize(avg_biomass_m2 = mean(total_biomass_m2),\n            avg_count_m2   = mean(total_count_m2),\n            .groups = \"drop\") |&gt; \n  ggplot(aes(fct_reorder(subregion, avg_biomass_m2, sum, .desc = T), avg_biomass_m2, fill = trophic_group))+\n  geom_col()+\n  facet_wrap(~region, ncol = 4, scales = \"free_x\") +\n  labs(x = \"\", y = \"Average biomass (g/m²)\", fill = \"\",\n       title = \"Average fish biomass by trophic group and region\",\n       subtitle = \"Stacked bar plots show the contribution of each trophic group to total biomass\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\")+\n  guides(fill = guide_legend(nrow = 1, byrow = TRUE))\n\n\n\n\n\n\n\n\n\n\n\nCode\nbiomass_by_station_and_taxa |&gt; \n  group_by(ps_station_id, trophic_group) |&gt; \n  summarize(total_biomass_m2 = sum(avg_biomass_m2),\n            total_count_m2   = sum(avg_count_m2),\n            .groups = \"drop\") |&gt; \n  left_join(stations |&gt; \n              distinct(ps_station_id, region, subregion), \n            by = \"ps_station_id\") |&gt; \n  group_by(region, subregion, trophic_group) |&gt;\n  summarize(avg_biomass_m2 = mean(total_biomass_m2),\n            avg_count_m2   = mean(total_count_m2),\n            .groups = \"drop\") |&gt; \n  ggplot(aes(fct_reorder(subregion, avg_count_m2, sum, .desc = T), avg_count_m2, fill = trophic_group))+\n  geom_col()+\n  facet_wrap(~region, ncol = 4, scales = \"free_x\") +\n  labs(x = \"\", y = \"Average Abundance (in/m²)\", fill = \"\",\n       title = \"Average fish Abundance by trophic group and region\",\n       subtitle = \"Stacked bar plots show the contribution of each trophic group to total abundance\")+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\")+\n  guides(fill = guide_legend(nrow = 1, byrow = TRUE))"
  },
  {
    "objectID": "eda_fish.html#spatial-trends",
    "href": "eda_fish.html#spatial-trends",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "6.1 spatial trends",
    "text": "6.1 spatial trends\nRegional comparisons of trophic structure (e.g. group-wise proportions per region). • Depth-stratified breakdowns, if patterns emerge."
  },
  {
    "objectID": "eda_fish.html#top-predators",
    "href": "eda_fish.html#top-predators",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "6.1 top predators",
    "text": "6.1 top predators\n\n\nCode\nbiomass_top_pred &lt;- biomass_by_station_and_trophic |&gt; \n  filter(trophic_group %in% c(\"Top-predator\")) |&gt; \n  group_by(ps_station_id, trophic_group, region) |&gt; \n  summarize(prop_top_pred = sum(frac_biomass), .groups = \"drop\") \n\nbiomass_top_pred |&gt; \n  ggplot(aes(x = region, y = prop_top_pred)) +\n  geom_boxplot(outlier.shape = NA, fill = \"#F08A4B\", alpha = 0.6) +\n  geom_jitter(width = 0.2, alpha = 0.6) +\n  labs(\n    title = \"Proportion of Biomass in Top Predators and Sharks\",\n    y = \"Proportion of Total Biomass\",\n    x = NULL\n  ) +\n  theme_minimal(base_size = 13)"
  },
  {
    "objectID": "eda_fish.html#by-family",
    "href": "eda_fish.html#by-family",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "5.1 By Family",
    "text": "5.1 By Family\n\n\nCode\nlibrary(paletteer)\n\ncreate_family_pal &lt;- function(col, n){\n  col &lt;- unique(col)\n  \n  foo &lt;- scales::colour_ramp(c(adjust_luminance(color = col, steps = +2),\n                      adjust_luminance(color = col, steps = -.5)))\n  \n  foo(seq(0, 1, length = n))\n}\n\ntaxa_colors &lt;- taxa_summary |&gt; \n  distinct(family, accepted_name, biomass_gm2) |&gt; \n  mutate(color_fam = highcharter::colorize(family, \n                              paletteer_d(\"ggsci::default_igv\", direction = -1, n = 43))) |&gt; \n  arrange(desc(family)) |&gt; \n  group_by(family) |&gt; \n  arrange(desc(biomass_gm2)) |&gt; \n  mutate(n_taxa = n_distinct(accepted_name),\n         color_sp = highcharter::colorize(accepted_name,\n                             colors = create_family_pal(col = color_fam, n = n_taxa))) |&gt; \n  ungroup()\n\nhc_data &lt;- taxa_summary |&gt; \n  left_join(taxa_colors |&gt; \n              select(accepted_name, color_fam, color_sp)) |&gt; \n  filter(!is.na(color_sp)) |&gt; \n  mutate_if(is.numeric, round, 1) |&gt; \n  arrange(desc(family)) |&gt; \n  group_by(family) |&gt; \n  arrange(desc(biomass_gm2)) \n\ndata_to_hierarchical(hc_data,\n                     c(family, accepted_name), \n                     biomass_gm2, colors = unique(hc_data$color_fam)) |&gt; \n  hchart(\n    type = \"treemap\",\n    allowDrillToNode = TRUE,\n    levels = lvl_opts,\n    tooltip = list(valueDecimals = 1)) |&gt; \n  hc_chart(style = list(fontFamily = \"Times New Roman\")) |&gt; \n  hc_title(text = \"Fish biomass by family\",\n           style = list(fontFamily = \"Times New Roman\")) |&gt; \n  hc_size(height = 500) |&gt; \n  highcharter::hc_tooltip(crosshairs = T) \n\n\n\n\n\n\n\n\nFigure 19: Biomass by family\n\n\n\n\n\n\nCode\nlibrary(plotly)\n\n# 1. Get top 20 families by total biomass\ntop_fams &lt;- biomass_by_station_and_family |&gt; \n  group_by(family) |&gt; \n  summarize(total_biomass = sum(biomass_gm2, na.rm = TRUE), .groups = \"drop\") |&gt; \n  slice_max(total_biomass, n = 20) |&gt; \n  pull(family)\n\n# 2. Prepare data and group others into \"Other\"\nplot_data &lt;- biomass_by_station_and_family |&gt;\n  left_join(stations |&gt; distinct(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt;\n  mutate(family = if_else(family %in% top_fams, family, \"Other\")) |&gt; \n  group_by(region, subregion, family) |&gt;\n  summarize(biomass_gm2 = round(mean(biomass_gm2), 1), .groups = \"drop\") |&gt;\n  mutate(subregion = fct_reorder(subregion, biomass_gm2, .fun = sum, .desc = TRUE))\n\n# 3. Build family color scale (ensure 'Other' is included)\nfam_colors &lt;- taxa_colors |&gt; \n  filter(family %in% top_fams) |&gt; \n  distinct(family, color_fam) |&gt; \n  add_row(family = \"Other\", color_fam = \"#CCCCCC\") |&gt; \n  deframe()\n\n# 4. Plot\np &lt;- ggplot(plot_data, aes(x = subregion, y = biomass_gm2, fill = family)) +\n  geom_col() +\n  labs(x = \"\", y = \"Average biomass (g/m²)\", fill = \"\",\n       title = \"Fish Biomass by Family and Subregion\",\n       subtitle = \"Stacked bar plot showing mean biomass contributions by family (top 20 only)\") +\n  scale_fill_manual(values = fam_colors) +\n  theme_minimal(base_size = 13) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  guides(fill = guide_legend(nrow = 2, byrow = TRUE))+\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")\n\nggplotly(p, tooltip = c(\"x\", \"y\", \"fill\")) |&gt; \n  layout(legend = list(\n    orientation = \"h\",\n    xanchor = \"center\",\n    x = 0.5,\n    y = -0.25,\n    title = list(text = \"\")))\n\n\n\n\n\n\n\n\nFigure 20: Biomass by family and subregion\n\n\n\n\n\n\nCode\n# Function to create biomass plot for any region\n\nplot_biomass_by_region &lt;- function(data, region_name, n_top_families = 10) {\n  \n  # Filter data for the specified region\n  region_data &lt;- data |&gt; \n    filter(region == region_name)\n  \n  # Get top n families by median biomass for this region\n  \n  top_n_fams &lt;- region_data |&gt; \n    group_by(family) |&gt; \n    summarize(avg_biomass_gm2 = mean(biomass_gm2),\n              median_biomass_gm2 = median(biomass_gm2),\n              .groups = \"drop\") |&gt; \n    slice_max(median_biomass_gm2, n = n_top_families)\n  \n  # Define color palette (use existing or generate new ones if needed)\n  \n  family_colors &lt;- c(\n    \"Scaridae\"       = \"#009E73\",  # Green – herbivorous parrotfishes\n    \"Acanthuridae\"   = \"#0072B2\",  # Blue – surgeonfishes\n    \"Lutjanidae\"     = \"#D55E00\",  # Orange – snappers (predators)\n    \"Caesionidae\"    = \"#56B4E9\",  # Sky blue – fusiliers (planktivores)\n    \"Pomacentridae\"  = \"#E69F00\",  # Amber – damselfishes (ubiquitous)\n    \"Labridae\"       = \"#999999\",  # Gray – wrasses (diverse)\n    \"Chaetodontidae\" = \"#F0E442\",  # Yellow – butterflyfishes (corallivores)\n    \"Epinephelidae\"  = \"#CC79A7\",  # Pink – groupers (top predators)\n    \"Lethrinidae\"    = \"#882255\",  # Wine red – emperors (benthic feeders)\n    \"Balistidae\"     = \"#117733\",  # Dark green – triggerfishes (tough, spiny)\n    'Other'          = \"black\"   # Dark gray for other families\n  )\n  \n  # Create plot\n  p &lt;- region_data |&gt; \n    # Group less common families as \"Other\"\n    mutate(family = if_else(family %in% top_n_fams$family, family, \"Other\")) |&gt;\n    # Calculate mean biomass by subregion and family\n    group_by(subregion, family) |&gt;\n    summarize(biomass_gm2 = mean(biomass_gm2),\n              .groups = \"drop\") |&gt; \n    # Reorder families by biomass for better visualization\n    ggplot(aes(x = fct_reorder(subregion, biomass_gm2, sum, .desc = TRUE),\n               y = biomass_gm2, \n               fill = fct_reorder(family, biomass_gm2, .fun = mean, .desc = FALSE))) +\n    geom_col() +\n    labs(x = \"\", y = \"Average biomass (g/m²)\", fill = \"\",\n         title = paste0(\"Fish Biomass by Family and Subregion - \", region_name),\n         subtitle = \"Stacked bar plot showing mean biomass contributions by family\") +\n    scale_fill_manual(values = family_colors) +\n    theme_minimal(base_size = 13) +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1),\n          legend.position = \"bottom\",\n          legend.box = \"horizontal\",\n          plot.title = element_text(face = \"bold\"),\n          panel.grid.major.x = element_blank()) +\n    guides(fill = guide_legend(nrow = 2, byrow = TRUE))\n  \n  # Return the plot\n  return(p)\n}\n\n# Create a joined dataset once (outside the function)\nfull_data &lt;- biomass_by_station_and_family |&gt; \n  left_join(stations |&gt; distinct(ps_station_id, region, subregion), by = \"ps_station_id\")\n\n# Example usage for Murat region\nmurat_plot &lt;- plot_biomass_by_region(full_data, \"Murat\")\n\n# Save the plot\nggsave(file.path(exp_path, paste0(\"figures/uvs_fish_biomass_by_family_by_subregion_Murat.pdf\")), \n       murat_plot, width = 10, height = 8)\n\n# For all regions in the dataset:\nall_regions &lt;- unique(full_data$region)\nfor (region_name in all_regions) {\n  p &lt;- plot_biomass_by_region(full_data, region_name)\n  ggsave(file.path(exp_path, paste0(\"figures/uvs_fish_biomass_by_family_by_subregion_\", \n                                    region_name, \".pdf\")), \n         p, width = 10, height = 8)\n}"
  },
  {
    "objectID": "eda_fish.html#by-species",
    "href": "eda_fish.html#by-species",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "5.2 By Species",
    "text": "5.2 By Species\n\n\nCode\ntaxa_summary$trophic_group |&gt; unique()\n\n\n[1] \"herbivore/detritivore\" \"lower_carnivore\"       \"planktivore\"          \n[4] \"shark\"                 \"top_predator\"         \n\n\nCode\ntrophic_palette &lt;- c(\"herbivore/detritivore\"  = \"#5C9E5C\",\n                     \"planktivore\"      = \"#4C9CB2\",\n                     \"lower_carnivore\"  = \"#E1B07E\",\n                     \"top_predator\" = \"#C75D4D\",\n                     \"shark\"        = \"#7E6FAB\")\n\ntmp_plot &lt;- taxa_summary |&gt; \n  mutate(density_100m2 = 100*density_m2) |&gt; \n  mutate_if(is.numeric, round, 3) |&gt; \n  mutate(tooltip = c(paste0(\"Taxa = \", accepted_name,\n                            \"\\n Family = \", family,\n                            \"\\n Frequency (% stations) = \", freq_obs,\n                            \"\\n Abundance (ind/100m2) = \", density_100m2,\n                            \"\\n Biomass (g/m2) = \", biomass_gm2))) |&gt; \n  ggplot()+\n  ggiraph::geom_point_interactive(aes(x = freq_obs, \n                                      y = density_100m2, \n                                      size = biomass_gm2, \n                                      col = trophic_group, \n                                      tooltip = tooltip))+\n  scale_color_manual(values = trophic_palette, na.value = \"lightgrey\")+\n  scale_y_log10()+\n  labs(y = \"Abundance (Ind x 100m2)\", \n       x = \"Frequency (% station-strata)\", \n       col = \"Trophic group\", \n       size = \"Biomass\")+\n  ggthemes::theme_hc()+\n  theme(legend.title.position = \"top\", legend.position = \"right\")\n\nggiraph::girafe(ggobj = tmp_plot)\n\n\n\n\n\n\n\n\nFigure 21: Frequency, abundance, and biomass by species"
  },
  {
    "objectID": "eda_fish.html#species-contributions-to-dissimilarity",
    "href": "eda_fish.html#species-contributions-to-dissimilarity",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "7.1 Species contributions to dissimilarity",
    "text": "7.1 Species contributions to dissimilarity\nTo identify the species driving regional differences in community composition, we conducted a Similarity Percentages (SIMPER) analysis based on Bray-Curtis dissimilarity of biomass values. This method decomposes pairwise differences between regions into contributions by individual species, highlighting those most responsible for observed dissimilarities. For each pairwise comparison, we extracted the top ten contributing species and visualized their mean biomass in each region. These results offer an intuitive view of which taxa differentiate local assemblages and can help identify regionally distinctive or dominant species.\n\n\nCode\n# 1. Run SIMPER on all region pairs\nsimper_result &lt;- simper(spp_matrix, spp_meta$region, permutations = 999)\n\n# 2. Tidy the output into a long dataframe of top contributors\nsimper_summary_all &lt;- map_dfr(names(simper_result), \n                              function(pair_name) {\n                                sim &lt;- simper_result[[pair_name]]\n                                tibble(pair         = pair_name,\n                                       species      = sim$species,\n                                       avg_contrib  = sim$average,\n                                       sd_contrib   = sim$sd,\n                                       ratio        = sim$ratio,\n                                       mean_group_a = sim$ava,\n                                       mean_group_b = sim$avb,\n                                       cumsum       = sim$cusum,\n                                       p_value      = sim$p) |&gt;\n                                  arrange(desc(avg_contrib)) |&gt;\n                                  slice_head(n = 10) |&gt;\n                                  mutate(across(where(is.numeric), round, 3))})\n\n# 3. Add region labels and melt for plotting\nsimper_plot_data &lt;- simper_summary_all |&gt;\n  separate(pair, into = c(\"region_a\", \"region_b\"), sep = \"_\") |&gt;\n  pivot_longer(cols = c(mean_group_a, mean_group_b),\n               names_to = \"region_code\", values_to = \"mean_biomass\") |&gt;\n  mutate(region = case_when(region_code == \"mean_group_a\" ~ region_a,\n                            region_code == \"mean_group_b\" ~ region_b))\n\n# 4. Function to plot all comparisons for a given region\nplot_simper_by_focal &lt;- function(focal_region) {\n  \n  simper_plot_data |&gt;\n    filter(region_a == focal_region | region_b == focal_region) |&gt;\n    mutate(comparison = if_else(region_a == focal_region, region_b, region_a)) |&gt;\n    ggplot(aes(x = fct_reorder(species, avg_contrib), \n               y = mean_biomass, fill = region)) +\n    geom_col(position = \"dodge\") +\n    facet_wrap(~comparison, scales = \"free_x\") +\n    labs(title = glue(\"Top 10 Species Driving Differences with {focal_region}\"),\n         subtitle = \"SIMPER analysis (Bray-Curtis, biomass)\",\n         x = \"\", y = \"Mean biomass (g/m²)\", fill = \"\") +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1),\n          strip.text = element_text(face = \"bold\"),\n          legend.position = \"bottom\",\n      legend.box = \"horizontal\",\n      legend.text = element_text(size = 10))+\n    guides(fill = guide_legend(nrow = 1, byrow = TRUE))\n  \n}\n\n\n\nManusMuratWestern IslandsLovongai\n\n\n\n\nCode\n#|\n\nplot_simper_by_focal(\"Manus\")\n\n\n\n\n\n\n\n\nFigure 28: Top 10 species driving differences with Manus\n\n\n\n\n\n\n\n\n\nCode\n#|\n\nplot_simper_by_focal(\"Murat\")\n\n\n\n\n\n\n\n\nFigure 29: Top 10 species driving differences with Murat\n\n\n\n\n\n\n\n\n\nCode\n#|\n\nplot_simper_by_focal(\"Western Islands\")\n\n\n\n\n\n\n\n\nFigure 30: Top 10 species driving differences with the Western Islands\n\n\n\n\n\n\n\n\n\nCode\n#|\n\nplot_simper_by_focal(\"Lovongai\")\n\n\n\n\n\n\n\n\nFigure 31: Top 10 species driving differences with Lovongai"
  },
  {
    "objectID": "eda_fish.html#spatial-patterns",
    "href": "eda_fish.html#spatial-patterns",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "5.3 Spatial patterns",
    "text": "5.3 Spatial patterns\n\n\nCode\nlibrary(leaflet)\nlibrary(scales)\n\n# Normalize for circle radius (sqrt scaling for visual comparability)\nsite_summary &lt;- station_summary |&gt; \n  group_by(region, subregion, ps_site_id) |&gt; \n  summarize(mean_abundance = mean(avg_count_m2),\n            mean_biomass = mean(avg_biomass_m2, na.rm = TRUE),\n            n_transects = sum(n_transects, na.rm = TRUE),\n            .groups = \"drop\") |&gt; \n  left_join(uvs_sites |&gt; \n              select(ps_site_id, latitude, longitude), \n            by = \"ps_site_id\") \n\n\n\n\n\n\nMean fish biomass (g/m²) by site"
  },
  {
    "objectID": "eda_fish.html#taxa-summary-by-region",
    "href": "eda_fish.html#taxa-summary-by-region",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "8.1 Taxa Summary by Region",
    "text": "8.1 Taxa Summary by Region\n\n\n\nTable 9: Taxon-level summary by region"
  },
  {
    "objectID": "eda_fish.html#by-species-1",
    "href": "eda_fish.html#by-species-1",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "8.1 By Species",
    "text": "8.1 By Species\n\nLovongaiMuratManusWestern Islands\n\n\n\n\nCode\n# Filter Lovongai data\nlovongai_tbl &lt;- taxa_summary_by_region |&gt; \n  filter(region == \"Lovongai\", avg_biomass_m2 &gt; 0) |&gt;\n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(`Accepted name`             = accepted_name,\n         `Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3),\n         `Mean TL (cm)`              = avg_length_wm,\n         `Min TL (cm)`               = min_tl_cm,\n         `Max TL (cm)`               = max_tl_cm) |&gt;\n  select(family, `Accepted name`, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`,\n         `Mean TL (cm)`, `Min TL (cm)`, `Max TL (cm)`)\n\n# Render reactable\nreactable(lovongai_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Accepted name` = colDef(name = \"Accepted name\",\n                                     cell = function(value) htmltools::tags$i(value),\n                                     minWidth = 180),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish species\") |&gt;\n  add_subtitle(\"Summary of fish species observed in Lovongai\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish species\nSummary of fish species observed in Lovongai\n\n\n\n\n\n\n\n\nCode\n# Filter Murat data\nmurat_tbl &lt;- taxa_summary_by_region |&gt; \n  filter(region == \"Murat\", avg_biomass_m2 &gt; 0) |&gt;\n  mutate(`Accepted name`             = accepted_name,\n         `Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3),\n         `Mean TL (cm)`              = avg_length_wm,\n         `Min TL (cm)`               = min_tl_cm,\n         `Max TL (cm)`               = max_tl_cm) |&gt;\n  select(family, `Accepted name`, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`,\n         `Mean TL (cm)`, `Min TL (cm)`, `Max TL (cm)`)\n\n# Render reactable\nreactable(murat_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Accepted name` = colDef(name = \"Accepted name\",\n                                     cell = function(value) htmltools::tags$i(value),\n                                     minWidth = 180),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish species\") |&gt;\n  add_subtitle(\"Summary of fish species observed in Murat\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish species\nSummary of fish species observed in Murat\n\n\n\n\n\n\n\n\nCode\n# Filter Manus data\nmanus_tbl &lt;- taxa_summary_by_region |&gt; \n  filter(region == \"Manus\", avg_biomass_m2 &gt; 0) |&gt;\n  mutate(`Accepted name`             = accepted_name,\n         `Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3),\n         `Mean TL (cm)`              = avg_length_wm,\n         `Min TL (cm)`               = min_tl_cm,\n         `Max TL (cm)`               = max_tl_cm) |&gt;\n  select(family, `Accepted name`, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`,\n         `Mean TL (cm)`, `Min TL (cm)`, `Max TL (cm)`)\n\n# Render reactable\nreactable(manus_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Accepted name` = colDef(name = \"Accepted name\",\n                                     cell = function(value) htmltools::tags$i(value),\n                                     minWidth = 180),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish species\") |&gt;\n  add_subtitle(\"Summary of fish species observed in Manus\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish species\nSummary of fish species observed in Manus\n\n\n\n\n\n\n\n\nCode\n# Filter Murat data\nislands_tbl &lt;- taxa_summary_by_region |&gt; \n  filter(region == \"Western Islands\", avg_biomass_m2 &gt; 0) |&gt;\n  mutate(`Accepted name`             = accepted_name,\n         `Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3),\n         `Mean TL (cm)`              = avg_length_wm,\n         `Min TL (cm)`               = min_tl_cm,\n         `Max TL (cm)`               = max_tl_cm) |&gt;\n  select(family, `Accepted name`, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`,\n         `Mean TL (cm)`, `Min TL (cm)`, `Max TL (cm)`)\n\n# Render reactable\nreactable(islands_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 20,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Accepted name` = colDef(name = \"Accepted name\",\n                                     cell = function(value) htmltools::tags$i(value),\n                                     minWidth = 180),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish species\") |&gt;\n  add_subtitle(\"Summary of fish species observed in the Western Islands\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish species\nSummary of fish species observed in the Western Islands"
  },
  {
    "objectID": "eda_fish.html#by-family-1",
    "href": "eda_fish.html#by-family-1",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "8.2 By family",
    "text": "8.2 By family\n\nLovongaiMuratManusWestern Islands\n\n\n\n\nCode\n# Filter Lovongai data\nlovongai_tbl &lt;- family_summary_by_region |&gt; \n  filter(region == \"Lovongai\", avg_biomass_m2 &gt; 0) |&gt;\n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(`Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3)) |&gt;\n  select(family, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`)\n\n# Render reactable\nreactable(lovongai_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish families\") |&gt;\n  add_subtitle(\"Summary of fish families observed in Lovongai\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish families\nSummary of fish families observed in Lovongai\n\n\n\n\n\n\n\n\nCode\n# Filter Lovongai data\nmurat_tbl &lt;- family_summary_by_region |&gt; \n  filter(region == \"Murat\", avg_biomass_m2 &gt; 0) |&gt;\n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(`Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3)) |&gt;\n  select(family, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`)\n\n# Render reactable\nreactable(murat_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish families\") |&gt;\n  add_subtitle(\"Summary of fish families observed in Murat\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish families\nSummary of fish families observed in Murat\n\n\n\n\n\n\n\n\nCode\n# Filter Lovongai data\nmanus_tbl &lt;- family_summary_by_region |&gt; \n  filter(region == \"Manus\", avg_biomass_m2 &gt; 0) |&gt;\n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(`Family`                    = family,\n         `Total count`               = total_count,\n         `Avg. count`                = round(avg_count, 2),\n         `Freq. occurrence (%)`      = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)`   = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`       = round(avg_biomass_m2, 3)) |&gt;\n  select(family, `Total count`, `Avg. count`,\n         `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`)\n\n# Render reactable\nreactable(manus_tbl,\n          filterable      = TRUE,\n          pagination      = TRUE,\n          defaultPageSize = 10,\n          striped         = TRUE,\n          highlight       = TRUE,\n          defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n          theme           = custom_tbl_theme,\n          columns         = list(\n            family = colDef(name = \"Family\", minWidth = 150),\n            `Freq. occurrence (%)` = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n            `Avg. biomass (g/m²)`  = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n            `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish families\") |&gt;\n  add_subtitle(\"Summary of fish families observed in Manus\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))\n\n\nFish families\nSummary of fish families observed in Manus\n\n\n\n\n\n\n\n\nCode\n# Filter Lovongai data\nislands_tbl &lt;- family_summary_by_region |&gt; \n  filter(region == \"Western Islands\", avg_biomass_m2 &gt; 0) |&gt;\n  arrange(desc(avg_biomass_m2)) |&gt; \n  mutate(`Family`                  = family,\n         `Total count`             = total_count,\n         `Avg. count`              = round(avg_count, 2),\n         `Freq. occurrence (%)`    = round(freq_obs, 2),\n         `Avg. abundance (ind/m²)` = round(avg_count_m2, 3),\n         `Avg. biomass (g/m²)`     = round(avg_biomass_m2, 3)) |&gt;\n  select(family, `Total count`, `Avg. count`, `Freq. occurrence (%)`, `Avg. abundance (ind/m²)`, `Avg. biomass (g/m²)`)\n\n# Render reactable\ntmp &lt;- reactable(islands_tbl,\n                 filterable      = TRUE,\n                 pagination      = TRUE,\n                 defaultPageSize = 10,\n                 striped         = TRUE,\n                 highlight       = TRUE,\n                 elementId       = \"summary-tbl\",\n                 defaultSorted   = list(`Avg. biomass (g/m²)` = \"desc\"),\n                 theme           = custom_tbl_theme,\n                 columns         = list(family                    = colDef(name = \"Family\", minWidth = 150),\n                                        `Freq. occurrence (%)`    = colDef(cell = function(value) paste0(value, \"%\"), align = \"center\"),\n                                        `Avg. biomass (g/m²)`     = colDef(cell = function(value) comma(value, accuracy = 0.001)),\n                                        `Avg. abundance (ind/m²)` = colDef(cell = function(value) comma(value, accuracy = 0.001)))) |&gt;\n  add_title(\"Fish families\") |&gt;\n  add_subtitle(\"Summary of fish families observed in the Western Islands\",\n               font_size  = 20,\n               font_color = \"#666666\",\n               margin     = reactablefmtr::margin(t = 10, r = 0, b = 15, l = 0))"
  },
  {
    "objectID": "eda_lpi.html",
    "href": "eda_lpi.html",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "",
    "text": "Code\n# Load the data\n\nload(file = file.path(exp_path, \"data\", \"primary\", \"processed\", \"lpi\", \"lpi_staging.RData\"))\n\nsites &lt;- read_rds(file.path(exp_path, \"data/primary/processed/sites.rds\"))\n\nuvs_sites &lt;- sites$uvs\n\nregion_names &lt;- lpi_stations |&gt; \n  distinct(region) |&gt; \n  arrange(region) |&gt; \n  pull(region)\n\n# Create a clean inline string (e.g., \"Lovongai, Manus, Murat, and Western Islands\")\nregion_list &lt;- glue::glue_collapse(region_names, sep = \", \", last = \", and \")\n\nfunctional_group_order &lt;- c(\"hard coral\", \"cca\", \"soft coral\", \"sponges\", \"erect algae\", \"encrusting algae\", \"turf\", \"sediment/rubble/barren\", \"other\", \"cyanobacteria\")\n\nregion_order &lt;- c(\"Lovongai\", \"Murat\", \"Manus\", \"Western Islands\")\n\nfunctional_palette &lt;- c(\"hard coral\"             = \"#EA9E8D\",\n                        \"cca\"                    = \"#F1B6DA\",\n                        \"cyanobacteria\"          = \"#000000\",\n                        \"soft coral\"             = \"#B4D6D3\",\n                        \"sponges\"                = \"#F6C141\",\n                        \"sediment/rubble/barren\" = \"#BDBDBD\",\n                        \"encrusting algae\"       = \"#88B04B\",     # sage green\n                        \"erect algae\"            = \"#4DAF4A\",     # bright macroalgal green\n                        \"turf\"                   = \"#8C6D31\",     # slate blue\n                        \"other\"                  = \"#7C4D8E\")\n\nregion_palette &lt;- c(\"Murat\"           = \"#20C997\",  \n                    \"Lovongai\"        = \"#F94144\",  \n                    \"Manus\"           = \"#577590\",\n                    \"Western Islands\" = \"#F9C74F\")  \n\nhabitat_palette &lt;- c(\"fore reef\"  = \"#8BE0D4\",  # clearer aqua — more readable than pale cyan\n                     \"back reef\"  = \"#E67E7E\",  # soft coral red — distinct but not too aggressive\n                     \"channel\"    = \"#F4C542\",  # golden yellow — fits reef + sand imagery\n                     \"patch reef\" = \"#9370DB\"  )\n\n# Custom theme based on nytimes but with normal header casing\ncustom_tbl_theme &lt;- reactableTheme(backgroundColor = \"#ffffff\",\n                                   borderColor = \"#e0e0e0\",\n                                   stripedColor = \"#f9f9f9\",\n                                   highlightColor = \"#f0f0f0\",\n                                   cellPadding = \"2px\",\n                                   style = list(fontFamily = \"Roboto\", fontSize = \"13px\"),\n                                   headerStyle = list(background = \"#efefef\",\n                                                      fontWeight = \"bold\",\n                                                      fontSize = \"13px\",\n                                                      textTransform = \"none\",   # &lt;- disables all caps\n                                                      color = \"black\"))\n\n# Custom gt table theme\ncustom_gt_theme &lt;- function(gt_table) {\n  gt_table |&gt;\n    fmt_number(\n      columns = where(is.numeric),\n      decimals = 2\n    ) |&gt;\n    tab_style(\n      style = list(cell_text(weight = \"bold\")),\n      locations = cells_body(\n        columns = everything(),\n        rows = if_else(!is.null(gt_table$`_data`) && \"p_raw\" %in% names(gt_table$`_data`), gt_table$`_data`$p_raw &lt; 0.05, FALSE)\n      )\n    ) |&gt;\n    cols_hide(columns = matches(\"p_raw\")) |&gt;\n    cols_align(align = \"center\") |&gt;\n    opt_row_striping() |&gt;\n    tab_options(\n      table.font.size = \"small\",\n      heading.title.font.size = 16,\n      heading.subtitle.font.size = 13,\n      row.striping.background_color = \"#f0f0f0\",\n      table.border.top.color = \"white\",\n      table.border.bottom.color = \"white\",\n      column_labels.font.weight = \"bold\"\n    )\n}\nThis document presents an exploratory analysis of benthic community structure from the Pristine Seas: Papua New Guinea 2024 expedition. Using standardized Line Point-Intercept (LPI) surveys across diverse reef habitats and regions, we examine patterns in benthic richness, community composition, reef health indicators, and coral bleaching. The goal is to extract key ecological signals to inform downstream synthesis, conservation planning, and scientific reporting"
  },
  {
    "objectID": "eda_fish.html#biodiversity-surveys",
    "href": "eda_fish.html#biodiversity-surveys",
    "title": "Exploratory Analysis of Fish Survey Data",
    "section": "3.1 Biodiversity surveys",
    "text": "3.1 Biodiversity surveys\n\n\nCode\nbio_obs &lt;- read_xlsx(file.path(exp_path, \"data\", \"primary\", \"raw\", \"fish\", \"PNG_2024_fish_fieldbook_ALG_FINAL.xlsx\"),\n          sheet = \"biodiversity observations\") |&gt; \n  select(ps_site_id = ps_station_id, taxon_valid_name, rel_abundance_code)\n\nname_to_accepted_AphiaID &lt;- fish_lut |&gt;\n    pivot_longer(cols = c(\"taxon_name\", \"accepted_name\"), names_to = \"orig_col\", values_to = \"lookup_name\") |&gt;\n    filter(!is.na(lookup_name)) |&gt;\n    distinct(accepted_aphia_id, lookup_name)\n\nbio_obs &lt;- bio_obs |&gt; \n  left_join(name_to_accepted_AphiaID, by = c(\"taxon_valid_name\" = \"lookup_name\")) |&gt; \n  filter(!is.na(accepted_aphia_id)) |&gt; \n  mutate(ps_site_id = str_replace(ps_site_id, \"(\\\\d+)$\", ~ str_pad(.x, width = 3, pad = \"0\"))) |&gt; \n  left_join(stations |&gt; \n              distinct(ps_site_id, region)) |&gt; \n  select(region, ps_site_id, taxon_valid_name, accepted_aphia_id, everything())\n\nbio_aphiaIDs_per_region &lt;- bio_obs |&gt; \n  group_by(region, taxon_valid_name, accepted_aphia_id) |&gt; \n  summarize(n_sites = n_distinct(ps_site_id),\n            # most common rel abundance code\n            rel_abundance_code = names(which.max(table(rel_abundance_code))),\n            .groups = \"drop\") \n\nblt_aphiaIDs_per_region &lt;- biomass_by_taxa_and_station |&gt; \n  filter(total_count &gt; 0) |&gt; \n  left_join(stations |&gt; \n              distinct(ps_station_id, region)) |&gt;\n  distinct(region, accepted_aphia_id, accepted_name)\n\nnew_bio_obs &lt;- bio_aphiaIDs_per_region |&gt; \n  anti_join(blt_aphiaIDs_per_region) \n\nnew_bio_obs &lt;- new_bio_obs |&gt; \n  left_join(fish_lut |&gt; distinct(accepted_aphia_id, family, rank)) |&gt; \n  filter(rank == \"species\")\n  \nnew_taxa_summary &lt;- bio_obs |&gt; \n  group_by(region) |&gt; \n  summarize(n_sites = n_distinct(ps_site_id),\n            n_taxa = n_distinct(accepted_aphia_id),\n              .groups = \"drop\") |&gt; \n  left_join(new_bio_obs |&gt; \n              group_by(region) |&gt; \n              summarize(new_taxa = n_distinct(accepted_aphia_id)))\n\nregion_summary |&gt; \n  select(region, n_taxa) |&gt; \n  left_join(new_taxa_summary |&gt; \n              select(region, new_taxa)) |&gt; \n  mutate(total = rowSums(cbind(n_taxa, new_taxa), na.rm = T)) \n\n\n# A tibble: 4 × 4\n  region          n_taxa new_taxa total\n  &lt;chr&gt;            &lt;dbl&gt;    &lt;int&gt; &lt;dbl&gt;\n1 Lovongai           326       NA   326\n2 Manus              311       44   355\n3 Murat              275       NA   275\n4 Western Islands    294      170   464\n\n\nFor three sites in Manus and 27 sites in the Western Islands, Allison Green conducted 90-minute free-swim surveys between 0 and 30 meters depth, following Gerry Allen’s method, to complement the standard belt transects and enhance the assessment of reef fish diversity.\nThese surveys added a total of 44 species to Manus and 170 species to the Western Islands. As a result, the Western Islands recorded the highest total richness (biodiverisy + BLT surveys) with 464 reef fish species, followed by Manus (355 species), Lovongai (326 species), and Murat (275 species). The families contributing the most additional records were Pomacentridae (22 species), Labridae (17 species), and Apogonidae (13 species).\n\nManusWestern Islands\n\n\n\n\nCode\nlibrary(dplyr)\nlibrary(reactable)\nlibrary(reactablefmtr)\n\nnew_bio_obs |&gt;\n  filter(region == \"Manus\") |&gt;\n  select(family, taxon_valid_name, n_sites, rel_abundance_code) |&gt;\n  reactable(groupBy = \"family\",\n            searchable = TRUE,\n            pagination = TRUE,\n            defaultPageSize = 10,\n            striped = TRUE,\n            highlight = TRUE,\n            outlined = TRUE,\n            bordered = TRUE,\n            showPageSizeOptions = TRUE,\n            defaultSorted = list(n_sites = \"desc\"),\n            theme = custom_tbl_theme,\n            columns = list(taxon_valid_name   = colDef(name = \"Taxon Name\",\n                                                       align = \"left\",\n                                                       html = TRUE,\n                                                       cell = function(value) {paste0(\"&lt;i&gt;\", value, \"&lt;/i&gt;\")}),\n                           n_sites            = colDef(name = \"Number of Sites\", align = \"center\"),\n                           rel_abundance_code = colDef(name = \"Relative Abundance\", align = \"center\"))) |&gt; \n  add_title(\"Additional fish species observed\") |&gt; \n  add_subtitle(\"Manus\",\n               font_size = 20,\n               font_color = '#666666',\n               margin = reactablefmtr::margin(t=10,r=0,b=15,l=0))\n\n\nAdditional fish species observed\nManus\n\n\n\n\n\n\n\n\nCode\nnew_bio_obs |&gt;\n  filter(region == \"Western Islands\") |&gt;\n  select(family, taxon_valid_name, n_sites, rel_abundance_code) |&gt;\n  reactable(groupBy = \"family\",\n            searchable = TRUE,\n            pagination = TRUE,\n            defaultPageSize = 10,\n            striped = TRUE,\n            highlight = TRUE,\n            outlined = TRUE,\n            bordered = TRUE,\n            showPageSizeOptions = TRUE,\n            defaultSorted = list(n_sites = \"desc\"),\n            theme = custom_tbl_theme,\n            columns = list(taxon_valid_name   = colDef(name = \"Taxon Name\",\n                                                       align = \"left\",\n                                                       html = TRUE,\n                                                       cell = function(value) {paste0(\"&lt;i&gt;\", value, \"&lt;/i&gt;\")}),\n                           n_sites            = colDef(name = \"Number of Sites\", align = \"center\"),\n                           rel_abundance_code = colDef(name = \"Relative Abundance\", align = \"center\"))) |&gt; \n  add_title(\"Additional fish species observed\") |&gt; \n  add_subtitle(\"Western Islands\",\n               font_size = 20,\n               font_color = '#666666',\n               margin = reactablefmtr::margin(t=10,r=0,b=15,l=0))\n\n\nAdditional fish species observed\nWestern Islands"
  },
  {
    "objectID": "eda_lpi.html#model",
    "href": "eda_lpi.html#model",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.2 Model",
    "text": "2.2 Model\nWe modeled morphotaxon richness per station using a Poisson GLMM, accounting for region, depth strata, and exposure, with site as a random effect (ps_site_id). Effect sizes are presented as incidence rate ratios (IRR) (Table 2)\n\n\nCode\nlibrary(lme4)\nlibrary(lmerTest)\nlibrary(parameters)\n\n# Poisson GLMM with random intercept for site\nglmm_richness &lt;- glmer(richness ~ region + depth_strata + exposure  + (1 | ps_site_id),\n                       data = richness_by_station,\n                       family = poisson())\n\n#performance::check_overdispersion(glmm_richness)\n\nglmm_richness_performance &lt;- performance::model_performance(glmm_richness)\n\n\nmodel_summary &lt;- model_parameters(glmm_richness, exponentiate = TRUE) |&gt;  # Exponentiated coefficients (IRRs) tell you multiplicative effects on richness\n  filter(Effects == \"fixed\") |&gt; \n  mutate(across(c(Coefficient, SE, z, CI_low, CI_high), ~ round(.x, 2)),\n         `95% CI` = sprintf(\"[%.2f, %.2f]\", CI_low, CI_high),\n         p        = case_when(is.na(p)             ~ \"NA\",\n                              p &lt; 0.001            ~ \"&lt; .001\",\n                              TRUE                 ~ formatC(as.numeric(p), format = \"f\", digits = 3))) |&gt; \n  select(Parameter, IRR = Coefficient, SE, `95% CI`, z, `p-value` = p) \n\n\nThe Poisson GLMM revealed significant regional differences in benthic morphotaxon richness across surveyed reefs. Stations in Murat exhibited 23% lower richness compared to the baseline region, Lovongai, while Manus showed a 16% increase, suggesting higher taxonomic diversity in that area. No meaningful effects were detected for depth strata or exposure, indicating that richness patterns were primarily structured by regional differences rather than local environmental gradients. The estimated baseline richness under reference conditions was approximately 19 morphotaxa per station.\n\n\nCode\nclean_parameter_labels &lt;- function(param_vec) {\n  param_vec |&gt;\n    str_replace(\"^\\\\(Intercept\\\\)$\", \"Intercept (baseline)\") |&gt;\n    str_replace(\"^region\", \"Region: \") |&gt;\n    str_replace(\"^depth_strata\", \"Depth: \") |&gt;\n    str_replace(\"^exposure\", \"Exposure: \") |&gt;\n    str_replace_all(\"_\", \" \") |&gt;\n    str_to_sentence() \n  }\n\nmodel_summary |&gt; \n  mutate(Parameter = clean_parameter_labels(Parameter)) |&gt; \n  gt(rowname_col = \"Parameter\") |&gt; \n  tab_header(title = md(\"**Model Summary: Benthic Richness (Poisson GLMM)**\"),\n             subtitle = \"Fixed effects as incidence rate ratios (IRRs)\") |&gt;\n  tab_style( style = list(cell_fill(color = \"#f9f9f9\")),\n             locations = cells_body()) |&gt; \n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(columns = vars(`p-value`),\n                                   rows = `p-value` == \"&lt; .001\")) |&gt; \n  cols_align(align = \"center\") |&gt; \n  opt_row_striping() |&gt; \n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\nTable 2: Model summary of morphotaxon richness\n\n\n\n\n\n\n\n\n\nModel Summary: Benthic Richness (Poisson GLMM)\n\n\nFixed effects as incidence rate ratios (IRRs)\n\n\n\nIRR\nSE\n95% CI\nz\np-value\n\n\n\n\nIntercept (baseline)\n18.72\n2.17\n[14.91, 23.50]\n25.24\n&lt; .001\n\n\nRegion: murat\n0.77\n0.05\n[0.67, 0.88]\n-3.84\n&lt; .001\n\n\nRegion: manus\n1.16\n0.08\n[1.01, 1.33]\n2.06\n0.040\n\n\nRegion: western islands\n1.09\n0.07\n[0.96, 1.23]\n1.35\n0.176\n\n\nDepth: shallow\n0.99\n0.04\n[0.92, 1.07]\n-0.16\n0.874\n\n\nDepth: supershallow\n1.00\n0.12\n[0.79, 1.28]\n0.01\n0.995\n\n\nExposure: leeward\n1.10\n0.12\n[0.88, 1.37]\n0.83\n0.407\n\n\nExposure: windward\n1.07\n0.13\n[0.85, 1.35]\n0.60\n0.550\n\n\n\n\n\n\n\n\n\n\nThe model’s conditional R² (0.45) indicates that 45% of the variation in richness is explained by both fixed (region, depth, exposure) and random effects (site-level variation). The marginal R², representing variation explained by fixed effects alone, was 0.31.\n\nEstimated Marginal Means\nPairwise comparisons reveal that Murat consistently had lower benthic richness than the other regions, with significantly reduced richness compared to Lovongai, Manus, and the Western Islands (p &lt; .001 in all cases)(Table 3). In contrast, richness differences among Lovongai, Manus, and Western Islands were not statistically significant, suggesting broadly comparable community diversity across these regions.\n\n\nCode\nlibrary(emmeans)\n\nemm_region &lt;- emmeans(glmm_richness, ~ region, type = \"response\")\n\npairs_region &lt;- pairs(emm_region, adjust = \"tukey\")\n\nsummary(pairs_region) |&gt;\n  as_tibble() |&gt;\n  mutate(ratio      = round(ratio, 2),\n         SE         = round(SE, 2),\n         z.ratio    = round(z.ratio, 2),\n         p.value    = case_when(\n           is.na(p.value) ~ \"NA\",\n           p.value &lt; 0.001 ~ \"&lt; .001\",\n           TRUE ~ formatC(p.value, format = \"f\", digits = 3))) |&gt; \n  select(contrast, ratio, SE, z.ratio, p.value) |&gt; \n  gt() |&gt; \n  tab_header(\n    title = md(\"**Pairwise Regional Comparisons: Benthic Richness**\"),\n    subtitle = \"Tukey-adjusted incidence rate ratios (IRRs)\"\n  ) |&gt;\n  tab_style(\n    style = list(cell_fill(color = \"#f9f9f9\")),\n    locations = cells_body()\n  ) |&gt;\n  tab_style(\n    style = cell_text(weight = \"bold\", color = \"black\"),\n    locations = cells_body(columns = vars(`p.value`), rows = `p.value` == \"&lt; .001\")\n  ) |&gt;\n  cols_align(align = \"center\") |&gt;\n  opt_row_striping() |&gt;\n  tab_options(\n    table.font.size = \"small\",\n    row.striping.include_table_body = TRUE,\n    table.border.top.color = \"white\",\n    table.border.bottom.color = \"white\",\n    heading.title.font.size = 16,\n    heading.subtitle.font.size = 13,\n    row.striping.background_color = \"#f0f0f0\",\n    column_labels.font.weight = \"bold\"\n  )\n\n\n\n\nTable 3: Pairwise regional comparisons of benthic richness\n\n\n\n\n\n\n\n\n\nPairwise Regional Comparisons: Benthic Richness\n\n\nTukey-adjusted incidence rate ratios (IRRs)\n\n\ncontrast\nratio\nSE\nz.ratio\np.value\n\n\n\n\nLovongai / Murat\n1.30\n0.09\n3.84\n&lt; .001\n\n\nLovongai / Manus\n0.86\n0.06\n-2.06\n0.167\n\n\nLovongai / Western Islands\n0.92\n0.06\n-1.35\n0.529\n\n\nMurat / Manus\n0.66\n0.04\n-6.06\n&lt; .001\n\n\nMurat / Western Islands\n0.71\n0.04\n-5.95\n&lt; .001\n\n\nManus / Western Islands\n1.07\n0.06\n1.06\n0.715\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Estimated marginal means by region\n\nemm_region |&gt; \n  cld(adjust = \"tukey\", Letters = letters, alpha = 0.05) |&gt; \n  ggplot(aes(x = reorder(region, rate), y = rate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2, color = \"#065A82\")+\n  geom_text(aes(label = .group), vjust = -1, hjust = 0.05, size = 5, fontface = \"bold\")+\n  labs(title = \"Estimated Species Richness by Region\",\n       subtitle = \"Letters indicate groups that are not significantly different (Tukey-adjusted, α = 0.05)\",\n       x = NULL,\n       y = \"Estimated richness (± 95% CI)\") +\n  expand_limits(y = 0)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\n\n\n\nDid we sample enough?\nTo assess how benthic morphotaxon richness accumulates with increasing sampling effort, we generated species accumulation curves for each region based on presence-weighted morphotaxon cover data (Figure 5). These curves visualize how the number of unique morphotaxa increases as additional stations are sampled, providing insight into both regional diversity and sampling completeness. The shaded bands reflect variability among sites, giving an indication of habitat heterogeneity and community turnover within regions.\n\n\nCode\nlibrary(vegan)\n\n# Species matrix with one row per station × region\ntaxa_cover_matrix &lt;- cover_by_station_and_taxa |&gt; \n  left_join(lpi_stations |&gt; distinct(ps_station_id, region), by = \"ps_station_id\") |&gt; \n  filter(contacts &gt; 0) |&gt; \n  select(region, ps_station_id, morphotaxon, contacts) |&gt; \n  pivot_wider(id_cols = c(region, ps_station_id),\n              names_from = morphotaxon,\n              values_from = contacts,\n              values_fill = list(contacts = 0) )\n\n# 1. Nest species matrix by region\n\ntaxa_nested &lt;- taxa_cover_matrix |&gt; \n  group_by(region) |&gt; \n  nest()\n\n# 2. Compute specaccum per region\naccum_curves &lt;- taxa_nested |&gt; \n  mutate(\n    acc = map(data, ~ specaccum(select(.x, where(is.numeric)), method = \"random\")),\n    curve = map(acc, ~ tibble(\n      station_number = .x$sites,\n      richness = .x$richness,\n      sd = .x$sd\n    ))\n  ) |&gt; \n  select(region, curve) |&gt; \n  unnest(curve)\n\n# 3. Plot\nggplot(accum_curves, aes(x = station_number, y = richness, color = region, fill = region)) +\n  geom_line(linewidth = 1) +\n  geom_ribbon(aes(ymin = richness - sd, ymax = richness + sd), alpha = 0.2, color = NA) +\n  labs(title = \"Morphotaxa Accumulation Curves by Region\",\n       x = \"Number of Stations\",\n       y = \"Accumulated Morphotaxa Richness\") +\n  theme(legend.position = \"bottom\")+\n  labs(fill = \"\", col = \"\")\n\n\n\n\n\n\n\n\nFigure 5: Morphotaxa accumulation curves by region\n\n\n\n\n\nSpecies accumulation patterns reveal marked regional differences in benthic diversity. Manus and Western Islands stand out as the most species-rich and heterogeneous, with curves that continue to rise and broad confidence bands. Lovongai shows moderate richness and appears to be more completely sampled, while Murat exhibits the lowest richness and least variability. Together, these curves provide a baseline for comparing biodiversity across regions and evaluating the sufficiency of sampling efforts."
  },
  {
    "objectID": "eda_lpi.html#did-we-sample-enough",
    "href": "eda_lpi.html#did-we-sample-enough",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.2 Did we sample enough?",
    "text": "2.2 Did we sample enough?\nTo assess how benthic morphotaxon richness accumulates with increasing sampling effort, we generated species accumulation curves for each region based on presence-weighted morphotaxon cover data (Figure 5). These curves visualize how the number of unique morphotaxa increases as additional stations are sampled, providing insight into both regional diversity and sampling completeness. The shaded bands reflect variability among sites, giving an indication of habitat heterogeneity and community turnover within regions.\n\n\nCode\nlibrary(vegan)\n\n# Species matrix with one row per station × region\ntaxa_cover_matrix &lt;- cover_by_station_and_taxa |&gt; \n  left_join(lpi_stations |&gt; distinct(ps_station_id, region), by = \"ps_station_id\") |&gt; \n  filter(contacts &gt; 0) |&gt; \n  select(region, ps_station_id, morphotaxon, contacts) |&gt; \n  pivot_wider(id_cols = c(region, ps_station_id),\n              names_from = morphotaxon,\n              values_from = contacts,\n              values_fill = list(contacts = 0) )\n\n# 1. Nest species matrix by region\n\ntaxa_nested &lt;- taxa_cover_matrix |&gt; \n  group_by(region) |&gt; \n  nest()\n\n# 2. Compute specaccum per region\naccum_curves &lt;- taxa_nested |&gt; \n  mutate(\n    acc = map(data, ~ specaccum(select(.x, where(is.numeric)), method = \"random\")),\n    curve = map(acc, ~ tibble(\n      station_number = .x$sites,\n      richness = .x$richness,\n      sd = .x$sd\n    ))\n  ) |&gt; \n  select(region, curve) |&gt; \n  unnest(curve)\n\n# 3. Plot\nggplot(accum_curves, aes(x = station_number, y = richness, color = region, fill = region)) +\n  geom_line(linewidth = 1) +\n  geom_ribbon(aes(ymin = richness - sd, ymax = richness + sd), alpha = 0.2, color = NA) +\n  labs(title = \"Species Accumulation Curves by Region\",\n       x = \"Number of Stations\",\n       y = \"Accumulated Species Richness\") +\n  theme(legend.position = \"bottom\")+\n  labs(fill = \"\", col = \"\")\n\n\n\n\n\n\n\n\nFigure 5: Species accumulation curves by region\n\n\n\n\n\nSpecies accumulation patterns reveal marked regional differences in benthic diversity. Manus and Western Islands stand out as the most species-rich and heterogeneous, with curves that continue to rise and broad confidence bands. Lovongai shows moderate richness and appears to be more completely sampled, while Murat exhibits the lowest richness and least variability. Together, these curves provide a baseline for comparing biodiversity across regions and evaluating the sufficiency of sampling efforts."
  },
  {
    "objectID": "eda_lpi.html#visualize",
    "href": "eda_lpi.html#visualize",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.1 Visualize",
    "text": "2.1 Visualize\n\n\nCode\nrichness_by_station &lt;- lpi_observations |&gt;\n  group_by(ps_station_id) |&gt;\n  summarise(richness = n_distinct(morphotaxon[contacts &gt; 0]), .groups = \"drop\") |&gt;\n  left_join(lpi_stations, by = \"ps_station_id\") |&gt; \n  mutate(region = factor(region, levels = region_order))\n\n\n\nRegionDepth strataDiver\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = region, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa Richness by Region\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 2: Morphotaxa richness by region\n\n\n\n\n\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = depth_strata, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa Richness by strata\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 3: Morphotaxa richnnes by depth\n\n\n\n\n\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = diver, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa richness by diver\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 4: Morphotaxa richnnes by diver"
  },
  {
    "objectID": "eda_lpi.html#by-morphotaxa",
    "href": "eda_lpi.html#by-morphotaxa",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "4.1 By morphotaxa",
    "text": "4.1 By morphotaxa\n\nPERMANOVA\n\n\nCode\n# 1. Create community matrix (stations × morphotaxa)\n\ncover_matrix &lt;- cover_by_station_and_taxa |&gt;\n  select(ps_station_id, morphotaxon, pct_cover) |&gt;\n  pivot_wider(names_from = morphotaxon, values_from = pct_cover, values_fill = 0) |&gt;\n  column_to_rownames(\"ps_station_id\")\n\n# 2. Prepare station metadata\nstation_meta &lt;- lpi_stations |&gt;\n  select(ps_station_id, region, habitat, depth_strata, exposure)\n\n# 3. ADONIC\n\nadonis_by_taxa &lt;- adonis2(cover_matrix ~ region + depth_strata + habitat + exposure, \n                           data = station_meta,\n                           method = \"bray\",\n                           permutations = 999,\n                           by = \"margin\")\n\nadonis_by_taxa_tbl &lt;- broom::tidy(adonis_by_taxa) |&gt; \n  mutate(p_value = case_when(is.na(p.value)   ~ NA_character_,\n                             p.value &lt;= 0.001 ~ \"&lt; .001\",\n                             TRUE             ~ formatC(p.value, format = \"f\", digits = 3)),\n         across(c(R2, statistic, SumOfSqs), ~ round(.x, 3))) |&gt; \n  select(term, df, sumsq = SumOfSqs, r2 = R2, stat = statistic, p_value)\n\n\nTo test for differences in benthic community composition, we ran a PERMANOVA (adonis2) using Bray-Curtis dissimilarities derived from morphotaxa percent cover. The model included region, depth_strata, habitat, and exposure as predictors (Table 5).\nSignificant variation was detected by region (r2 = 18.4%, p = &lt; .001), depth strata (r2 = 2.6%, p = 0.002), and exposure (r2 = 2.6%, p = 0.002), while habitat was not significant.\nOverall, the model explained 26.7% of the total variance in benthic community composition.\n\n\nCode\n# Continue from your adonis_tbl\nadonis_by_taxa_tbl |&gt; \n  select(Term = term, Df = df, `Sum of Squares` = sumsq, `R²` = r2, `F-value` = stat, `p-value` = p_value) |&gt; \n  gt(rowname_col = \"Term\") |&gt; \n  tab_header(title = md(\"**PERMANOVA Results: Benthic Community Composition**\"),\n             subtitle = \"Bray-Curtis dissimilarity | 999 permutations\") |&gt; \n  tab_style(style = list(cell_fill(color = \"#f9f9f9\")),\n            locations = cells_body()) |&gt; \n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(columns = c(`p-value`), rows = `p-value` == \"&lt; .001\")) |&gt; \n  cols_align(align = \"center\",\n             columns = everything()) |&gt; \n  opt_row_striping() |&gt; \n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\nTable 5: PERMANOVA results for benthic community composition by functional group (Bray-Curtis dissimilarities)\n\n\n\n\n\n\n\n\n\nPERMANOVA Results: Benthic Community Composition\n\n\nBray-Curtis dissimilarity | 999 permutations\n\n\n\nDf\nSum of Squares\nR²\nF-value\np-value\n\n\n\n\nregion\n3\n5.611\n0.184\n12.199\n&lt; .001\n\n\ndepth_strata\n2\n0.809\n0.026\n2.637\n0.002\n\n\nhabitat\n3\n0.513\n0.017\n1.116\n0.296\n\n\nexposure\n2\n0.781\n0.026\n2.548\n0.002\n\n\nResidual\n146\n22.385\n0.733\nNA\nNA\n\n\nTotal\n156\n30.542\n1.000\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\n\nOrdination\n\n\nCode\n# 3. NMDS ordination (2D)\nnmds_by_taxa &lt;- suppressMessages(\n  metaMDS(cover_matrix,\n          distance = \"bray\",\n          k = 3,\n          trymax = 100,\n          autotransform = FALSE,\n          noshare = TRUE,\n          trace = 0))\n\n# 4. Fit morphotaxon vectors to NMDS\nenvfit_by_taxa &lt;- envfit(nmds_by_taxa,\n                      cover_matrix,\n                      permutations = 999)\n\n# 5. Extract significant morphotaxon vectors (p &lt; 0.05 and r² &gt; 0.3)\nnmds_taxa_vectors &lt;- scores(envfit_by_taxa, display = \"vectors\") |&gt;\n  as.data.frame() |&gt;\n  rownames_to_column(\"morphotaxon\") |&gt;\n  mutate(pval = envfit_by_taxa$vectors$pvals[morphotaxon],\n         r2   = envfit_by_taxa$vectors$r[morphotaxon]) |&gt;\n  filter(pval &lt; 0.05, r2 &gt; 0.3)\n\n# 6. NMDS site scores + metadata\nnmds_by_taxa_sites &lt;- scores(nmds_by_taxa, display = \"sites\") |&gt;\n  as.data.frame() |&gt;\n  rownames_to_column(var = \"ps_station_id\") |&gt;\n  left_join(station_meta, by = \"ps_station_id\")\n\n\nWe followed with a 2D NMDS (stress = 0.138) to visualize spatial patterns in community structure. Points represent individual stations, colored by region and shaped by depth stratum. Overlaid ellipses capture 75% confidence contours for each region.\n\n\nCode\nggplot() +\n  geom_point(data = nmds_by_taxa_sites,\n             aes(x = NMDS1, y = NMDS2, color = region, shape = depth_strata),\n             size = 3, alpha = 0.9) +\n  geom_segment(data = nmds_taxa_vectors,\n               aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),\n               arrow = arrow(length = unit(0.25, \"cm\")),\n               color = \"gray40\", linewidth = 0.8) +\n  geom_text_repel(data = nmds_taxa_vectors,\n                  aes(x = NMDS1, y = NMDS2, label = morphotaxon),\n                  size = 3, color = \"gray20\",\n                  segment.color = \"grey50\",\n                  max.overlaps = 15, min.segment.length = 0) +\n  stat_ellipse(data = nmds_by_taxa_sites,\n               aes(x = NMDS1, y = NMDS2, group = region, color = region),\n               linetype = \"dashed\", level = 0.75, linewidth = 0.6) +\n  labs(title = \"NMDS Ordination of Benthic Community Structure\",\n       subtitle = glue::glue(\"Bray-Curtis dissimilarity | Stress = {round(nmds_by_taxa$stress, 3)}\"),\n       caption = \"Arrows show morphotaxa significantly correlated with NMDS axes (p &lt; 0.05, R² &gt; 0.3).\\nArrow length reflects correlation strength.\",\n       x = \"NMDS Axis 1\", \n       y = \"NMDS Axis 2\",\n       color = \"\", \n       shape = \"\") +\n  coord_equal() +\n  theme(legend.position = \"right\",\n        legend.box = \"vertical\",\n        plot.title = element_text(face = \"bold\", size = 16),\n        plot.subtitle = element_text(size = 13),\n        plot.caption = element_text(size = 10, hjust = 0),\n        axis.title = element_text(face = \"bold\")) +\n  scale_color_manual(values = region_palette)\n\n\n\n\n\n\n\n\nFigure 8: NMDS Ordination of Benthic Community Structure"
  },
  {
    "objectID": "eda_lpi.html#by-functional-group",
    "href": "eda_lpi.html#by-functional-group",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "4.2 By functional group",
    "text": "4.2 By functional group\nTo simplify community structure and relate it to ecological function, we grouped morphotaxa into benthic functional categories (e.g., hard coral, turf, CCA, cyanobacteria). This approach facilitates interpretation, especially for reef health and management applications.\n\nCover\n\n\nCode\n# 1. Get average cover by functional group and subregion\n\nfunc_cover_by_station &lt;- cover_by_station_and_taxa |&gt; \n  group_by(ps_station_id, functional_group) |&gt; \n  summarize(contacts = sum(contacts), .groups = \"drop\") |&gt; \n  group_by(ps_station_id) |&gt; \n  mutate(pct_cover = round(contacts / sum(contacts) * 100, 3)) \n  \nfunc_cover_by_subregion &lt;- func_cover_by_station |&gt; \n  left_join(lpi_stations |&gt; \n              distinct(ps_station_id, region, subregion)) |&gt; \n  group_by(region, subregion, functional_group) |&gt;\n  summarize(n_stations =  n_distinct(ps_station_id),\n            avg_cover = mean(pct_cover, na.rm = TRUE), .groups = \"drop\") |&gt; \n  mutate(functional_group = factor(functional_group, levels = functional_group_order)) \n\nfunc_cover_by_subregion |&gt; \n  group_by(subregion) |&gt; \n  mutate(avg_cover_rescaled = avg_cover / sum(avg_cover) * 100) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover_rescaled, fill = functional_group))+\n  geom_col()+\n  scale_fill_manual(values = functional_palette)+\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\")+\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")+\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % Cover by Functional Group and Subregion\",\n       fill = \"\")\n\n\n\n\n\n\n\n\nFigure 9: Average Cover by Functional Group and Subregion\n\n\n\n\n\n\n\nCode\nfunc_cover_by_region &lt;- func_cover_by_station |&gt; \n  left_join(lpi_stations |&gt; \n              distinct(ps_station_id, region, subregion)) |&gt; \n  group_by(region, functional_group) |&gt;\n  summarize(n_stations =  n_distinct(ps_station_id),\n            avg_cover = mean(pct_cover, na.rm = TRUE), .groups = \"drop\") |&gt; \n  mutate(functional_group = factor(functional_group, levels = functional_group_order),\n         label_pct = paste0(round(avg_cover, 1), \"%\"))\n\n# Pie chart by region with percent labels\n\nfunc_cover_by_region |&gt; \n  group_by(region) |&gt; \n  mutate(avg_cover = avg_cover / sum(avg_cover) * 100) |&gt; \n  ggplot(aes(x = \"\", y = avg_cover, fill = functional_group)) +\n  geom_col(width = 1, color = \"white\") +\n  coord_polar(theta = \"y\") +\n  facet_wrap(~region, ncol = 2) +\n  scale_fill_manual(values = functional_palette) +\n  geom_text(aes(label = ifelse(avg_cover &gt; 4, label_pct, \"\")),  # hide labels &lt; 4% for clarity\n            position = position_stack(vjust = 0.5),\n            size = 3.5,\n            color = \"white\",\n            fontface = \"bold\") +\n  labs(title = \"Relative Benthic Cover by Functional Group\",\n       subtitle = \"Average % cover per region\",\n       fill = \"\",\n       x = NULL,\n       y = NULL) +\n  theme_void(base_size = 14) +\n  theme(strip.text = element_text(face = \"bold\", size = 14),\n        plot.title = element_text(face = \"bold\", size = 16, hjust = 0.5),\n        plot.subtitle = element_text(size = 13, hjust = 0.5),\n        legend.position = \"bottom\",\n        legend.title = element_text(face = \"bold\"),\n        legend.key.size = unit(0.4, \"cm\"),\n        legend.text = element_text(size = 11))\n\n\n\n\n\n\n\n\nFigure 10: Average Cover by Functional Group and Region\n\n\n\n\n\n\n\nPERMANOVA\n\n\nCode\n# 1. Create community matrix (stations × morphotaxa)\nfunc_cover_matrix &lt;- func_cover_by_station |&gt;\n  select(ps_station_id, functional_group, pct_cover) |&gt;\n  pivot_wider(names_from = functional_group, values_from = pct_cover, values_fill = 0) |&gt;\n  column_to_rownames(\"ps_station_id\")\n\n# 2. Prepare station metadata\nstation_meta &lt;- lpi_stations |&gt;\n  select(ps_station_id, region, habitat, depth_strata, exposure)\n\n# 3. PERMANOVA\n\nadonis_func &lt;- adonis2(func_cover_matrix ~ region + depth_strata + habitat + exposure, \n                           data = station_meta,\n                           method = \"bray\",\n                           permutations = 999,\n                           by = \"margin\")\n\nadonis_func_tbl &lt;- broom::tidy(adonis_func) |&gt; \n  mutate(p_value = case_when(is.na(p.value)   ~ NA_character_,\n                             p.value &lt;= 0.001 ~ \"&lt; .001\",\n                             TRUE             ~ formatC(p.value, format = \"f\", digits = 3)),\n         across(c(R2, statistic, SumOfSqs), ~ round(.x, 3))) |&gt; \n  select(term, df, sumsq = SumOfSqs, r2 = R2, stat = statistic, p_value)\n\n\nTo test for differences in benthic community composition, we ran a PERMANOVA (adonis2) using Bray-Curtis dissimilarities derived from functional group percent cover. The model included region, depth_strata, habitat, and exposure as predictors.\nSignificant variation was detected by region (r2 = 13.2%, p = &lt; .001), depth strata (r2 = 3.8%, p = &lt; .001), and exposure (r2 = 3.5%, p = &lt; .001), while habitat was not significant.\nOverall, the model explained 23.2% of the total variance in benthic community composition.\n\n\nCode\n# Continue from your adonis_tbl\nadonis_func_tbl |&gt; \n  select(Term = term, Df = df, `Sum of Squares` = sumsq, `R²` = r2, `F-value` = stat, `p-value` = p_value) |&gt; \n  gt(rowname_col = \"Term\") |&gt; \n  tab_header(title = md(\"**PERMANOVA Results: Benthic Community Composition**\"),\n             subtitle = \"Bray-Curtis dissimilarity | 999 permutations\") |&gt; \n  tab_style(style = list(cell_fill(color = \"#f9f9f9\")),\n            locations = cells_body()) |&gt; \n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(columns = c(`p-value`), rows = `p-value` == \"&lt; .001\")) |&gt; \n  cols_align(align = \"center\",\n             columns = everything()) |&gt; \n  opt_row_striping() |&gt; \n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\nTable 6: PERMANOVA results for benthic community composition by functional group (Bray-Curtis dissimilarities)\n\n\n\n\n\n\n\n\n\nPERMANOVA Results: Benthic Community Composition\n\n\nBray-Curtis dissimilarity | 999 permutations\n\n\n\nDf\nSum of Squares\nR²\nF-value\np-value\n\n\n\n\nregion\n3\n2.415\n0.132\n8.384\n&lt; .001\n\n\ndepth_strata\n2\n0.688\n0.038\n3.585\n&lt; .001\n\n\nhabitat\n3\n0.323\n0.018\n1.122\n0.290\n\n\nexposure\n2\n0.634\n0.035\n3.305\n&lt; .001\n\n\nResidual\n146\n14.016\n0.768\nNA\nNA\n\n\nTotal\n156\n18.259\n1.000\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\n\nOrdination\n\n\nCode\n# 3. NMDS ordination (2D)\nnmds_func &lt;- suppressMessages(\n  metaMDS(func_cover_matrix,\n          distance = \"bray\",\n          k = 3,\n          trymax = 100,\n          autotransform = FALSE,\n          noshare = TRUE,\n          trace = 0))\n\n# 4. Fit functional_group vectors to NMDS\nenvfit_func &lt;- envfit(nmds_func,\n                      func_cover_matrix,\n                      permutations = 999)\n\n# 5. Extract significant functional_group vectors (p &lt; 0.05 and r² &gt; 0.3)\nnmds_func_vectors &lt;- scores(envfit_func, display = \"vectors\") |&gt;\n  as.data.frame() |&gt;\n  rownames_to_column(\"functional_group\") |&gt;\n  mutate(pval = envfit_func$vectors$pvals[functional_group],\n         r2   = envfit_func$vectors$r[functional_group]) |&gt;\n  filter(pval &lt; 0.05, r2 &gt; 0.3)\n\n# 6. NMDS site scores + metadata\nnmds_func_sites &lt;- scores(nmds_func, display = \"sites\") |&gt;\n  as.data.frame() |&gt;\n  rownames_to_column(var = \"ps_station_id\") |&gt;\n  left_join(station_meta, by = \"ps_station_id\")\n\n\nWe followed with a 2D NMDS (stress = 0.12) to visualize spatial patterns in community structure. Points represent individual stations, colored by region and shaped by depth stratum. Overlaid ellipses capture 75% confidence contours for each region.\n\n\nCode\nggplot() +\n  geom_point(data = nmds_func_sites,\n             aes(x = NMDS1, y = NMDS2, color = region, shape = depth_strata),\n             size = 3, alpha = 0.9) +\n  geom_segment(data = nmds_func_vectors,\n               aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),\n               arrow = arrow(length = unit(0.25, \"cm\")),\n               color = \"gray40\", linewidth = 0.8) +\n  geom_text_repel(data = nmds_func_vectors,\n                  aes(x = NMDS1, y = NMDS2, label = functional_group),\n                  size = 3, color = \"gray20\",\n                  segment.color = \"grey50\",\n                  max.overlaps = 15, min.segment.length = 0) +\n  stat_ellipse(data = nmds_func_sites,\n               aes(x = NMDS1, y = NMDS2, group = region, color = region),\n               linetype = \"dashed\", level = 0.75, linewidth = 0.6) +\n  labs(title = \"NMDS Ordination of Benthic Community Structure\",\n       subtitle = glue::glue(\"Bray-Curtis dissimilarity | Stress = {round(nmds_func$stress, 3)}\"),\n       caption = \"Arrows show functional groups significantly correlated with NMDS axes (p &lt; 0.05, R² &gt; 0.3).\\nArrow length reflects correlation strength.\",\n       x = \"NMDS Axis 1\", \n       y = \"NMDS Axis 2\",\n       color = \"\", \n       shape = \"\") +\n  coord_equal() +\n  theme(legend.position = \"right\",\n        legend.box = \"vertical\",\n        plot.title = element_text(face = \"bold\", size = 16),\n        plot.subtitle = element_text(size = 13),\n        plot.caption = element_text(size = 10, hjust = 0),\n        axis.title = element_text(face = \"bold\")) +\n  scale_color_manual(values = region_palette)\n\n\n\n\n\n\n\n\nFigure 11: NMDS Ordination of Benthic Community Structure by Functional Group\n\n\n\n\n\nEnvfit vectors show morphotaxa significantly associated with community structure (p &lt; 0.05, R² &gt; 0.3), offering insight into the dominant ecological drivers."
  },
  {
    "objectID": "eda_lpi.html#patterns",
    "href": "eda_lpi.html#patterns",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.1 Patterns",
    "text": "2.1 Patterns\nWe begin by visualizing benthic morphotaxa richness across stations, stratified by environmental variables. These exploratory plots, generated with ggbetweenstats, reveal variability and suggest potential differences across groups such as regions, depth strata, and divers.\nWhile informative, these initial comparisons do not adjust for confounding factors or site-level random effects. To formally test the significance of environmental predictors on richness, we fit a generalized linear mixed model (GLMM) in the next section.\n\n\nCode\nrichness_by_station &lt;- lpi_observations |&gt;\n  group_by(ps_station_id) |&gt;\n  summarise(richness = n_distinct(morphotaxon[contacts &gt; 0]), .groups = \"drop\") |&gt;\n  left_join(lpi_stations, by = \"ps_station_id\") |&gt; \n  mutate(region = factor(region, levels = region_order))\n\n\n\nRegionDepth strataDiver\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = region, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa Richness by Region\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 4: Morphotaxa richness by region\n\n\n\n\n\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = depth_strata, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa Richness by strata\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 5: Morphotaxa richnnes by depth\n\n\n\n\n\n\n\n\n\nCode\nggstatsplot::ggbetweenstats(data = richness_by_station, \n                            x = diver, \n                            y = richness, \n                            mean.ci = TRUE,\n                            pairwise.comparisons = TRUE,\n                            p.adjust.method = \"holm\",\n                            type = \"nonparametric\",\n                            title = \"Morphotaxa richness by diver\", \n                            xlab = \"\", ylab = \"Number of morphotaxa per station\")\n\n\n\n\n\n\n\n\nFigure 6: Morphotaxa richnnes by diver"
  },
  {
    "objectID": "eda_lpi.html#statistical-model",
    "href": "eda_lpi.html#statistical-model",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.2 Statistical model",
    "text": "2.2 Statistical model\n\n\nCode\nlibrary(lme4)\nlibrary(lmerTest)\nlibrary(parameters)\n\n# Poisson GLMM with random intercept for site\nglmm_richness &lt;- glmer(richness ~ region + depth_strata + exposure + habitat + (1 | subregion),\n                       data = richness_by_station,\n                       family = poisson())\n\n#performance::check_overdispersion(glmm_richness)\n\nglmm_richness_performance &lt;- performance::model_performance(glmm_richness)\n\n\nTo formally evaluate how benthic morphotaxon richness varies across environmental gradients, we fit generalized linear mixed models (GLMMs) with a Poisson distribution. Richness, expressed as the count of distinct morphotaxa per station, is modeled as a function of region, depth strata, exposure and habitat.\nGiven the spatial structure of the sampling design, we include subregion (island) as a random intercept to account for spatial clustering and shared environmental context. Stations within the same subregion are more likely to be ecologically similar, and subregions represent meaningful ecological units across the study area.\nThis modeling approach allows us to test for overall effects of environmental gradients while accounting for non-independence among stations, thus producing more robust estimates of richness patterns.\n\n\nCode\nclean_parameter_labels &lt;- function(param_vec) {\n  param_vec |&gt; \n    str_replace(\"^\\\\(Intercept\\\\)$\", \"Intercept (baseline)\") |&gt; \n    str_replace(\"^region\", \"Region: \") |&gt; \n    str_replace(\"^depth_strata\", \"Depth: \") |&gt; \n    str_replace(\"^exposure\", \"Exposure: \") |&gt; \n    str_replace(\"^habitat\", \"Habitat: \") |&gt; \n    str_replace_all(\"_\", \" \") |&gt; \n    str_to_sentence()\n}\n\nglmm_richness_params &lt;- model_parameters(glmm_richness, exponentiate = TRUE) |&gt; \n  filter(Effects == \"fixed\") |&gt; \n  mutate(Parameter = clean_parameter_labels(Parameter),\n         across(c(Coefficient, SE, z, CI_low, CI_high), ~ round(.x, 2)),\n         `95% CI` = sprintf(\"[%.2f, %.2f]\", CI_low, CI_high),\n         p_raw = p,\n         `p-value` = case_when(\n           is.na(p)      ~ \"NA\",\n           p &lt; 0.001     ~ \"&lt; .001\",\n           TRUE          ~ formatC(as.numeric(p), format = \"f\", digits = 3))) |&gt;\n  select(Parameter, IRR = Coefficient, SE, `95% CI`, z, `p-value`, p_raw)\n\nglmm_richness_params |&gt; \n  gt(rowname_col = \"Parameter\") |&gt;\n  tab_header(title = md(\"**GLMM Results: Predictors of Benthic Richness**\"),\n             subtitle = \"Poisson GLMM with subregion random effect (n = 157 stations)\") |&gt;\n  fmt_number(columns = c(IRR, SE, z),\n             decimals = 2) |&gt;\n  tab_style(style = list(cell_text(weight = \"bold\")),\n            locations = cells_body(\n              columns = everything(),\n              rows = p_raw &lt; 0.05)) |&gt;\n  cols_hide(columns = c(p_raw)) |&gt;\n  cols_align(align = \"center\") |&gt;\n  opt_row_striping() |&gt;\n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\nTable 3: Model summary of morphotaxon richness\n\n\n\n\n\n\n\n\n\nGLMM Results: Predictors of Benthic Richness\n\n\nPoisson GLMM with subregion random effect (n = 157 stations)\n\n\n\nIRR\nSE\n95% CI\nz\np-value\n\n\n\n\nIntercept (baseline)\n20.65\n2.42\n[16.40, 25.99]\n25.78\n&lt; .001\n\n\nRegion: murat\n0.75\n0.07\n[0.62, 0.91]\n−2.89\n0.004\n\n\nRegion: manus\n1.16\n0.12\n[0.95, 1.41]\n1.43\n0.153\n\n\nRegion: western islands\n1.05\n0.09\n[0.88, 1.25]\n0.54\n0.591\n\n\nDepth: shallow\n0.99\n0.04\n[0.92, 1.06]\n−0.35\n0.723\n\n\nDepth: supershallow\n0.90\n0.12\n[0.69, 1.18]\n−0.77\n0.442\n\n\nExposure: leeward\n1.12\n0.32\n[0.64, 1.97]\n0.39\n0.696\n\n\nExposure: windward\n1.12\n0.33\n[0.63, 1.98]\n0.38\n0.704\n\n\nHabitat: channel\n0.77\n0.27\n[0.39, 1.55]\n−0.73\n0.468\n\n\nHabitat: fore reef\n0.89\n0.25\n[0.52, 1.53]\n−0.43\n0.670\n\n\nHabitat: patch reef\n1.08\n0.30\n[0.62, 1.87]\n0.27\n0.790\n\n\n\n\n\n\n\n\n\n\nThe Poisson GLMM revealed a significant effect of region on benthic morphotaxa richness (p = 0.004 for Murat vs. Lovongai). Stations in the Murat region had significantly lower richness than those in Lovongai, with an estimated reduction of about 25% on the log scale. Differences for Manus and the Western Islands were not statistically significant. No clear effects were detected for depth strata, exposure, or habitat (p &gt; 0.1 for all). Subregion-level random effects were small (variance = 0.013), indicating limited additional clustering beyond fixed regional differences. The estimated baseline richness under reference conditions was approximately 20 morphotaxa per station.\nThe model’s conditional R² (0.46) indicates that 46 % of the variation in richness is explained by both fixed (region, depth, exposure) and random effects (site-level variation). The marginal R², representing variation explained by fixed effects alone, was 0.32.\n\nMarginal Means\nTo better understand regional differences in benthic richness, we compare the observed mean richness per region to model‐estimated means from the Poisson GLMM. While observed means provide a direct summary of the data, GLMM predictions account for other covariates and random effects, offering a standardized comparison across regions.\n\n\nCode\nlibrary(emmeans)\n\n# 1. Predicted means\nemm_region &lt;- emmeans(glmm_richness, ~ region, type = \"response\") |&gt; \n  as_tibble() |&gt; \n  rename(mean_pred = rate,\n         lower.CL = asymp.LCL,\n         upper.CL = asymp.UCL)\n\n# 2. Observed means\nobs_region &lt;- richness_by_station |&gt;\n  group_by(region) |&gt;\n  summarise(mean_obs = mean(richness, na.rm = TRUE),\n            median_obs = median(richness, na.rm = TRUE),\n            n_stations = n(),\n            .groups = \"drop\")\n\n# 3. Merge\nrichness_summary &lt;- left_join(obs_region, emm_region, by = \"region\")\n\n# 4. Compact letter display (groupings)\ngroup_letters &lt;- cld(emmeans(glmm_richness, ~ region, type = \"response\"),\n                     adjust = \"tukey\", Letters = letters, alpha = 0.05) |&gt; \n  as_tibble() |&gt; \n  select(region, .group)\n\nrichness_summary &lt;- left_join(richness_summary, group_letters, by = \"region\")\n\nlibrary(ggtext)  # for geom_richtext\n\nrichness_summary |&gt; \n  mutate(mean_obs_label  = round(mean_obs, 1),\n         mean_pred_label = round(mean_pred, 1),\n         label_text = paste0(\"&lt;span style='color:gray30;'&gt;**Obs:** \", mean_obs_label, \"&lt;/span&gt;&lt;br&gt;\",\n                              \"&lt;span style='color:white;'&gt;**Pred:** \", mean_pred_label, \"&lt;/span&gt;\")) |&gt; \n  ggplot(aes(x = fct_reorder(region, mean_obs))) +\n  # Bars for observed mean richness, colored by region\n  geom_col(aes(y = mean_obs, fill = region), width = 0.6, color = \"gray30\") +\n  # Error bars for predicted mean ± 95% CI\n  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), color = \"gray30\",\n                width = 0.15, size = 0.8) +\n  # Points for predicted mean richness\n  geom_point(aes(y = mean_pred, color = region), fill = \"white\", shape = 21, size = 4, stroke = 1.2) +\n  # Letters for significance\n  geom_text(aes(y = upper.CL + 1, label = .group),\n            size = 4, fontface = \"bold\", color = \"black\") +\n  # Fancy aligned richtext labels\n  ggtext::geom_richtext(aes(y = 1.1, label = label_text),\n                        hjust = .75, vjust = 0.5, size = 3.3,\n                        fill = NA, label.color = NA) +\n  scale_fill_manual(values = region_palette) +\n  scale_color_manual(values = region_palette) +\n  labs(x = NULL,\n       y = \"Morphotaxa Richness\",\n       title = \"Observed vs. Predicted Benthic Richness by Region\",\n       subtitle = \"Bars = observed means; points and error bars = GLMM predictions (95% CI)\\nLetters denote groups not significantly different (Tukey-adjusted α = 0.05)\") +\n  theme(axis.text.x      = element_text(angle = 25, hjust = 1),\n        axis.title.y     = element_text(face = \"bold\"),\n        legend.position  = \"none\",\n        plot.margin      = margin(10, 30, 10, 10)) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))\n\n\n\n\n\n\n\n\nFigure 7: Observed and GLMM‐predicted morphotaxon richness by region. Letters indicate Tukey‐adjusted groupings (α = 0.05).\n\n\n\n\n\nPairwise comparisons reveal that Murat consistently had lower benthic richness than the other regions, with significantly reduced richness compared to Lovongai, Manus, and the Western Islands. In contrast, richness differences among Lovongai, Manus, and Western Islands were not statistically significant, suggesting broadly comparable community diversity across these regions."
  },
  {
    "objectID": "eda_lpi.html#hard-coral-cover",
    "href": "eda_lpi.html#hard-coral-cover",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.1 Hard coral cover",
    "text": "5.1 Hard coral cover\n\nBleaching"
  },
  {
    "objectID": "eda_lpi.html#cca",
    "href": "eda_lpi.html#cca",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.2 CCA",
    "text": "5.2 CCA\n\nPatterns\n\n\nCode\n# Step 1: Filter only hard coral\ncca_cover &lt;- func_cover_by_site |&gt; \n  filter(functional_group == \"cca\")\n\n# Define a color palette for % cover\ncca_palette &lt;- colorNumeric(\n  palette = colorRampPalette(c(\"#fde0dd\", \"#fa9fb5\", \"#f768a1\", \"#c51b8a\"))(100),\n  domain = range(cca_cover$pct_cover, na.rm = TRUE))\n\n# Step 7: Render interactive pie chart map\nleaflet(cca_cover) |&gt;\n  addProviderTiles(providers$Esri.WorldImagery) |&gt;\n  addCircleMarkers(lng = ~longitude,\n    lat = ~latitude,\n    radius = ~rescale(pct_cover, to = c(3, 10)), # scaled nicely\n    stroke = TRUE,            # Important: activate stroke\n    color = \"black\",          # Border color\n    weight = 0.7,             # Thin but visible border\n    opacity = 1,              # Full border opacity\n    fillColor = ~cca_palette(pct_cover),\n    fillOpacity = 0.85,       # Slight transparency inside\n    label = ~paste0(\n      \"&lt;strong&gt;Site:&lt;/strong&gt; \", ps_site_id, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Subregion:&lt;/strong&gt; \", subregion, \"&lt;br&gt;\",\n      \"&lt;strong&gt;CCA Cover:&lt;/strong&gt; \", round(pct_cover, 1), \"%\"\n    ) |&gt; lapply(htmltools::HTML)\n  ) |&gt;\n  addFullscreenControl(position = \"topright\") |&gt;\n  addLegend(position = \"bottomright\",\n    pal = cca_palette,\n    values = ~pct_cover,\n    title = \"CCA Cover (%)\",\n    labFormat = labelFormat(suffix = \"%\"),\n    opacity = 1)\n\n\n\n\n\n\n\n\nFigure 23: Map of cyanobacteria cover by site\n\n\n\n\n\n\nCode\nfunc_cover_by_station |&gt; \n  filter(functional_group %in%  c(\"cca\", \"hard coral\")) |&gt; \n  left_join(lpi_stations |&gt; select(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt; \n  group_by(functional_group, ps_station_id, region, subregion) |&gt;\n  summarize(pct_cover = sum(pct_cover)) |&gt; \n  group_by(functional_group, region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            avg_cover  = mean(pct_cover, na.rm = TRUE),\n            se_cover   = sd(pct_cover, na.rm = TRUE) / sqrt(n()), # Standard error\n            .groups = \"drop\") |&gt; \n  mutate(label_pct = paste0(round(avg_cover, 1), \"%\")) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover, fill = functional_group)) +\n  geom_col() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % CCA Cover by Subregion\",\n       fill = \"\") +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")+\n  scale_fill_manual(values = c(\"cca\" = \"#F1B6DA\", \"hard coral\" = \"#EA9E8D\"))\n\n\n\n\n\n\n\n\nFigure 24: Cyanobacteria cover by subregion"
  },
  {
    "objectID": "eda_lpi.html#cyanobateria",
    "href": "eda_lpi.html#cyanobateria",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.3 Cyanobateria",
    "text": "5.3 Cyanobateria\n\nPatterns\n\n\nCode\n# Step 1: Filter only hard coral\ncyano_cover &lt;- func_cover_by_site |&gt; \n  filter(functional_group == \"cyanobacteria\")\n\ncyano_palette &lt;- colorNumeric(palette = c(\"#f7f1e1\", \"#d8b365\", \"#8c510a\", \"#543005\"),\n                              domain = range(cyano_cover$pct_cover, na.rm = TRUE))\n\n# Step 7: Render interactive pie chart map\nleaflet(cyano_cover) |&gt;\n  addProviderTiles(providers$Esri.WorldImagery) |&gt;\n  addCircleMarkers(\n    lng = ~longitude,\n    lat = ~latitude,\n    radius = ~rescale(pct_cover, to = c(3, 10)), # scaled nicely\n    stroke = TRUE,            # Important: activate stroke\n    color = \"black\",          # Border color\n    weight = 0.7,             # Thin but visible border\n    opacity = 1,              # Full border opacity\n    fillColor = ~cyano_palette(pct_cover),\n    fillOpacity = 0.85,       # Slight transparency inside\n    label = ~paste0(\n      \"&lt;strong&gt;Site:&lt;/strong&gt; \", ps_site_id, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Subregion:&lt;/strong&gt; \", subregion, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Cyanobacteria Cover:&lt;/strong&gt; \", round(pct_cover, 1), \"%\"\n    ) |&gt; lapply(htmltools::HTML)\n  ) |&gt;\n  addFullscreenControl(position = \"topright\") |&gt;\n  addLegend(\n    position = \"bottomright\",\n    pal = cyano_palette,\n    values = ~pct_cover,\n    title = \"Cyanobacteria Cover (%)\",\n    labFormat = labelFormat(suffix = \"%\"),\n    opacity = 1\n  )\n\n\n\n\n\n\n\n\nCode\nfunc_cover_by_station |&gt; \n  filter(functional_group == \"cyanobacteria\") |&gt; \n  left_join(lpi_stations |&gt; select(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt; \n  group_by(region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            avg_cover  = mean(pct_cover, na.rm = TRUE),\n            se_cover   = sd(pct_cover, na.rm = TRUE) / sqrt(n()), # Standard error\n            .groups = \"drop\") |&gt; \n  mutate(label_pct = paste0(round(avg_cover, 1), \"%\")) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover, fill = region)) +\n  geom_col() +\n  geom_errorbar(aes(ymin = avg_cover - se_cover, ymax = avg_cover + se_cover), \n                width = 0.2, color = \"grey\") +\n  scale_fill_manual(values = region_palette) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % Cynobacteria Cover by Subregion\",\n       fill = \"\") +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")\n\n\n\n\n\n\n\n\nFigure 25: Average % Cyanobacteria Cover by Subregion\n\n\n\n\n\n\n\nStatistical tests\nWe modeled cyanobacteria percent cover using a beta regression with a logit link, including region, depth strata, exposure, and habitat as predictors and subregion as a random intercept. Model fit was strong (AIC = –587.7; dispersion parameter = 26.1), and random effects were small (subregion variance = 0.064). Region was the only significant predictor based on model coefficients: cyanobacteria cover was significantly lower in Manus, Murat, and the Western Islands relative to the reference region (Lovongai), with p-values &lt; 0.05. Other predictors (depth strata, exposure, habitat) showed no significant effects.\n\n\nCode\n# Filter hard coral cover and join region info\ncyano_cover_station &lt;- func_cover_by_station |&gt; \n  filter(functional_group == \"cyanobacteria\") |&gt; \n  left_join(lpi_stations |&gt; \n              distinct(ps_site_id, ps_station_id, region, subregion, depth_strata, exposure, habitat), \n            by = \"ps_station_id\")\n\ncyano_cover_station &lt;- cyano_cover_station |&gt;\n  mutate(\n    # Apply standard transformation to handle zeros and ones\n    # (y * (n-1) + 0.5) / n where n is sample size\n    n = nrow(cyano_cover_station),\n    transformed_cover = (pct_cover/100 * (n - 1) + 0.5) / n\n  )\n\nlibrary(glmmTMB)\n\n# Beta regression (since % cover is 0-100)\nglmm_cyano &lt;- glmmTMB(transformed_cover ~ region + depth_strata + exposure + habitat + (1 | subregion),\n                      data = cyano_cover_station,\n                      family = beta_family(link = \"logit\"))\n\n# 1. Extract model parameters\ncyano_glmm_summary &lt;- parameters::model_parameters(glmm_cyano, exponentiate = F) |&gt;\n  mutate(CI = sprintf(\"[%.2f, %.2f]\", CI_low, CI_high),\n         p.value = case_when(is.na(p)            ~ NA_character_,\n                       p &lt; 0.001           ~ \"&lt; .001\",\n                       TRUE                ~ formatC(p, format = \"f\", digits = 3))) |&gt;\n  select(Parameter, Estimate = Coefficient, SE, CI, Z = z, `p-value` = p.value, p)\n\n\n# 2. Build gt table\ncyano_glmm_summary |&gt;\n  gt(rowname_col = \"Parameter\") |&gt;\n  tab_header(title = md(\"**GLMM Results: Cyano Cover by Region, Depth, Exposure, and Habitat**\"),\n             subtitle = \"Beta regression with logit link (n = 157 stations).\") |&gt;\n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(\n              rows = `p-value` == \"&lt; .001\" | `p` &lt; 0.05,\n              columns = everything())) |&gt;\n  tab_style(style = list(cell_fill(color = \"#f9f9f9\")),\n            locations = cells_body()) |&gt;\n  cols_hide(columns = c(p)) |&gt;\n  cols_align(align = \"center\") |&gt;\n  opt_row_striping() |&gt;\n  fmt_number(columns = c(Estimate, SE, Z),\n             decimals = 2) |&gt;\n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\n\n\n\n\nGLMM Results: Cyano Cover by Region, Depth, Exposure, and Habitat\n\n\nBeta regression with logit link (n = 157 stations).\n\n\n\nEstimate\nSE\nCI\nZ\np-value\n\n\n\n\n(Intercept)\n−2.24\n0.48\n[-3.18, -1.30]\n−4.66\n&lt; .001\n\n\nregionManus\n−0.76\n0.38\n[-1.50, -0.03]\n−2.03\n0.042\n\n\nregionMurat\n−1.04\n0.36\n[-1.75, -0.33]\n−2.89\n0.004\n\n\nregionWestern Islands\n−0.81\n0.33\n[-1.44, -0.17]\n−2.48\n0.013\n\n\ndepth_stratashallow\n−0.02\n0.13\n[-0.28, 0.24]\n−0.17\n0.866\n\n\ndepth_stratasupershallow\n−0.08\n0.53\n[-1.13, 0.97]\n−0.16\n0.876\n\n\nexposureleeward\n−0.87\n1.14\n[-3.11, 1.36]\n−0.77\n0.443\n\n\nexposurewindward\n−0.83\n1.15\n[-3.08, 1.42]\n−0.72\n0.469\n\n\nhabitatchannel\n0.47\n1.31\n[-2.09, 3.03]\n0.36\n0.720\n\n\nhabitatfore reef\n0.38\n1.05\n[-1.68, 2.44]\n0.36\n0.718\n\n\nhabitatpatch reef\n−0.24\n1.09\n[-2.38, 1.90]\n−0.22\n0.823\n\n\n(Intercept)\n31.78\nNA\n[23.94, 42.18]\nNA\nNA\n\n\nSD (Intercept)\n0.43\nNA\n[0.21, 0.88]\nNA\nNA\n\n\n\n\n\n\n\nHowever, when marginal means were back-transformed to the percent cover scale and confidence intervals computed, predicted cyanobacteria cover was relatively low across all regions (~4–8%) with overlapping 95% confidence intervals. While coefficient p-values indicated significant regional differences on the logit scale, the wide uncertainty in percent cover estimates suggests that absolute ecological differences between regions are small, and pairwise post-hoc comparisons may not all reach statistical significance after adjusting for multiple comparisons.\n\n\nCode\n# 1. Predicted marginal means and significance letters\nemm_region_cyano &lt;- emmeans::emmeans(glmm_cyano, ~ region, type = \"response\")\n\npred_cyano &lt;- emm_region_cyano |&gt;\n  cld(adjust = \"tukey\", Letters = letters) |&gt;\n  as_tibble() |&gt;\n  mutate(mean_cover_pred = response * 100,\n         lower.CL = asymp.LCL * 100,\n         upper.CL = asymp.UCL * 100,\n         .group = str_trim(.group)) |&gt;\n  select(region, mean_cover_pred, lower.CL, upper.CL, .group)\n\n# 2. Observed means and medians\nobs_cyano &lt;- cyano_cover_station |&gt;\n  group_by(region) |&gt;\n  summarise(mean_cover_obs = mean(pct_cover, na.rm = TRUE),\n            median_cover_obs = median(pct_cover, na.rm = TRUE),\n            n = n(),\n            .groups = \"drop\")\n\n# 3. Combine\nplot_cyano_data &lt;- left_join(obs_cyano, pred_cyano, by = \"region\")\n\n# 4. Plot\n\nplot_cyano_data |&gt; \n  mutate(mean_obs_label  = round(mean_cover_obs, 1),\n         mean_pred_label = round(mean_cover_pred, 1),\n         label_text = paste0(\"&lt;span style='color:gray30;'&gt;**Obs:** \", mean_obs_label, \"&lt;/span&gt;&lt;br&gt;\",\n                              \"&lt;span style='color:white;'&gt;**Pred:** \", mean_pred_label, \"&lt;/span&gt;\")) |&gt; \n  ggplot(aes(x = fct_reorder(region, mean_cover_obs))) +\n  # Bars for observed mean richness, colored by region\n  geom_col(aes(y = mean_cover_obs, fill = region), width = 0.6, color = \"gray30\") +\n  # Error bars for predicted mean ± 95% CI\n  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), color = \"gray30\",\n                width = 0.15, size = 0.8) +\n  # Points for predicted mean richness\n  geom_point(aes(y = mean_cover_pred, color = region), fill = \"white\", shape = 21, size = 4, stroke = 1.2) +\n  # Letters for significance\n  geom_text(aes(y = upper.CL + 1, label = .group),\n            size = 4, fontface = \"bold\", color = \"black\") +\n  # Fancy aligned richtext labels\n  ggtext::geom_richtext(aes(y = 1, label = label_text),\n                        hjust = .75, vjust = 0.5, size = 3.3,\n                        fill = NA, label.color = NA) +\n  labs(x = NULL,\n       y = \"Cyanobacteria (% cover)\",\n       title = \"Observed vs. Predicted Cyanobacteria Cover by Region\",\n       subtitle = \"Bars = observed means; points and error bars = GLMM predictions (95% CI)\\nLetters denote groups not significantly different (Tukey-adjusted α = 0.05)\") +\n  theme(axis.text.x      = element_text(angle = 25, hjust = 1),\n        axis.title.y     = element_text(face = \"bold\"),\n        legend.position  = \"none\",\n        plot.margin      = margin(10, 30, 10, 10)) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))+\n  scale_fill_manual(values = region_palette) \n\n\n\n\n\n\n\n\nFigure 26: Observed vs. Predicted Cyanobacteria Cover by Region (with Tukey-adjusted group letters)"
  },
  {
    "objectID": "eda_lpi.html#interactive-map",
    "href": "eda_lpi.html#interactive-map",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "1.1 Interactive Map",
    "text": "1.1 Interactive Map\n\n\nCode\n# Collapse to site level\n\nsites_map &lt;- lpi_stations |&gt; \n  mutate(strata_label = glue::glue(\"{depth_strata} ({depth_m} m)\")) |&gt; \n  group_by(ps_site_id, region, habitat, exposure, latitude, longitude) |&gt; \n  summarise(\n    strata_info = paste(unique(strata_label), collapse = \"\\n\"),\n    n_stations  = n_distinct(ps_station_id),\n    .groups     = \"drop\")\n\npal_region &lt;- colorFactor(palette = region_palette, domain = sites_map$region)\n\nleaflet(sites_map) |&gt; \n  addProviderTiles(providers$Esri.WorldImagery) |&gt; \n  addCircleMarkers(lng = ~longitude,\n                   lat = ~latitude,\n                   fillColor = ~pal_region(region),\n                   radius = 6,\n                   fillOpacity = 0.85,\n                   stroke = T,\n                   weight = 1,\n                   color = \"white\",\n                   label = ~glue::glue(\"&lt;strong&gt;Site:&lt;/strong&gt; {ps_site_id}&lt;br&gt;\n                                        &lt;strong&gt;Region:&lt;/strong&gt; {region}&lt;br&gt;\n                                        &lt;strong&gt;Habitat:&lt;/strong&gt; {habitat}&lt;br&gt;\n                                        &lt;strong&gt;Exposure:&lt;/strong&gt; {exposure}&lt;br&gt;\n                                        &lt;strong&gt;Stations:&lt;/strong&gt; {n_stations}&lt;br&gt;\n                                        &lt;strong&gt;Depth strata:&lt;/strong&gt;&lt;br&gt;{strata_info}\") |&gt;\n                     lapply(htmltools::HTML)) |&gt; \n  addLegend(\"bottomright\", pal = pal_region, values = ~region, title = \"Region\") |&gt; \n  addMiniMap(position = \"bottomleft\") |&gt; \n  addScaleBar()|&gt; \n  addFullscreenControl()\n\n\n\n\n\n\n\n\nFigure 1: Map of LPI survey stations"
  },
  {
    "objectID": "eda_lpi.html#effort-summary",
    "href": "eda_lpi.html#effort-summary",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "1.2 Effort Summary",
    "text": "1.2 Effort Summary\n\n\nCode\nlpi_stations |&gt; \n  group_by(region, habitat, depth_strata) |&gt;\n  summarise(n = n_distinct(ps_station_id), .groups = \"drop\") |&gt; \n  pivot_wider(names_from = habitat, values_from = n, values_fill = 0) |&gt; \n  mutate(Total = rowSums(across(where(is.numeric)), na.rm = TRUE)) |&gt;\n  gt(groupname_col = \"region\") |&gt; \n  tab_header(title = \"Summary of sampling effort by region\",\n             subtitle = \"Number of stations surveyed by depth strata and habitat\") |&gt;\n  tab_spanner(label = \"Reef Habitats\", \n              columns = c(\"fore reef\", \"back reef\", \"channel\", \"patch reef\")) |&gt; \n  tab_style(style = list(cell_fill(color = \"#f0f0f0\"),\n                         cell_text(weight = \"bold\")),\n            locations = list(cells_column_labels(everything()),\n                             cells_column_spanners(spanners = \"Reef Habitats\"))) |&gt;\n  opt_table_font(font = list(gt::google_font(\"Roboto\"), default_fonts())) |&gt;\n  opt_row_striping() |&gt; \n  tab_options(row_group.as_column = T,\n              table.width = pct(100),\n              table.font.size = \"small\") |&gt; \n  opt_vertical_padding(scale = 0.7) |&gt; \n  tab_source_note(source_note = \"Depth stratum: supershallow (&lt; 6 m), shallow (7 - 15 m), and deep (&gt;= 15 m).\") \n\n\n\n\nTable 1: Number of LPI survey stations by habitat and depth strata\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSummary of sampling effort by region\n\n\nNumber of stations surveyed by depth strata and habitat\n\n\n\ndepth_strata\n\nReef Habitats\n\nTotal\n\n\nfore reef\nback reef\nchannel\npatch reef\n\n\n\n\nLovongai\nshallow\n16\n3\n0\n0\n19\n\n\ndeep\n8\n0\n0\n0\n8\n\n\nsupershallow\n1\n0\n0\n0\n1\n\n\nManus\nshallow\n15\n0\n1\n1\n17\n\n\ndeep\n11\n0\n0\n1\n12\n\n\nsupershallow\n0\n0\n0\n1\n1\n\n\nMurat\ndeep\n22\n0\n0\n0\n22\n\n\nshallow\n22\n0\n0\n0\n22\n\n\nWestern Islands\ndeep\n24\n1\n0\n0\n25\n\n\nshallow\n26\n2\n0\n0\n28\n\n\nsupershallow\n1\n1\n0\n0\n2\n\n\n\nDepth stratum: supershallow (&lt; 6 m), shallow (7 - 15 m), and deep (&gt;= 15 m)."
  },
  {
    "objectID": "eda_lpi.html#taxonomic-composition",
    "href": "eda_lpi.html#taxonomic-composition",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "1.3 Taxonomic Composition",
    "text": "1.3 Taxonomic Composition\nThis section summarizes the overall taxonomic and functional structure of the benthic communities recorded during the expedition. It provides context for interpreting patterns in richness and composition, highlighting the diversity of morphotaxa observed and their ecological roles.\n\n\nCode\nn_obs    &lt;- nrow(lpi_observations)\nn_stns   &lt;- length(unique(lpi_observations$ps_station_id))\nn_taxa   &lt;- length(unique(lpi_observations$morphotaxon))\nn_func   &lt;- lpi_observations |&gt; filter(!is.na(functional_group)) |&gt; pull(functional_group) |&gt; unique() |&gt; length()\n\nsum_class &lt;- lpi_morphotaxa |&gt; \n  filter(!is.na(kingdom)) |&gt; \n  group_by(kingdom, phylum, class) |&gt; \n  summarise(n_morphotaxa = n_distinct(morphotaxon), \n            n_accepted   = n_distinct(accepted_aphia_id),\n            n_pts        = sum(contacts, na.rm = TRUE),\n            .groups = \"drop\")\n\n# Summarize morphotaxa, accepted names, and total contacts by functional group\nsum_func &lt;- lpi_morphotaxa |&gt; \n  filter(!is.na(kingdom)) |&gt; \n  group_by(functional_group) |&gt; \n  summarise(n_morphotaxa = n_distinct(morphotaxon),\n            n_accepted   = n_distinct(accepted_aphia_id),\n            n_pts        = sum(contacts, na.rm = TRUE),\n            .groups = \"drop\")\n\n\nThe dataset includes 7,772 individual contact observations representing 341 unique morphotaxa assigned to 10 functional groups, from 4 kingdoms and 11 phyla.\n\n\nCode\n# Summarize morphotaxa, accepted names, and total contacts by Kingdom → Phylum → Class\n\nplot_by_class &lt;- sum_class |&gt; \n  ggplot(aes(x = reorder(kingdom, n_morphotaxa, sum),\n             y = n_morphotaxa,\n             fill = fct_reorder(class, n_morphotaxa),\n             text = paste0(\n               \"&lt;b&gt;Kingdom:&lt;/b&gt; \", kingdom, \"&lt;br&gt;\",\n               \"&lt;b&gt;Phylum:&lt;/b&gt; \", phylum, \"&lt;br&gt;\",\n               \"&lt;b&gt;Class:&lt;/b&gt; \", class, \"&lt;br&gt;\",\n               \"&lt;b&gt;Morphotaxa (count):&lt;/b&gt; \", n_morphotaxa, \"&lt;br&gt;\",\n               \"&lt;b&gt;Accepted names:&lt;/b&gt; \", n_accepted))) +\n  geom_col(color = \"white\", size = 0.3) +\n  paletteer::scale_fill_paletteer_d(\"Polychrome::palette36\", na.value = \"#e0e0e0\") +\n  labs(title = \"Taxonomic Composition of Benthic Morphotaxa\",\n       x = NULL,\n       y = \"Number of Morphotaxa\",\n       fill = \"Class\") +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(face = \"bold\", size = 16, hjust = 0.5),\n        legend.title = element_text(face = \"bold\"),\n        axis.text.x = element_text(angle = 45, hjust = 1),\n        panel.grid.major.x = element_blank()) \n\nggplotly(plot_by_class, tooltip = \"text\") |&gt; \n  layout(hoverlabel = list(bgcolor = \"white\",\n                           font = list(size = 12)))\n\n\n\n\n\n\n\n\nFigure 2: Distribution of Benthic Morphotaxa across Taxonomic Classes\n\n\n\n\nAmong functional groups, sponges (91 morphotaxa), erect algae (81 morphotaxa), and soft corals (58 morphotaxa) were particularly rich.\n\n\nCode\nplot_by_func &lt;- sum_func |&gt; \n  pivot_longer(cols = c(n_morphotaxa, n_accepted),\n               names_to = \"type\", values_to = \"count\") |&gt;\n  mutate(type = recode(type,\n                       \"n_morphotaxa\" = \"Morphotaxa\",\n                       \"n_accepted\" = \"Accepted Names\")) |&gt;\n  group_by(functional_group) |&gt;\n  mutate(total = sum(count)) |&gt;\n  ungroup() |&gt;\n  mutate(functional_group = fct_reorder(functional_group, total)) |&gt; \n  ggplot(aes(x = count, y = functional_group, fill = type, text = paste(type, \":\", count))) +\n  geom_col(position = position_dodge(width = 0.7), width = 0.6) +\n  scale_fill_manual(values = c(\"Morphotaxa\" = \"#1f77b4\", \"Accepted Names\" = \"#ff7f0e\")) +\n  labs(title = \"Morphotaxa and Accepted Names by Functional Group\",\n       x = \"Count\", y = NULL, fill = \"\") +\n  theme(legend.position = \"top\",\n        plot.title = element_text(face = \"bold\"))+\n  scale_x_continuous(expand = expansion(mult = c(0, 0.05))) \n  \n# Then pass to plotly\nplotly::ggplotly(plot_by_func, tooltip = \"text\")\n\n\n\n\n\n\n\n\nFigure 3: Distribution of Benthic Morphotaxa across Functional Groups\n\n\n\n\nField morphotaxa were consolidated to their lowest defensible taxonomic rank based on authoritative references (e.g., uncertain sponge morphotypes assigned to Porifera at the phylum level). This step substantially reduced the number of distinct accepted names compared to field morphotaxa — particularly for groups like sponges and soft corals where fine-scale identification is notoriously difficult. After consolidating morphotaxa to their lowest defensible taxonomic rank, the majority of benthic observations were classified at the species and genus levels across most functional groups (Table 2).\n\n\nCode\nsum_func_rank &lt;- lpi_morphotaxa |&gt; \n  group_by(functional_group, rank) |&gt; \n  summarize(n_morphotaxa = n_distinct(morphotaxon),\n            n_accepted = n_distinct(accepted_aphia_id),\n            n_points = sum(contacts, na.rm = TRUE),\n            .groups = \"drop\") |&gt; \n  arrange(desc(n_morphotaxa))\n\n# Step 2: Total morphotaxa per functional group\ngroup_totals &lt;- sum_func_rank |&gt; \n  group_by(functional_group) |&gt; \n  summarize(total_morphotaxa = sum(n_morphotaxa), .groups = \"drop\")\n\n# Step 3: Add formatted label\nsum_func_rank &lt;- sum_func_rank |&gt; \n  left_join(group_totals, by = \"functional_group\") |&gt; \n  mutate(\n    functional_group_label = glue::glue(\"{functional_group} ({total_morphotaxa})\")\n  ) |&gt; \n  select(functional_group_label, rank, n_morphotaxa, n_accepted, n_points) |&gt; \n  arrange(desc(n_morphotaxa))\n\n\n# Step 4: Reactable\nreactable(sum_func_rank,\n          groupBy          = \"functional_group_label\",\n          filterable       = TRUE,\n          pagination       = TRUE,\n          defaultPageSize  = 10,\n          striped          = TRUE,\n          highlight        = TRUE,\n          bordered         = TRUE,\n          theme            = custom_tbl_theme,\n          columns = list(\n            functional_group_label = colDef(name = \"Functional Group\", sticky = \"left\"),\n            rank                   = colDef(name = \"Rank\"),\n            n_morphotaxa           = colDef(name = \"# Morphotaxa\"),\n            n_accepted             = colDef(name = \"# Accepted Species\"),\n            n_points               = colDef(name = \"# Points\")\n          )) |&gt; \n  add_title(\"Summary of Benthic Functional Groups\") |&gt; \n  add_subtitle(\"Number of morphotaxa, accepted species, and survey points recorded per functional group\",\n               font_size = 18,\n               font_color = '#666666',\n               margin = reactablefmtr::margin(t=10,r=0,b=10,l=0))\n\n\n\n\nTable 2: Summary of morphotaxa by functional group and lowest defensible taxonomic rank\n\n\n\nSummary of Benthic Functional Groups\nNumber of morphotaxa, accepted species, and survey points recorded per functional group"
  },
  {
    "objectID": "eda_lpi.html#species-accumulation-curves",
    "href": "eda_lpi.html#species-accumulation-curves",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "2.3 Species accumulation curves",
    "text": "2.3 Species accumulation curves\nSpecies accumulation curves were generated based on presence-weighted morphotaxon data to assess regional benthic richness and sampling completeness (Figure 8). Curves show the cumulative number of morphotaxa as stations are added, with steeper slopes indicating higher diversity and community turnover. Shaded ribbons reflect variation among random station orderings, providing an estimate of within-region heterogeneity.\n\n\nCode\nlibrary(vegan)\n\n# Species matrix with one row per station × region\ntaxa_cover_matrix &lt;- cover_by_station_and_taxa |&gt; \n  left_join(lpi_stations |&gt; distinct(ps_station_id, region), by = \"ps_station_id\") |&gt; \n  filter(contacts &gt; 0) |&gt; \n  select(region, ps_station_id, morphotaxon, contacts) |&gt; \n  pivot_wider(id_cols = c(region, ps_station_id),\n              names_from = morphotaxon,\n              values_from = contacts,\n              values_fill = list(contacts = 0) )\n\n# 1. Nest species matrix by region\n\ntaxa_nested &lt;- taxa_cover_matrix |&gt; \n  group_by(region) |&gt; \n  nest()\n\n# 2. Compute specaccum per region\naccum_curves &lt;- taxa_nested |&gt; \n  mutate(\n    acc = map(data, ~ specaccum(select(.x, where(is.numeric)), method = \"random\")),\n    curve = map(acc, ~ tibble(\n      station_number = .x$sites,\n      richness = .x$richness,\n      sd = .x$sd\n    ))\n  ) |&gt; \n  select(region, curve) |&gt; \n  unnest(curve)\n\n# 3. Plot\nggplot(accum_curves, aes(x = station_number, y = richness, color = region, fill = region)) +\n  geom_line(linewidth = 1) +\n  geom_ribbon(aes(ymin = richness - sd, ymax = richness + sd), alpha = 0.2, color = NA) +\n  labs(title = \"Morphotaxa Accumulation Curves by Region\",\n       x = \"Number of Stations\",\n       y = \"Accumulated Morphotaxa Richness\") +\n  theme(legend.position = \"bottom\")+\n  labs(fill = \"\", col = \"\")\n\n\n\n\n\n\n\n\nFigure 8: Morphotaxa accumulation curves by region\n\n\n\n\n\nSpecies accumulation patterns reveal marked regional differences in benthic diversity. Manus and Western Islands stand out as the most species-rich and heterogeneous, with curves that continue to rise and broad confidence bands. Lovongai shows moderate richness and appears to be more completely sampled, while Murat exhibits the lowest richness and least variability. Together, these curves provide a baseline for comparing biodiversity across regions and evaluating the sufficiency of sampling efforts."
  },
  {
    "objectID": "eda_lpi.html#hard-coral",
    "href": "eda_lpi.html#hard-coral",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.1 Hard coral",
    "text": "5.1 Hard coral\n\nPatterns\n\n\nCode\nfunc_cover_by_site &lt;- func_cover_by_station |&gt; \n  left_join(lpi_stations |&gt; \n              distinct(ps_site_id, ps_station_id, region, subregion, latitude, longitude), \n            by = \"ps_station_id\") |&gt; \n  group_by(region, subregion, ps_site_id, latitude, longitude, functional_group) |&gt; \n  summarise(pct_cover = mean(pct_cover)) |&gt; \n  ungroup() |&gt; \n  arrange(desc(pct_cover)) \n\n# Step 1: Filter only hard coral\nhard_coral_cover &lt;- func_cover_by_site |&gt; \n  filter(functional_group == \"hard coral\")\n\n# Define a color palette for % cover\ncoral_palette &lt;- colorNumeric(palette = \"YlOrRd\", \n                              domain = hard_coral_cover$pct_cover)\n\n# Step 7: Render interactive pie chart map\nleaflet(hard_coral_cover) |&gt;\n  addProviderTiles(providers$Esri.WorldImagery) |&gt;\n  addCircleMarkers(lng = ~longitude,\n                   lat = ~latitude,\n                   radius = ~rescale(pct_cover, to = c(3, 10)), # scaled nicely\n                   stroke = TRUE,            # Important: activate stroke\n                   color = \"black\",          # Border color\n                   weight = 0.7,             # Thin but visible border\n                   opacity = 1,              # Full border opacity\n                   fillColor = ~coral_palette(pct_cover),\n                   fillOpacity = 0.85,       # Slight transparency inside\n                   label = ~paste0(\"&lt;strong&gt;Site:&lt;/strong&gt; \", ps_site_id, \"&lt;br&gt;\",\n                                   \"&lt;strong&gt;Subregion:&lt;/strong&gt; \", subregion, \"&lt;br&gt;\",\n                                   \"&lt;strong&gt;Hard Coral Cover:&lt;/strong&gt; \", round(pct_cover, 1), \"%\") |&gt; \n                     lapply(htmltools::HTML)) |&gt;\n  addFullscreenControl(position = \"topright\") |&gt;\n  addLegend(position = \"bottomright\",\n            pal = coral_palette,\n            values = ~pct_cover,\n            title = \"Hard Coral Cover (%)\",\n            labFormat = labelFormat(suffix = \"%\"),\n            opacity = 1)\n\n\n\n\n\n\n\n\nFigure 14: Map of hard coral cover by site\n\n\n\n\n\n\nCode\nfunc_cover_by_station |&gt; \n  filter(functional_group == \"hard coral\") |&gt; \n  left_join(lpi_stations |&gt; select(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt; \n  group_by(region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            avg_cover  = mean(pct_cover, na.rm = TRUE),\n            se_cover   = sd(pct_cover, na.rm = TRUE) / sqrt(n()), # Standard error\n            .groups = \"drop\") |&gt; \n  mutate(label_pct = paste0(round(avg_cover, 1), \"%\")) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover, fill = region)) +\n  geom_col() +\n  geom_errorbar(aes(ymin = avg_cover - se_cover, ymax = avg_cover + se_cover), \n                width = 0.2, color = \"grey\") +\n  scale_fill_manual(values = region_palette) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % Hard Coral Cover by Subregion\",\n       fill = \"\") +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")\n\n\n\n\n\n\n\n\nFigure 15: Average % Hard Coral Cover by Subregion\n\n\n\n\n\n\n\nDoes coral cover vary by depth and region?\n\n\nCode\nlibrary(emmeans)\nlibrary(glmmTMB)\n\n# Filter hard coral cover and join region info\ncoral_cover_by_station &lt;- func_cover_by_station |&gt; \n  filter(functional_group == \"hard coral\") |&gt; \n  left_join(lpi_stations |&gt; distinct(ps_site_id, ps_station_id, region, subregion, depth_strata, exposure, habitat), \n            by = \"ps_station_id\")\n\nglmm_coral &lt;- glmmTMB(pct_cover/100 ~ region + depth_strata + exposure + habitat + (1 | subregion),\n                      data = coral_cover_by_station,\n                      family = beta_family(link = \"logit\"))\n\nemm_depth &lt;- emmeans(glmm_coral, ~ depth_strata, type = \"response\", adjust = \"sidak\")\n\n\nHard coral cover varied across regions and environmental gradients, but only depth strata showed a statistically significant effect in the fitted beta GLMM (Table 6). Sites at shallower depths exhibited significantly higher hard coral cover compared to deep sites (Estimate = 0.35, p &lt; .001), while no significant differences were detected among regions, exposure categories, or habitat types.\n\n\nCode\n# 1. Extract model parameters\ncoral_glmm_summary &lt;- parameters::model_parameters(glmm_coral, exponentiate = F) |&gt;\n  mutate(CI = sprintf(\"[%.2f, %.2f]\", CI_low, CI_high),\n         p_fmt = case_when(is.na(p)            ~ NA_character_,\n                       p &lt; 0.001           ~ \"&lt; .001\",\n                       TRUE                ~ formatC(p, format = \"f\", digits = 3))) |&gt;\n  select(Parameter, Estimate = Coefficient, SE, CI, Z = z, `p-value` = p_fmt, p)\n\n# 2. Build gt table\ncoral_glmm_summary |&gt;\n  gt(rowname_col = \"Parameter\") |&gt;\n  tab_header(title = md(\"**GLMM Results: Coral Cover by Region, Depth, Exposure, and Habitat**\"),\n             subtitle = \"Beta regression with logit link (n = 157 stations).\") |&gt;\n  tab_style(style = list(cell_fill(color = \"#f9f9f9\")),\n            locations = cells_body()) |&gt;\n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(\n              rows = `p-value` == \"&lt; .001\" | `p` &lt; 0.05,\n              columns = everything())) |&gt;\n  cols_align(align = \"center\") |&gt;\n  opt_row_striping() |&gt;\n  cols_hide(columns = c(p)) |&gt;\n  fmt_number(columns = c(Estimate, SE, Z),\n             decimals = 2) |&gt;\n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\nTable 6: GLMM results for hard coral cover by region, depth strata, exposure, and habitat\n\n\n\n\n\n\n\n\n\nGLMM Results: Coral Cover by Region, Depth, Exposure, and Habitat\n\n\nBeta regression with logit link (n = 157 stations).\n\n\n\nEstimate\nSE\nCI\nZ\np-value\n\n\n\n\n(Intercept)\n−1.65\n0.38\n[-2.40, -0.91]\n−4.36\n&lt; .001\n\n\nregionManus\n−0.25\n0.36\n[-0.95, 0.45]\n−0.71\n0.480\n\n\nregionMurat\n−0.33\n0.34\n[-1.00, 0.35]\n−0.95\n0.341\n\n\nregionWestern Islands\n0.30\n0.31\n[-0.31, 0.91]\n0.97\n0.332\n\n\ndepth_stratashallow\n0.30\n0.11\n[0.07, 0.52]\n2.60\n0.009\n\n\ndepth_stratasupershallow\n0.26\n0.45\n[-0.62, 1.14]\n0.58\n0.563\n\n\nexposureleeward\n−0.08\n0.87\n[-1.79, 1.62]\n−0.10\n0.923\n\n\nexposurewindward\n−0.45\n0.88\n[-2.17, 1.27]\n−0.51\n0.611\n\n\nhabitatchannel\n1.06\n1.09\n[-1.08, 3.20]\n0.97\n0.331\n\n\nhabitatfore reef\n0.86\n0.83\n[-0.76, 2.48]\n1.04\n0.297\n\n\nhabitatpatch reef\n1.07\n0.85\n[-0.60, 2.75]\n1.26\n0.208\n\n\n(Intercept)\n8.99\nNA\n[7.15, 11.30]\nNA\nNA\n\n\nSD (Intercept)\n0.42\nNA\n[0.25, 0.70]\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\nMarginal Means\n\n\nCode\nlibrary(emmeans)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(glue)\n\n# 1. Compute predicted means + Tukey cld letters\n\ncld_depth &lt;- emm_depth |&gt;\n  cld(alpha = 0.05, Letters = letters, adjust = \"sidak\") |&gt;\n  as_tibble() |&gt;\n  mutate(mean_pred = response * 100,  # back-transform % scale\n         lower.CL = asymp.LCL * 100,\n         upper.CL = asymp.UCL * 100) |&gt;\n  select(depth_strata, mean_pred, lower.CL, upper.CL, .group)\n\n# 2. Observed station means by depth\nobs_depth &lt;- coral_cover_by_station |&gt;\n  group_by(depth_strata) |&gt;\n  summarise(n_stations     = n(),\n            mean_obs       = mean(pct_cover, na.rm = TRUE),\n            median_obs     = median(pct_cover, na.rm = TRUE),\n            .groups = \"drop\")\n\n# 3. Merge and order\ndepth_summary &lt;- obs_depth |&gt;\n  left_join(cld_depth, by = \"depth_strata\") |&gt;\n  mutate(depth_strata = fct_reorder(depth_strata, mean_obs))\n\n# 4. Plot\n\ndepth_summary |&gt; \n  mutate(mean_obs_label  = round(mean_obs, 1),\n         mean_pred_label = round(mean_pred, 1),\n         label_text = paste0(\"&lt;span style='color:gray30;'&gt;**Obs:** \", mean_obs_label, \"&lt;/span&gt;&lt;br&gt;\",\n                              \"&lt;span style='color:white;'&gt;**Pred:** \", mean_pred_label, \"&lt;/span&gt;\")) |&gt; \n  ggplot(aes(x = fct_reorder(depth_strata, mean_obs))) +\n  # Bars for observed mean richness, colored by depth_strata\n  geom_col(aes(y = mean_obs, fill = depth_strata), width = 0.6, color = \"gray30\") +\n  # Error bars for predicted mean ± 95% CI\n  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), color = \"gray30\",\n                width = 0.15, size = 0.8) +\n  # Points for predicted mean richness\n  geom_point(aes(y = mean_pred, color = depth_strata), fill = \"white\", shape = 21, size = 4, stroke = 1.2) +\n  # Letters for significance\n  geom_text(aes(y = upper.CL + 2, label = .group),\n            size = 4, fontface = \"bold\", color = \"black\") +\n  # Fancy aligned richtext labels\n  ggtext::geom_richtext(aes(y = 5, label = label_text),\n                        hjust = .75, vjust = 0.5, size = 3.3,\n                        fill = NA, label.color = NA) +\n  labs(x = NULL,\n       y = \"Coral Cover\",\n       title = \"Observed vs. Predicted Coral Cover by Depth strata\",\n       subtitle = \"Bars = observed means; points and error bars = GLMM predictions (95% CI)\\nLetters denote groups not significantly different (Tukey-adjusted α = 0.05)\") +\n  theme(axis.text.x      = element_text(angle = 25, hjust = 1),\n        axis.title.y     = element_text(face = \"bold\"),\n        legend.position  = \"none\",\n        plot.margin      = margin(10, 30, 10, 10)) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))\n\n\n\n\n\n\n\n\nFigure 16: Observed vs. Predicted Coral Cover by Depth Strata (with Tukey-adjusted group letters)\n\n\n\n\n\nObserved mean coral cover varied modestly with depth. Deep reefs had a mean cover of 29.9 while shallow reefs averaged 34.6 %, and supershallow sites 33.5 %. Our Beta‐GLMM predictions mirror these trends. Tukey‐adjusted letters show shallow reefs had significantly higher cover than deep reefs (p &lt; .05), with supershallow overlapping both.\n\n\nCode\nlibrary(emmeans)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggtext)\n\n# 1. Fit emmeans and compute CLDs\nemm_coral_region &lt;- emmeans(glmm_coral, ~ region, type = \"response\")\n\nregion_cld &lt;- cld(emm_coral_region,\n                  adjust   = \"sidak\",       # Sidak adjustment for multiple comparisons\n                  Letters  = letters,       # letter set\n                  alpha    = 0.05,\n                  by       = NULL)\n\n# 2. Tidy predicted means + join letters\npred_region &lt;- as_tibble(emm_coral_region) %&gt;%\n  transmute(region,\n            mean_pred = response * 100,\n            lower.CL  = asymp.LCL   * 100,\n            upper.CL  = asymp.UCL   * 100) %&gt;%\n  left_join(region_cld %&gt;% select(region, .group), by = \"region\")\n\n# 3. Calculate observed station‐means\nobs_region_cover &lt;- coral_cover_by_station %&gt;%\n  group_by(region) %&gt;%\n  summarise(n_stations     = n(),\n            mean_obs = mean(pct_cover, na.rm = TRUE),\n            median_obs = median(pct_cover, na.rm = TRUE),\n            .groups = \"drop\")\n\n# 4. Merge observed + predicted + letters\ncoral_region_summary &lt;- obs_region_cover %&gt;%\n  left_join(pred_region, by = \"region\") %&gt;%\n  mutate(region = fct_reorder(region, mean_obs))\n\ncoral_region_summary |&gt; \n  mutate(mean_obs_label  = round(mean_obs, 1),\n         mean_pred_label = round(mean_pred, 1),\n         label_text = paste0(\"&lt;span style='color:gray30;'&gt;**Obs:** \", mean_obs_label, \"&lt;/span&gt;&lt;br&gt;\",\n                              \"&lt;span style='color:white;'&gt;**Pred:** \", mean_pred_label, \"&lt;/span&gt;\")) |&gt; \n  ggplot(aes(x = fct_reorder(region, mean_obs))) +\n  # Bars for observed mean richness, colored by region\n  geom_col(aes(y = mean_obs, fill = region), width = 0.6, color = \"gray30\") +\n  # Error bars for predicted mean ± 95% CI\n  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), color = \"gray30\",\n                width = 0.15, size = 0.8) +\n  # Points for predicted mean richness\n  geom_point(aes(y = mean_pred, color = region), fill = \"white\", shape = 21, size = 4, stroke = 1.2) +\n  # Letters for significance\n  geom_text(aes(y = upper.CL + 2, label = .group),\n            size = 4, fontface = \"bold\", color = \"black\") +\n  # Fancy aligned richtext labels\n  ggtext::geom_richtext(aes(y = 5, label = label_text),\n                        hjust = .75, vjust = 0.5, size = 3.3,\n                        fill = NA, label.color = NA) +\n  labs(x = NULL,\n       y = \"Hard Coral (% cover)\",\n       title = \"Observed vs. Predicted Coral Cover by Region\",\n       subtitle = \"Bars = observed means; points and error bars = GLMM predictions (95% CI)\\nLetters denote groups not significantly different (Tukey-adjusted α = 0.05)\") +\n  theme(axis.text.x      = element_text(angle = 25, hjust = 1),\n        axis.title.y     = element_text(face = \"bold\"),\n        legend.position  = \"none\",\n        plot.margin      = margin(10, 30, 10, 10)) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))+\n  scale_fill_manual(values = region_palette) \n\n\n\n\n\n\n\n\nFigure 17: Observed vs. Predicted Coral Cover by Region (with Tukey-adjusted group letters)\n\n\n\n\n\nObserved mean coral cover ranged from 27.5% in Murat to 39.3 % in the Western Islands, with corresponding predicted mean covers from the model following a similar pattern but with wider uncertainty intervals. No significant pairwise differences among regions were detected based on the GLMM predictions indicating that while there is visible variation in coral cover across subregions, these differences were not statistically robust after accounting for environmental covariates and random site effects.\n\n\n\nBleaching\nBeginning at site 24, the survey protocol was expanded to separately record bleaching status, using a new category for “hard coral – bleached” under the same Line Point Intercept (LPI) method. In this section, we summarize patterns of coral bleaching prevalence across regions and depth strata, and evaluate whether bleaching incidence varies significantly across environmental gradients.\n\n\nCode\n# Step 1: Summarize at station level\nbleaching_by_station &lt;- cover_by_station_and_taxa |&gt; \n  filter(as.integer(str_extract(ps_station_id, \"(?&lt;=_)[0-9]{3}(?=_)\")) &gt;= 23) |&gt; \n  filter(functional_group == \"hard coral\") |&gt; \n  group_by(ps_station_id) |&gt;\n  summarise(pts_coral       = sum(contacts),\n            pct_coral_cover = sum(pct_cover),\n            pts_bleached    = sum(contacts[str_detect(morphotaxon, \"dead|bleached\")]),\n            pct_bleached    = ifelse(pts_coral &gt; 0, 100 * pts_bleached / pts_coral, 0),\n            .groups = \"drop\") |&gt; \n  left_join(lpi_stations |&gt; select(ps_station_id, region, subregion, depth_strata),\n            by = \"ps_station_id\") |&gt; \n  mutate(bleached_coral_cover = pct_coral_cover * (pct_bleached / 100),\n         healthy_coral_cover  = pct_coral_cover - bleached_coral_cover)\n\n# Step 2: Summarize at subregion level\nbleaching_by_subregion &lt;- bleaching_by_station |&gt; \n  group_by(region, subregion) |&gt;\n  summarise(n_stations           = n(),\n            avg_pct_coral        = mean(pct_coral_cover, na.rm = TRUE),\n            avg_pct_bleached_pct = mean(pct_bleached, na.rm = TRUE),\n            .groups = \"drop\") |&gt; \n  mutate(healthy_coral_cover  = avg_pct_coral * (1 - avg_pct_bleached_pct / 100),\n         bleached_coral_cover = avg_pct_coral * (avg_pct_bleached_pct / 100))\n\n# Step 3: Overall bleaching summary\nbleaching_by_region &lt;- bleaching_by_station |&gt;\n  group_by(region) |&gt;\n  summarise(n_stations   = n(),\n            mean_bleach  = mean(pct_bleached, na.rm = TRUE),\n            median_bleach = median(pct_bleached, na.rm = TRUE),\n            max_bleach   = max(pct_bleached, na.rm = TRUE),\n            pct_stations = round(100 * n_stations / nrow(lpi_stations)))\n\nbleaching_sum &lt;- bleaching_by_station |&gt;\n  summarise(n_stations   = n(),\n            mean_bleach  = mean(pct_bleached, na.rm = TRUE),\n            median_bleach = median(pct_bleached, na.rm = TRUE),\n            max_bleach   = max(pct_bleached, na.rm = TRUE),\n            pct_stations = round(100 * n_stations / nrow(lpi_stations)))\n\n\nBleaching was observed at 113 stations, representing approximately 72% of all surveyed sites. Across these stations, the average bleaching prevalence was 10.8 %, while the median bleaching was lower at 7.5 %. Bleaching severity varied widely, ranging from 0% at some sites to as high as 87.1% at others.\n\n\nCode\nlibrary(plotly)\n\nbleaching_interactive &lt;- bleaching_by_station |&gt; \n  filter(depth_strata != \"supershallow\") |&gt; \n  select(ps_station_id, region, healthy_coral_cover, bleached_coral_cover, depth_strata) |&gt; \n  pivot_longer(cols = c(healthy_coral_cover, bleached_coral_cover),\n               names_to = \"category\",\n               values_to = \"percent_cover\") |&gt; \n  mutate(category = factor(category,\n                           levels = c(\"healthy_coral_cover\", \"bleached_coral_cover\"),\n                           labels = c(\"Healthy Coral\", \"Bleached Coral\")),\n         ps_station_id_short = ps_station_id |&gt;\n           str_remove(\"^PNG_2024_uvs_\") |&gt; \n           str_remove(\"_[0-9]+m$\")) |&gt; \n  arrange(ps_station_id)\n\np &lt;- bleaching_interactive |&gt; \n  ggplot(aes(x = fct_rev(ps_station_id_short),\n             y = percent_cover, fill = category,\n             text = paste0(\"Station: \", ps_station_id_short, \"&lt;br&gt;\",\n                           \"Region: \", region, \"&lt;br&gt;\",\n                           \"Depth: \", depth_strata, \"&lt;br&gt;\",\n                           \"Condition: \", category, \"&lt;br&gt;\",\n                           \"Cover: \", round(percent_cover, 1), \"%\"))) +\n  geom_col(width = 0.7) +\n  facet_grid(region ~ depth_strata, scales = \"free_y\") +\n  coord_flip() +\n  scale_fill_manual(values = c(\"Healthy Coral\" = \"#EA9E8D\", \"Bleached Coral\" = \"#FFDCCC\")) +\n  labs(x = NULL, y = \"Percent Cover (%)\",\n       title = \"Coral Health Composition by Station\",\n       fill = \"\") +\n  theme_minimal(base_size = 14) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        plot.title = element_text(face = \"bold\", size = 16),\n        strip.text = element_text(face = \"bold\"),\n        axis.text.y = element_text(size = 7),\n        legend.title = element_blank()) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05)))\n\nggplotly(p, tooltip = \"text\") |&gt; \n  layout(legend = list(orientation = \"h\", x = 0.3, y = -0.2))\n\n\n\n\n\n\n\n\nFigure 18: Interactive Plot of Hard Coral Health by Station\n\n\n\n\n\n\nCode\nstation_summary &lt;- station_summary |&gt; \n  left_join(bleaching_by_station |&gt; \n              mutate(pct_bleached = round(pct_bleached, 2)) |&gt; \n              select(ps_station_id, pct_bleached), \n            by = \"ps_station_id\") \n\nsubregion_summary &lt;- subregion_summary |&gt; \n  left_join(bleaching_by_subregion |&gt; \n              mutate(avg_pct_bleached_pct = round(avg_pct_bleached_pct, 2)) |&gt; \n              select(region, subregion, pct_bleached = avg_pct_bleached_pct), \n            by = c(\"region\", \"subregion\"))\n\nregion_summary &lt;- region_summary |&gt; \n  left_join(bleaching_by_region |&gt; \n              select(region, pct_bleached = mean_bleach))\n\nsave(lpi_station_summary = station_summary, \n          lpi_subregion_summary = subregion_summary,\n          lpi_region_summary = region_summary,\n     file = file.path(exp_path, \"data/primary/output/lpi_summaries.RData\"))\n\n\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(ggforce)\nlibrary(tidyr)\n\n# 1. your input table (fractions, not %)\nregions &lt;- tibble(\n  region  = c(\"Lovongai\", \"Manus\",  \"Murat\",\"Western Islands\"),\n  min     = c(0.04,      0,       NA,0),\n  avg     = c(0.18,      0.1,      NA, 0.07),\n  max     = c(0.58,      0.87,    NA  , 0.28)\n)\n\n# 2. build the arc‐segment data\ngauge_data &lt;- regions %&gt;%\n  mutate(\n    # for each region, split into filled vs remainder\n    seg = map(avg, ~ tibble(\n      part       = c(\"bleached\", \"remaining\"),\n      percentage = c(.x, 1 - .x)\n    ))\n  ) %&gt;%\n  select(region, min, avg, max, seg) %&gt;%\n  unnest(seg) %&gt;%\n  group_by(region) %&gt;%\n  mutate(\n    start = lag(percentage, default = 0) * pi,\n    end   = (lag(percentage, default = 0) + percentage) * pi\n  ) %&gt;%\n  ungroup()\n\n# 3. compute min/max label positions (constant angles: π and 0, rotated by π/2)\nlabel_pos &lt;- regions %&gt;%\n  mutate(angle_min = pi,       # left end of semicircle\n         angle_max = 0,        # right end\n         x_min     = 1 + 0.75 * cos(angle_min - pi/2),\n         y_min     = 1 + 0.75 * sin(angle_min - pi/2),\n         x_max     = 1 + 0.75 * cos(angle_max - pi/2),\n         y_max     = 1 + 0.75 * sin(angle_max - pi/2),\n         lbl_min   = paste0(round(min*100), \"%\"),\n         lbl_max   = paste0(round(max*100), \"%\"),\n         lbl_avg   = paste0(round(avg*100), \"%\"))\n\n# 4. plot with facet_wrap\ngauge_plot &lt;- ggplot(gauge_data) +\n  # background + fill arcs\n  geom_arc_bar(aes(\n    x0    = 1, y0 = 1,\n    r0    = 0.75, r = 1,\n    start = start   - pi/2,\n    end   = end     - pi/2,\n    fill  = part\n  ), show.legend = FALSE) +\n  # min/max labels\n  geom_text(data = label_pos,\n            aes(x = 0.15, y = .93, label = lbl_min),\n            size = 3,  color = \"grey30\") +\n  geom_text(data = label_pos,\n            aes( x = 1.9, y = .93, label = lbl_max),\n            size = 3, color = \"grey30\") +\n  # avg % in center\n  geom_text(data = label_pos,\n            aes(x = 1, y = 1.5, label = lbl_avg),\n            size = 6) +\n  # custom colors\n  scale_fill_manual(values = c(\"remaining\" = \"#EA9E8D\", bleached = \"#FFDCCC\")) +\n  coord_fixed() +\n  theme_void() +\n  facet_wrap(~region, nrow = 1)+\n  theme(strip.text = element_text(size = 12))\n\n\n\n\nCode\nlibrary(patchwork)\n\nlpi_sumary_plot &lt;- func_cover_pie/gauge_plot+\n  theme(\n    strip.text       = element_blank(),\n    strip.background = element_blank(),\n  )\n\ngauge_plot |&gt; \n  ggsave(filename = file.path(exp_path, \"figures/gauge_plot.pdf\"),\n         width = 8, height = 4, dpi = 300)\n\n\n\nHigher Coral Cover, Higher Bleaching?\n\n\nCode\nggplot(bleaching_by_station, aes(x = pct_coral_cover, y = pct_bleached)) +\n  geom_point(size = 2, alpha = 0.7) +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"black\", linewidth = 0.8) +\n  labs(x = \"% Hard Coral Cover\",\n       y = \"% Bleached Coral\",\n       title = \"Relationship Between Coral Cover and Bleaching Prevalence\") +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(face = \"bold\", size = 16))\n\ncor_test &lt;- cor.test(bleaching_by_station$pct_coral_cover,\n                     bleaching_by_station$pct_bleached,\n                     method = \"spearman\")\n\n\n\n\n\n\n\n\nFigure 19: Relationship between hard coral cover and bleaching prevalence across stations.\n\n\n\n\n\nWe tested for a correlation between hard coral cover and bleaching prevalence across stations using Spearman’s rank correlation. The correlation was weak (0.07) and not statistically significant (0.487), indicating no clear relationship between overall coral cover and the extent of bleaching across surveyed sites.\n\n\nDoes bleaching vary by depth and region?\n\n\nCode\nbleaching_by_station |&gt; \n  filter(depth_strata != \"supershallow\") |&gt; \n  ggplot(aes(x = region, y = pct_bleached, fill = depth_strata)) +\n  geom_boxplot(alpha = 0.7, outlier.shape = NA, width = 0.6, position = position_dodge(width = 0.8)) +\n  geom_point(aes(color = depth_strata),\n             position = position_jitterdodge(jitter.width = 0.2,  # small horizontal spread\n                                             jitter.height = 0, \n                                             dodge.width = 0.8),\n             size = 2, alpha = 0.7,\n             show.legend = FALSE) +\n  scale_fill_brewer(palette = \"Set2\") +\n  scale_color_brewer(palette = \"Set2\") +\n  labs(title = \"Coral Bleaching by Region and Depth Strata\",\n       subtitle = \"Points show individual stations, boxplots summarize distributions\",\n       x = NULL,\n       y = \"% Bleached Coral\",\n       fill = \"\") +\n  theme_minimal(base_size = 14) +\n  theme(plot.title = element_text(face = \"bold\", size = 16),\n        plot.subtitle = element_text(size = 13),\n        legend.position = \"bottom\",\n        axis.text.x = element_text(face = \"bold\")) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+\n  scale_fill_manual(values = c(\"#2E5266\", \"#A3D9FF\")) +\n  scale_color_manual(values = c(\"#2E5266\", \"#A3D9FF\")) \n\n\n\n\n\n\n\n\nFigure 20: Distribution of coral bleaching by region and depth strata\n\n\n\n\n\nWe modeled the percent bleaching across stations using a Beta GLMM with depth strata and region as fixed effects and a random intercept for subregion. Bleaching was significantly lower in Manus (β = -1.51, p &lt; 0.001) and Western Islands (β = -1.32, p &lt; 0.001) compared to Lovongai, while differences across depth strata were not statistically significant. There was moderate random variation among subregions (SD = 0.33).\n\n\nCode\nlibrary(glmmTMB)\n\nbleach_glmm &lt;- glmmTMB(formula = (pct_bleached + 0.001) / 100  ~ depth_strata + region  + (1 | subregion),\n                       data = bleaching_by_station,\n                       family = beta_family(link = \"logit\"))\n\n# 1. Extract model parameters\nbleach_glmm_summary &lt;- parameters::model_parameters(bleach_glmm, exponentiate = F) |&gt;\n  mutate(CI = sprintf(\"[%.2f, %.2f]\", CI_low, CI_high),\n         p_fmt = case_when(is.na(p)            ~ NA_character_,\n                       p &lt; 0.001           ~ \"&lt; .001\",\n                       TRUE                ~ formatC(p, format = \"f\", digits = 3))) |&gt;\n  select(Parameter, Estimate = Coefficient, SE, CI, Z = z, `p-value` = p_fmt, p)\n\n# 2. Build gt table\nbleach_glmm_summary |&gt;\n  gt(rowname_col = \"Parameter\") |&gt;\n  tab_header(title = md(\"**GLMM Results: Coral Bleaching by Region, Depth, Exposure, and Habitat**\"),\n             subtitle = \"Beta regression with logit link (n = 157 stations).\") |&gt;\n  tab_style(style = list(cell_fill(color = \"#f9f9f9\")),\n            locations = cells_body()) |&gt;\n  tab_style(style = cell_text(weight = \"bold\", color = \"black\"),\n            locations = cells_body(\n              rows = `p-value` == \"&lt; .001\" | `p` &lt; 0.05,\n              columns = everything())) |&gt;\n  cols_align(align = \"center\") |&gt;\n  opt_row_striping() |&gt;\n  cols_hide(columns = c(p)) |&gt;\n  fmt_number(columns = c(Estimate, SE, Z),\n             decimals = 2) |&gt;\n  tab_options(table.font.size = \"small\",\n              row.striping.include_table_body = TRUE,\n              table.border.top.color = \"white\",\n              table.border.bottom.color = \"white\",\n              heading.title.font.size = 16,\n              heading.subtitle.font.size = 13,\n              row.striping.background_color = \"#f0f0f0\",\n              column_labels.font.weight = \"bold\")\n\n\n\n\nTable 7: GLMM results for coral bleaching by region, depth strata, exposure, and habitat\n\n\n\n\n\n\n\n\n\nGLMM Results: Coral Bleaching by Region, Depth, Exposure, and Habitat\n\n\nBeta regression with logit link (n = 157 stations).\n\n\n\nEstimate\nSE\nCI\nZ\np-value\n\n\n\n\n(Intercept)\n−1.45\n0.27\n[-1.98, -0.92]\n−5.34\n&lt; .001\n\n\ndepth_stratashallow\n0.19\n0.20\n[-0.19, 0.58]\n0.98\n0.329\n\n\ndepth_stratasupershallow\n0.80\n0.53\n[-0.24, 1.84]\n1.51\n0.130\n\n\nregionManus\n−1.51\n0.37\n[-2.23, -0.78]\n−4.09\n&lt; .001\n\n\nregionWestern Islands\n−1.32\n0.32\n[-1.96, -0.69]\n−4.10\n&lt; .001\n\n\n(Intercept)\n4.91\nNA\n[3.57, 6.76]\nNA\nNA\n\n\nSD (Intercept)\n0.33\nNA\n[0.16, 0.71]\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nlibrary(emmeans)\n\n# Compute marginal means on correct scale\nemm_region_bleaching &lt;- emmeans(bleach_glmm, ~ region) |&gt;\n  regrid(transform = \"response\")\n\n# Add compact letter display\ncld_region_bleaching &lt;- cld(\n  emm_region_bleaching,\n  Letters = letters,      # or specify uppercase if preferred\n  adjust = \"tukey\",        # Important: multiple comparisons adjustment\n  alpha = 0.05,            # Default, but you can lower if stricter\n  reverse = TRUE           # Optional: so better regions (higher bleaching or lower bleaching) have lower letters\n)\n\n# Convert to tibble if needed\ncld_region_bleaching_tbl &lt;- as_tibble(cld_region_bleaching)\n\nfinal_bleaching_summary &lt;- as_tibble(cld_region_bleaching) |&gt;\n  mutate(mean_pred_bleach = (response - 0.001) * 100,\n         lower.CL = (asymp.LCL - 0.001) * 100,\n         upper.CL = (asymp.UCL - 0.001) * 100) |&gt;\n  select(region, mean_pred = mean_pred_bleach, lower.CL, upper.CL, .group)\n\n# 2. Observed station means by depth\nobs_bleach &lt;- bleaching_by_station |&gt;\n  group_by(region) |&gt;\n  summarise(n_stations     = n(),\n            mean_obs       = mean(pct_bleached, na.rm = TRUE),\n            median_obs     = median(pct_bleached, na.rm = TRUE),\n            .groups = \"drop\")\n\n# 3. Merge and order\nfinal_bleaching_summary &lt;- obs_bleach |&gt;\n  left_join(final_bleaching_summary, by = \"region\") \n\n# 4. Plot\n\nfinal_bleaching_summary |&gt; \n  mutate(mean_obs_label  = round(mean_obs, 1),\n         mean_pred_label = round(mean_pred, 1),\n         label_text = paste0(\"&lt;span style='color:gray30;'&gt;**Obs:** \", mean_obs_label, \"&lt;/span&gt;&lt;br&gt;\",\n                              \"&lt;span style='color:white;'&gt;**Pred:** \", mean_pred_label, \"&lt;/span&gt;\")) |&gt; \n  ggplot(aes(x = fct_reorder(region, mean_obs))) +\n  # Bars for observed mean richness, colored by region\n  geom_col(aes(y = mean_obs, fill = region), width = 0.6, color = \"gray30\") +\n  # Error bars for predicted mean ± 95% CI\n  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), color = \"gray30\",\n                width = 0.15, size = 0.8) +\n  # Points for predicted mean richness\n  geom_point(aes(y = mean_pred, color = region), fill = \"white\", shape = 21, size = 4, stroke = 1.2) +\n  # Letters for significance\n  geom_text(aes(y = upper.CL + 2, label = .group),\n            size = 4, fontface = \"bold\", color = \"black\") +\n  # Fancy aligned richtext labels\n  ggtext::geom_richtext(aes(y = 5, label = label_text),\n                        hjust = .75, vjust = 0.5, size = 3.3,\n                        fill = NA, label.color = NA) +\n  labs(x = NULL,\n       y = \"Belaching (% coral bleached)\",\n       title = \"Observed vs. Predicted Coral Bleaching by Region\",\n       subtitle = \"Bars = observed means; points and error bars = GLMM predictions (95% CI)\\nLetters denote groups not significantly different (Tukey-adjusted α = 0.05)\") +\n  theme(axis.text.x      = element_text(angle = 25, hjust = 1),\n        axis.title.y     = element_text(face = \"bold\"),\n        legend.position  = \"none\",\n        plot.margin      = margin(10, 30, 10, 10)) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))+\n  scale_fill_manual(values = region_palette) +\n  scale_color_manual(values = region_palette) \n\n\n\n\n\n\n\n\nFigure 21: Observed vs. Predicted Coral Bleaching by Region\n\n\n\n\n\n\n\nCode\nbleaching_by_subregion |&gt;\n  select(subregion, region, healthy_coral_cover, bleached_coral_cover) |&gt; \n  pivot_longer(cols = c(healthy_coral_cover, bleached_coral_cover),\n               names_to = \"category\",\n               values_to = \"percent_cover\") |&gt;\n  mutate(category = factor(category,\n                      levels = c(\"healthy_coral_cover\", \"bleached_coral_cover\"),\n                      labels = c(\"Healthy\", \"Bleached\"))) |&gt; \n  ggplot(aes(x = fct_reorder(subregion, percent_cover, .fun = sum),\n             y = percent_cover, fill = category)) +\n  geom_col(width = 0.7) +\n  scale_fill_manual(values = c(\"Healthy\" = \"#EA9E8D\", \"Bleached\" = \"#FFDCCC\")) +\n  labs(\n    x = NULL,\n    y = \"Average % Cover\",\n    title = \"Healthy and Bleached Coral by Subregion\",\n    subtitle = \"Bar height = mean hard coral cover; partitioned into healthy vs bleached\",\n    fill = \"Condition\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"bottom\",\n    strip.text = element_text(face = \"bold\"),\n    plot.title = element_text(face = \"bold\", size = 16),\n    plot.subtitle = element_text(size = 13),\n    axis.text.y = element_text(size = 8),\n    legend.title = element_blank()\n  ) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+\n  facet_wrap(~region, scales = \"free_x\", ncol = 3)\n\n\n\n\n\n\n\n\nFigure 22: Coral Bleaching by Subregion"
  },
  {
    "objectID": "eda_lpi.html#cca-coral",
    "href": "eda_lpi.html#cca-coral",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.3 CCA + Coral",
    "text": "5.3 CCA + Coral\n\nPatterns\n\n\nCode\n# Step 1: Filter only hard coral\ncca_cover &lt;- func_cover_by_site |&gt; \n  filter(functional_group == \"cca\")\n\n# Define a color palette for % cover\ncca_palette &lt;- colorNumeric(\n  palette = \"YlOrRd\", # You can change palette (e.g., \"viridis\", \"plasma\", \"Blues\")\n  domain = cca_cover$pct_cover\n)\n\n# Step 7: Render interactive pie chart map\nleaflet(cca_cover) |&gt;\n  addProviderTiles(providers$Esri.WorldImagery) |&gt;\n  addCircleMarkers(\n    lng = ~longitude,\n    lat = ~latitude,\n    radius = ~rescale(pct_cover, to = c(3, 10)), # scaled nicely\n    stroke = TRUE,            # Important: activate stroke\n    color = \"black\",          # Border color\n    weight = 0.7,             # Thin but visible border\n    opacity = 1,              # Full border opacity\n    fillColor = ~cca_palette(pct_cover),\n    fillOpacity = 0.85,       # Slight transparency inside\n    label = ~paste0(\n      \"&lt;strong&gt;Site:&lt;/strong&gt; \", ps_site_id, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Subregion:&lt;/strong&gt; \", subregion, \"&lt;br&gt;\",\n      \"&lt;strong&gt;CCA Cover:&lt;/strong&gt; \", round(pct_cover, 1), \"%\"\n    ) |&gt; lapply(htmltools::HTML)\n  ) |&gt;\n  addFullscreenControl(position = \"topright\") |&gt;\n  addLegend(\n    position = \"bottomright\",\n    pal = cca_palette,\n    values = ~pct_cover,\n    title = \"CCA Cover (%)\",\n    labFormat = labelFormat(suffix = \"%\"),\n    opacity = 1\n  )\n\n\n\n\n\n\n\n\nCode\nfunc_cover_by_station |&gt; \n  filter(functional_group == \"cca\") |&gt; \n  left_join(lpi_stations |&gt; select(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt; \n  group_by(region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            avg_cover  = mean(pct_cover, na.rm = TRUE),\n            se_cover   = sd(pct_cover, na.rm = TRUE) / sqrt(n()), # Standard error\n            .groups = \"drop\") |&gt; \n  mutate(label_pct = paste0(round(avg_cover, 1), \"%\")) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover, fill = region)) +\n  geom_col() +\n  geom_errorbar(aes(ymin = avg_cover - se_cover, ymax = avg_cover + se_cover), \n                width = 0.2, color = \"grey\") +\n  scale_fill_manual(values = region_palette) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % CCA Cover by Subregion\",\n       fill = \"\") +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")"
  },
  {
    "objectID": "eda_lpi.html#cca-live-coral",
    "href": "eda_lpi.html#cca-live-coral",
    "title": "Exploratory Analysis of LPI Benthic Data",
    "section": "5.2 CCA + Live Coral",
    "text": "5.2 CCA + Live Coral\n\nPatterns\n\n\nCode\n# Step 1: Filter only hard coral\ncca_cover &lt;- func_cover_by_site |&gt; \n  filter(functional_group == \"cca\")\n\n# Define a color palette for % cover\ncca_palette &lt;- colorNumeric(\n  palette = \"YlOrRd\", # You can change palette (e.g., \"viridis\", \"plasma\", \"Blues\")\n  domain = cca_cover$pct_cover\n)\n\n# Step 7: Render interactive pie chart map\nleaflet(cca_cover) |&gt;\n  addProviderTiles(providers$Esri.WorldImagery) |&gt;\n  addCircleMarkers(\n    lng = ~longitude,\n    lat = ~latitude,\n    radius = ~rescale(pct_cover, to = c(3, 10)), # scaled nicely\n    stroke = TRUE,            # Important: activate stroke\n    color = \"black\",          # Border color\n    weight = 0.7,             # Thin but visible border\n    opacity = 1,              # Full border opacity\n    fillColor = ~cca_palette(pct_cover),\n    fillOpacity = 0.85,       # Slight transparency inside\n    label = ~paste0(\n      \"&lt;strong&gt;Site:&lt;/strong&gt; \", ps_site_id, \"&lt;br&gt;\",\n      \"&lt;strong&gt;Subregion:&lt;/strong&gt; \", subregion, \"&lt;br&gt;\",\n      \"&lt;strong&gt;CCA Cover:&lt;/strong&gt; \", round(pct_cover, 1), \"%\"\n    ) |&gt; lapply(htmltools::HTML)\n  ) |&gt;\n  addFullscreenControl(position = \"topright\") |&gt;\n  addLegend(\n    position = \"bottomright\",\n    pal = cca_palette,\n    values = ~pct_cover,\n    title = \"CCA Cover (%)\",\n    labFormat = labelFormat(suffix = \"%\"),\n    opacity = 1\n  )\n\n\n\n\n\n\n\n\nCode\nfunc_cover_by_station |&gt; \n  filter(functional_group == \"cca\") |&gt; \n  left_join(lpi_stations |&gt; select(ps_station_id, region, subregion), by = \"ps_station_id\") |&gt; \n  group_by(region, subregion) |&gt; \n  summarize(n_stations = n_distinct(ps_station_id),\n            avg_cover  = mean(pct_cover, na.rm = TRUE),\n            se_cover   = sd(pct_cover, na.rm = TRUE) / sqrt(n()), # Standard error\n            .groups = \"drop\") |&gt; \n  mutate(label_pct = paste0(round(avg_cover, 1), \"%\")) |&gt; \n  ggplot(aes(x = subregion, y = avg_cover, fill = region)) +\n  geom_col() +\n  geom_errorbar(aes(ymin = avg_cover - se_cover, ymax = avg_cover + se_cover), \n                width = 0.2, color = \"grey\") +\n  scale_fill_manual(values = region_palette) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        legend.position = \"bottom\",\n        legend.box = \"horizontal\") +\n  labs(y = \"Avg. % Cover\",\n       x = \"\",\n       title = \"Average % CCA Cover by Subregion\",\n       fill = \"\") +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +\n  facet_wrap(~region, ncol = 4, scales = \"free_x\")"
  }
]